!function(){return angular.module("app.env.config",[]).constant("config",{env:"local",elastic:{host:"local.portal.dev",port:"9200",apiVersion:"2.0"},app:{root:"app"},django:{host:"http://127.0.0.1",port:"8000"}})}(),function(){"use strict";angular.module("app",["ui.router","ui.bootstrap","app.env.config","app.core","app.widgets","angularUtils.directives.dirPagination","app.home","app.search","app.saved-records","app.advanced-search","app.controller","app.contributors","app.book-detail","AngularPrint","smoothScroll","ngAnimate","angularSpinner"]).config(["$httpProvider",function(e){e.defaults.xsrfCookieName="csrftoken",e.defaults.xsrfHeaderName="X-CSRFToken",e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded"}]).constant("_",window._).config(["$compileProvider","config",function(e,t){"prod"===t.env?(e.debugInfoEnabled(!1),console.log("In production. Debug mode disabled")):console.log("In "+t.env+". Debug mode enabled")}]).run(["$rootScope","$state","$stateParams",function(e,t,r){e.$state=t,e.$stateParams=r,e.$activeTabs=[],e.showSpinnner=!1}])}(),function(){"use strict";angular.module("app").config(["$stateProvider","$urlRouterProvider","$locationProvider","config",function(e,t,r,a){t.otherwise("/"),e.state("home",{url:"/",templateUrl:a.app.root+"/home/home.html",controller:"HomePageCtrl"}).state("searchResults",{url:"/search?q&from&size&sort&creator&grp_contributor&language&subject&date_gte&date_lte&adv_creator&adv_date&adv_grp_contributor&adv_language&adv_subject&adv_title",controller:"SearchCtrl",templateUrl:a.app.root+"/search/search.results.html",params:{q:{array:!0},creator:{array:!0},grp_contributor:{array:!0},language:{array:!0},subject:{array:!0},adv_creator:{array:!0},adv_grp_contributor:{array:!0},adv_language:{array:!0},adv_subject:{array:!0},adv_date:{array:!0},adv_title:{array:!0}},resolve:{searchResults:["$rootScope","$stateParams","SearchService","DataService","SORT_MODES","ADVANCED_SEARCH",function(e,t,r,a,o,n){e.showSpinner=!0,console.log("Router - SearchResults - in Resolve - $stateParams: "+JSON.stringify(t));var s=r,c=s.getDefaultOptsObj();if(t.size&&(c.size=parseInt(t.size)),t.from&&(c.from=parseInt(t.from)),t.sort&&(c.sort=t.sort.toLowerCase()),t.date_gte&&(c.date.gte=parseInt(t.date_gte)),t.date_lte&&(c.date.lte=parseInt(t.date_lte)),t.q){var i={};c.q=t.q.filter(function(e){return!i[e]&&(i[e]=!0,!0)}),c.q=c.q.map(function(e){return e.toLowerCase()})}return s.facetCategoriesList.forEach(function(e){t[e]&&t[e].length&&t[e].forEach(function(t){var r=s.buildFacet(e,t,0,!0);r&&c.facets.push(r)})}),s.advancedFieldsList.forEach(function(e){var r=n[e],a=t[r.paramName];a&&a.forEach(function(e){var t=s.buildAdvancedField(r,e);t&&c.advancedFields.push(t)})}),console.log("Router - SearchResults - in Resolve - opts: "+JSON.stringify(c)),s.opts=c,a.search(s.opts)}]}}).state("books",{url:"/books/:bookID",templateUrl:a.app.root+"/book_detail/book-detail.html",controller:"BookDetailCtrl",resolve:{book:["$stateParams",function(e){return{_id:e.bookID}}]}}).state("advanced",{url:"/advanced",templateUrl:a.app.root+"/advanced_search/advanced-search.html",controller:"AdvancedSearchCtrl"}).state("contributors",{url:"/contributors",templateUrl:a.app.root+"/contributors/contributors.html",controller:"ContributorsCtrl",resolve:{contributors:["$rootScope","DataService",function(e,t){return e.showSpinner=!1,t.getContributors()}]}}).state("feedback",{url:"/feedback",templateUrl:a.app.root+"/partials/feedback.html",controller:"FeedbackFormCtrl"}).state("thanks",{url:"/thanks",templateUrl:a.app.root+"/partials/thanks.html",controller:"FeedbackFormCtrl"}).state("help",{url:"/help",templateUrl:a.app.root+"/partials/help.html",controller:"SearchHelpCtrl"}).state("faq",{url:"/faq",templateUrl:a.app.root+"/partials/faqs.html",resolve:{spinner:["$rootScope",function(e){e.showSpinner=!1}]}}).state("savedRecords",{url:"/saved",templateUrl:a.app.root+"/saved_records/saved-records.html",controller:"SavedRecordsCtrl",resolve:{records:["$q","SavedRecordsService",function(e,t){return e.when(t.getRecords()).then(function(e){return e})}],searches:["$q","SavedRecordsService",function(e,t){return e.when(t.getSearches()).then(function(e){return e})}]}}),r.html5Mode(!0)}])}(),function(){"use strict";angular.module("app.core",[])}(),function(){"use strict";angular.module("app.core").constant("FACETS",{language:{name:"language",key:"_language",display:"Language",options:[]},subject:{name:"subject",key:"_subject_facets",rawKey:"_subject_facets.raw",display:"Subject",options:[]},creator:{name:"creator",key:"_creator_facet",rawKey:"_creator_facet.raw",display:"Creator/Contributor",options:[]},grp_contributor:{name:"grp_contributor",key:"_grp_contributor",rawKey:"_grp_contributor.raw",display:"From",options:[]}}).constant("SORT_MODES",{relevance:{display:"Relevance",mode:"relevance"},date_added:{display:"Newly Added First",mode:"date_added",sortQuery:{_ingest_date:{order:"desc"}}},title_asc:{display:"Title: A-Z",mode:"title_asc",sortQuery:"_title_display.sort"},title_desc:{display:"Title: Z-A",mode:"title_desc",sortQuery:{"_title_display.sort":{order:"desc"}}},date_asc:{display:"Date (ascending)",mode:"date_asc",sortQuery:"_date_facet"},date_desc:{display:"Date (descending)",mode:"date_desc",sortQuery:{_date_facet:{order:"desc"}}}}).constant("SAVED_ITEMS",{recordKey:"getty_portal_records",searchKey:"getty_portal_searches",gettyID:"getty_portal"}).constant("FROM_DEFAULT",0).constant("SIZE_DEFAULT",25).constant("SORT_DEFAULT","relevance").constant("DEFAULTS",{searchOpts:{q:"",size:25,from:0,facets:[],advancedFields:[],sort:"relevance",date:{}}})}(),function(){"use strict";function e(e,t){function r(e){return e.map(function(e){var t=e._source;return t._id=e._id,t})}function a(e,t,r){return console.log("....activeFacets:::: "+r),e.buckets.map(function(e){var a={category:t,value:e.key,count:e.doc_count,active:!1};return r.length&&r.forEach(function(e){e.category&&e.value&&a.category&&a.value&&e.category===a.category&&e.value===a.value&&(a.active=!0,e.count=a.count)}),a})}var o={parseResults:r,parseAggregationResults:a};return o}angular.module("app.core").factory("SearchResParser",["_","FACETS",e])}(),function(){"use strict";function e(e,t,r,a,o,n,s,c){function i(){return{from:s,size:c,q:[],sort:n,facets:[],advancedFields:[],date:{gte:null,lte:null}}}function l(){var e={};return e.q=this.opts.q,e.from=this.opts.from,e.size=this.opts.size,e.sort=this.opts.sort,e.date_gte=this.opts.date.gte,e.date_lte=this.opts.date.lte,this.facetCategoriesList.forEach(function(t){e[t]=[]}),this.opts.facets.forEach(function(t){e[t.category].push(t.value)}),this.advancedFieldsList.forEach(function(t){e[o[t].paramName]=[]}),this.opts.advancedFields.forEach(function(t){e[t.field.paramName].push(t.term)}),console.log("SearchService::buildQueryParams - queryParams: "+JSON.stringify(e)),e}function u(){var e=this,t={};return this.facetCategoriesList.forEach(function(r){t[r]=[],t[r]=e.opts.facets.filter(function(e){return e.category===r})}),console.log("SearchService::parseFacetsToObj - facets obj: "+JSON.stringify(t)),t}function d(e){return e=e||{},console.log("SearchService::updateOpts -- newOpts: "+JSON.stringify(e)),e.q&&(this.opts.q=e.q),e.sort&&"object"==typeof e.sort&&e.sort.mode&&(e.sort=e.sort.mode),r.merge(this.opts,e),console.log("SearchService::updateOpts -- opts now: "+JSON.stringify(this.opts)),this.opts}function p(e,t){return e&&(this.opts.date.gte=e),t&&(this.opts.date.gte=t),!0}function f(e){this.results.hits=t.parseResults(e.hits.hits),this.results.numTotalHits=e.hits.total;var r=(e.aggregations,this);this.facetCategoriesList.forEach(function(a){r.results.facetOptions[a]=t.parseAggregationResults(e.aggregations[a][a],a,r.opts.facets)});var a={hits:this.results.hits,numTotalHits:this.results.numTotalHits,facets:this.results.facetOptions};return a}function g(){this.opts=this.getDefaultOptsObj()}function h(){var e=1+Math.ceil(this.opts.from/this.opts.size);return e}function v(e,t,r,a){if(!S(e)||!t)return!1;var o={category:e,value:t};return r&&(o.count=r),void 0!==a&&(o.active=a),o}function m(e,t){return!(!e.searchKey&&(e=o[e],!e.searchKey))&&(console.log("SearchService::buildAdvancedField - field, term: "+JSON.stringify(e)+" "+t),{field:e,term:t})}function S(e){return w.indexOf(e)>-1}function y(e){return Boolean(e.category&&S(e.category)&&e.value)}function _(e,t){return e.category.toLowerCase()===t.category.toLowerCase()&&e.value.toLowerCase()===t.value.toLowerCase()}function b(e){var t=!1;return!!y(e)&&(e.active=!0,this.opts.facets.forEach(function(r){_(e,r)&&(r.active=!0,t=!0)}),t||this.opts.facets.push(e),console.log("SearchService::activateFacet -- this.opts.facets[] after new facet: "+JSON.stringify(this.opts.facets)),!0)}function F(e){return!!y(e)&&(e.active=!1,void r.remove(this.opts.facets,function(t){return _(e,t)}))}function R(e){if("all"===e)return this.opts.facets=[],!0;if(!S(e))return!1;for(var t=0;t<this.opts.facets.length;t++)this.opts.facets[t].category===e&&this.opts.facets.splice(t,1);return!0}function C(){e.go("searchResults",this.buildQueryParams(),{reload:!0,inherit:!1})}var w=["creator","grp_contributor","language","subject"],k={results:{hits:null,numTotalHits:null,facetOptions:{}},opts:i(),facetCategoriesList:["creator","grp_contributor","language","subject"],advancedFieldsList:Object.keys(o),updateOpts:d,resetOpts:g,updateDate:p,isValidCategory:S,isValidFacet:y,isSameFacet:_,buildFacet:v,activateFacet:b,deActivateFacet:F,clearFacetsIn:R,buildAdvancedField:m,calculatePage:h,parseFacetsToObj:u,getDefaultOptsObj:i,buildQueryParams:l,transitionStateAndSearch:C,setResultsData:f};return k}angular.module("app.core").factory("SearchService",["$state","SearchResParser","_","FACETS","ADVANCED_SEARCH","SORT_DEFAULT","FROM_DEFAULT","SIZE_DEFAULT",e])}(),function(){"use strict";function e(e,t,r,a){function o(o){var n=["from="+o.from,"size="+o.size,"sort="+o.sort];o.q.length&&o.q.forEach(function(e){n.push("q="+e)}),o.date.gte&&n.push("date_gte="+o.date.gte),o.date.lte&&n.push("date_lte="+o.date.lte),o.facets.forEach(function(e){n.push(e.category+"="+e.value)}),o.advancedFields.forEach(function(e){n.push(e.field.paramName+"="+e.term)});var s=n.join("&"),c=t.get(r.django.host+":"+r.django.port+"/api/books/"+s),i=e.defer();return c.success(function(e){var t=e[0];t.aggregations=e[1].aggregations;var r=a.setResultsData(t);i.resolve(r)}).error(function(e){i.reject(arguments),console.log("DataService::search -- error: "+JSON.stringify(e))}),i.promise}function n(){var a=t.get(r.django.host+":"+r.django.port+"/api/contributors"),o=e.defer();return a.success(function(e){o.resolve(e)}).error(function(){o.reject(arguments)}),o.promise}function s(e){return t.get(r.django.host+":"+r.django.port+"/api/book/raw/"+e)}function c(e){return console.log("getting ris record"),t.get(r.django.host+":"+r.django.port+"/api/book/raw/"+e+".ris")}function i(e){return t.get(r.django.host+":"+r.django.port+"/api/book/"+e)}var l={getContributors:n,getBookData:s,getDcRec:i,getRisRec:c,search:o};return l}angular.module("app.core").factory("DataService",["$q","$http","config","SearchService",e])}(),function(){"use strict";function e(e,t,r,a,o){function n(e,t){return e.q===t.q&&(!(t.facets&&t.facets.length>0&&!o.isEqual(e.facets,t.facets))&&(!(t.advancedFields&&t.advancedFields.length>0&&!o.isEqual(e.advancedFields,t.advancedFields))&&!(t.date&&!o.isEqual(e.date,t.date))))}function s(e,a,o){var s=c(),i=r.searchOpts;if(s&&s.length>0){var l=s[s.length-1].opts;l&&(i=l)}if(!n(i,e)){var u={opts:e,numResults:a,time:o};f(t.searchKey,u)}}function c(){return p(t.searchKey)}function i(e){g(t.searchKey,e)}function l(){return p(t.recordKey)}function u(e){f(t.recordKey,e)}function d(e){g(t.recordKey,e)}function p(e){var t=a.getItems(e);if(t){var r=JSON.parse(t);return r[e]||(r[e]=[]),r[e]}return t}function f(e,r){var o=a.getItems(e);if(o){o=JSON.parse(o),o[e]||(o[e]=[]),o[e].push(r);var n=a.setItem(e,JSON.stringify(o));n||e!==t.recordKey||alert("Error: Could not save record to local storage. Please check your browser settings.")}else e===t.recordKey&&alert("Error: Could not save record to local storage. Please check your browser settings.")}function g(e,r){var o=a.getItems(e);if(o){o=JSON.parse(o);var n=o[e];if(n){var s=n.filter(function(a){return e===t.recordKey?a._id!==r._id:r.time!==a.time});o[e]=s}else o[e]=[];var c=a.setItem(e,JSON.stringify(o));c||e!==t.recordKey||alert("Error: Could not remove item. Please check your browser settings.")}else alert("Error: Could not remove item. Please check your browser settings.")}var h={getRecords:l,saveRecord:u,removeRecord:d,saveSearch:s,getSearches:c,removeSearch:i};return h}angular.module("app.core").factory("SavedRecordsService",["$rootScope","SAVED_ITEMS","DEFAULTS","StorageService","_",e])}(),function(){"use strict";function e(){function e(e){try{var t=localStorage.getItem(e)}catch(r){return!1}if(t)return t;var a={},o=JSON.stringify(a);try{return localStorage.setItem(e,o),o}catch(r){return!1}}function t(e,t){try{return localStorage.setItem(e,t),!0}catch(r){return!1}}var r={getItems:e,setItem:t};return r}angular.module("app.core").factory("StorageService",[e])}(),function(){"use strict";angular.module("app.widgets",["angularUtils.directives.dirPagination"])}(),function(){"use strict";angular.module("app.widgets").config(["config","paginationTemplateProvider",function(e,t){console.log("...widgetConfig: Setting paginationTemplateProvider"),t.setPath(e.app.root+"/bower_components/angularUtils/dirPagination.custom.tpl.html")}])}(),function(){"use strict";function e(){this.scrollTo=function(e){function t(){return self.pageYOffset?self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0}function r(e){for(var t=document.getElementById(e),r=t.offsetTop,a=t;a.offsetParent&&a.offsetParent!=document.body;)a=a.offsetParent,r+=a.offsetTop;return r}var a=t(),o=r(e),n=o>a?o-a:a-o;if(n<100)return void scrollTo(0,o);var s=Math.round(n/100);s>=20&&(s=20);var c=Math.round(n/25),i=o>a?a+c:a-c,l=0;if(o>a)for(var u=a;u<o;u+=c)setTimeout("window.scrollTo(0, "+i+")",l*s),i+=c,i>o&&(i=o),l++;else for(var u=a;u>o;u-=c)setTimeout("window.scrollTo(0, "+i+")",l*s),i-=c,i<o&&(i=o),l++}}function t(e,t,r){e.gotoElement=function(e){t.hash("bottom"),r.scrollTo(e)}}angular.module("app.widgets",[]).service("anchorSmoothScroll",[e]).controller("ScrollCtrl",["$scope","$location","anchorSmoothScroll",t])}(),function(){"use strict";function e(){var e=function(e,t,r){if("active"==t)return e.css({position:"absolute",top:500,left:0,display:"block"}),jQuery(e).animate({top:0},r),function(t){t&&e.stop()}},t=function(e,t,r){if("active"==t)return e.css({position:"absolute",left:0,top:0}),jQuery(e).animate({top:-500},r),function(t){t&&e.stop()}};return{addClass:e,removeClass:t}}angular.module("app.widgets",["ngAnimate"]).animation(".book",e)}(),function(){"use strict";angular.module("app.widgets",[]).filter("stripspaces",[function(){return function(e){return angular.isString(e)?e.replace(/[\s]/g,""):e}}]).filter("capitalize",[function(){return function(e){if(!angular.isString(e))return e;var t=e.charAt(0).toUpperCase()+e.slice(1);return t}}])}(),function(){"use strict";angular.module("app.home",[])}(),function(){"use strict";function e(e,t,r,a,o){function n(r){t.resetOpts(),t.updateOpts(r),t.transitionStateAndSearch(),e.showSpinner=!0}function s(){t.resetOpts(),t.updateOpts({sort:a.date_added,from:0}),t.transitionStateAndSearch(),e.showSpinner=!0}e.totalTitles=o.numTotalTitles,e.newSearch=n,e.mostRecentSearch=s,e.showSpinner=!1}angular.module("app.home").controller("HomePageCtrl",["$scope","SearchService","$state","SORT_MODES","config",e])}(),function(){"use strict";angular.module("app.search",[])}(),function(){"use strict";function e(e,t,r,a,o,n,s,c,i){function l(t){p.updateOpts(t),console.log("SearchCtrl::updateSearch() -- add'l opts: "+JSON.stringify(t)),console.log("SearchCtrl::updateSearch() -- merged SearchService.opts: "+JSON.stringify(p.opts)),e.showSpinner=!0,p.transitionStateAndSearch()}function u(e,t){var r=Date.now();a.saveSearch(e,t,r)}function d(t){var r=!1;return e.allPageSizeOptions.filter(function(e){return!r&&e>=t?(r=!0,e):e<=t})}var p=r;e.isOpenCreator=!0,e.isOpenSubject=!0,e.isOpenLanguage=!0,e.isOpenFrom=!0,e.hits=o.hits,e.numTotalHits=o.numTotalHits,e.facets=o.facets,e.activeFacets=p.opts.facets,e.advancedFields=p.opts.advancedFields,e.fromDate=p.opts.date.gte,e.toDate=p.opts.date.lte,e.dateRange=p.opts.date,e.queryTerms=p.opts.q,e.newQueryTerm="",e.pagination={page:p.calculatePage(),size:parseInt(p.opts.size),from:parseInt(p.opts.from)},e.categories=c,e.sort=n[p.opts.sort].display,e.showSpinner=!1,console.log("SearchCtrl::$scope.sort: "+JSON.stringify(e.sort)),console.log("SearchCtrl::$scope.pagination: "+JSON.stringify(e.pagination)),console.log("SearchCtrl::$scope.numTotalHits: "+e.numTotalHits),e.savedRecords=a.getRecords(),e.bookMarkText="",u(p.opts,e.numTotalHits),e.allPageSizeOptions=[10,25,50,100],e.validSortModes=n,e.validPageSizeOptions=d(e.numTotalHits),e.newQuerySearch=function(t){t&&(t=t.trim(),e.queryTerms.indexOf(t)===-1&&e.queryTerms.push(t.toLowerCase()));var r={q:e.queryTerms,from:0,sort:n[i]};e.newQueryTerm="",l(r)},e.setPageSize=function(e){console.log("SearchCtrl::setPageSize - current: "+p.opts.size+" , new: "+e),l({size:e,from:0})},e.setSortMode=function(e){console.log("Changing sort to "+e.display),l({sort:e,from:0})},e.setDateRange=function(e,t){console.log("fromDate: "+e+", toDate: "+t),l({date:{gte:e,lte:t},from:0})},e.setPageNum=function(e){if(console.log("SearchCtrl::setPageNum -- calculatePage():"+p.calculatePage()+" , newPage: "+e),p.calculatePage()!==e){var t=p.opts.size*(e-1);console.log("SearchCtrl........updating from from: "+p.opts.from+" to: "+t),l({from:t})}},e.updateFacet=function(t,r){e.showSpinner=!0,r?p.activateFacet(t):p.deActivateFacet(t),p.updateOpts({from:0}),p.transitionStateAndSearch()},e.toggleFacet=function(t){e.updateFacet(t,!t.active)},e.clearAdvancedField=function(t){e.showSpinner=!0;var r=p.opts.advancedFields.indexOf(t);p.opts.advancedFields.splice(r,1),p.updateOpts({advancedFields:p.opts.advancedFields,from:0}),p.transitionStateAndSearch()},e.clearSearchOpts=function(){e.showSpinner=!0,p.resetOpts(),p.transitionStateAndSearch()},e.clearQueryTerm=function(t){e.showSpinner=!0,e.queryTerms=e.queryTerms.filter(function(e){return e!==t}),l({q:e.queryTerms,from:0})},e.clearDateRange=function(){p.opts.date={},l({from:0})}}angular.module("app.search").controller("SearchCtrl",["$scope","$state","SearchService","SavedRecordsService","searchResults","SORT_MODES","DEFAULTS","FACETS","SORT_DEFAULT",e])}(),function(){"use strict";angular.module("app.search").directive("adjustSize",function(){return function(e,t,r){t.bind("keyup",function(){var e=t.val().length;if(e>3){var r=100+5*e;t.css("width",r+"px")}})}}).directive("focusHomeSearch",function(){return function(e,t,r){t[0].querySelector(".search-input").focus()}}).directive("focusSearchOnLoad",function(){return function(e,t,r){t[0].querySelector("#facet-chip-input").focus(),t.addClass("input-div-focus")}}).directive("focusSearchInput",function(){return function(e,t,r){t[0].querySelector("#facet-chip-input").focus(),t.addClass("input-div-focus"),$(document).on("click",function(e){$(e.target).hasClass("facet-search")||$(e.target).is("a")||$(e.target).is("button")||"checkbox"===e.target.type||t.hasClass("input-div-focus")&&t.removeClass("input-div-focus")}),t.bind("click",function(){var e=t[0].querySelector("#facet-chip-input");e.focus(),t.addClass("input-div-focus")})}})}(),function(){"use strict";angular.module("app.saved-records",[])}(),function(){"use strict";function e(e,t,r,a,o,n,s,c){e.savedRecords=r,e.savedSearches=a,e.numRecords=e.savedRecords.length,e.currentSort="",e.currentPage=1,e.recordsActive=!0,e.searchesActive=!1,e.validSortModes=s,e.showSpinner=!1,e.setActiveTab=function(t){"records"===t?(e.recordsActive=!0,e.searchesActive=!1):(e.recordsActive=!1,e.searchesActive=!0)},e.refresh=function(){e.savedRecords=o.getRecords(),e.numRecords=e.savedRecords.length},e.sortRecords=function(t){var r;switch(t.mode){case s.titleAZ.mode:r=function(e,t){return e._title_display<t._title_display?-1:e._title_display>t._title_display?1:0},e.currentSort=s.titleAZ.display;break;case s.titleZA.mode:r=function(e,t){return e._title_display>t._title_display?-1:e._title_display<t._title_display?1:0},e.currentSort=s.titleZA.display;break;case s.dateAdded.mode:r=function(e,t){return e._ingest_date<t._ingest_date?-1:e._ingest_date>t._ingest_date?1:e._title_display<t._title_display?-1:1},e.currentSort=s.dateAdded.display;break;case s.dateAscend.mode:r=function(e,t){return e._date_facet<t._date_facet?-1:e._date_facet>t._date_facet?1:0},e.currentSort=s.dateAscend.display;break;case s.dateDesc.mode:r=function(e,t){return e._date_facet>t._date_facet?-1:e._date_facet<t._date_facet?1:0},e.currentSort=s.dateDesc.display}e.currentPage=1,e.savedRecords=e.savedRecords.sort(r)},e.removeSearch=function(t){var r={opts:t.opts,numResults:t.numResults,time:t.time};o.removeSearch(r),e.savedSearches=o.getSearches()},e.runSearch=function(t){e.showSpinner=!0,n.resetOpts(),n.updateOpts(t.opts),n.transitionStateAndSearch()}}angular.module("app.saved-records").controller("SavedRecordsCtrl",["$scope","$state","records","searches","SavedRecordsService","SearchService","SAVED_RECORDS_SORT","_",e])}(),function(){"use strict";angular.module("app.saved-records").constant("SAVED_RECORDS_SORT",{dateAdded:{display:"Newly Added First",mode:"date_added"},titleAZ:{display:"Title: A-Z",mode:"title_asc"},titleZA:{display:"Title: Z-A",mode:"title_desc"},dateAscend:{display:"Date (ascending)",mode:"date_asc"},dateDesc:{display:"Date (descending)",mode:"date_desc"}})}(),function(){"use strict";angular.module("app.advanced-search",[])}(),function(){"use strict";function e(e,t,r,a){function o(){var t={field:c,term:"",lastFilter:!0};e.filters[e.filters.length-1].lastFilter=!1,e.filters.push(t)}function n(e,t){e.field=t}function s(){e.showSpinner=!0;var t=[],a=[];e.queryTerm&&a.push(e.queryTerm),e.filters.forEach(function(e){e.term&&e.field!==c&&t.push(r.buildAdvancedField(e.field,e.term))});var o={q:a,advancedFields:t};r.resetOpts(),r.updateOpts(o),r.transitionStateAndSearch()}e.filters=[],e.fields=[],e.queryTerm="",e.addFilter=o,e.selectField=n,e.search=s;var c={display:"- Select Field -",searchKey:""};e.$on("$stateChangeSuccess",function(t,r,o,n,s){e.showSpinner=!1,e.filters=[{field:c,term:"",lastFilter:!0}],e.fields=[a.title,a.creator,a.date,a.language,a.subject,a.grp_contributor]})}angular.module("app.advanced-search").controller("AdvancedSearchCtrl",["$scope","$state","SearchService","ADVANCED_SEARCH",e])}(),function(){"use strict";angular.module("app.advanced-search").constant("ADVANCED_SEARCH",{title:{paramName:"adv_title",display:"Title",searchKey:"dublin_core.title"},creator:{paramName:"adv_creator",display:"Creator",searchKey:"dublin_core.creator"},date:{paramName:"adv_date",display:"Date",searchKey:"dublin_core.date"},language:{paramName:"adv_language",display:"Language",searchKey:"dublin_core.language"},subject:{paramName:"adv_subject",display:"Subject",searchKey:"dublin_core.subject"},grp_contributor:{paramName:"adv_grp_contributor",display:"From",searchKey:"_grp_contributor"}})}(),function(){"use strict";angular.module("app.contributors",[])}(),function(){"use strict";function e(e,t,r){var a=t;e.institutions=r,e.contribSearch=function(e){a.resetOpts(),a.activateFacet(a.buildFacet("grp_contributor",e)),a.transitionStateAndSearch()}}angular.module("app.contributors").controller("ContributorsCtrl",["$scope","SearchService","contributors",e])}(),function(){"use strict";angular.module("app.book-detail",[])}(),function(){"use strict";function e(e,t,r,a,o,n){function s(){var t="book.json";e.showSpinner=!0,o.getDcRec(e.book._id).success(function(r){"object"==typeof r&&(r=angular.toJson(r,void 0,2),e.fileContents=r),i(r,"text/json",t)})["finally"](function(){e.showSpinner=!1})}function c(){var t="book.ris";e.showSpinner=!0,o.getRisRec(e.book._id).success(function(r){e.fileContentsRis=r,i(r,"application/x-research-info-systems",t)})["finally"](function(){e.showSpinner=!1})}function i(e,t,r){var a=new Blob([e],{type:t}),o=document.createEvent("MouseEvents"),n=document.createElement("a");n.download=r,n.href=window.URL.createObjectURL(a),n.dataset.downloadurl=[t,n.download,n.href].join(":"),o.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(o)}e.saveAsJson=s,e.saveAsRis=c,e.showSpinner=!0,e.book=a,o.getBookData(e.book._id).success(function(t){var r=t._source;r._id=t._id,e.book=r})["finally"](function(){e.showSpinner=!1}),e.redirect=function(){return r.location.assign(e.book._source._record_link),!1}}angular.module("app.book-detail").controller("BookDetailCtrl",["$scope","$stateParams","$window","book","DataService",e])}(),function(){"use strict";angular.module("app.controller",["ui.bootstrap"]).controller("SearchHelpCtrl",["config","$scope",function(e,t){t.searchHelp={name:"searchhelp.html",url:e.app.root+"/partials/help.html"},t.showSpinner=!1}]).controller("FeedbackFormCtrl",["config","$scope","$state","$http","$location","$window",function(e,t,r,a,o,n){t.showSpinner=!1,t.feedbackFields=["Problem","Question","Comment"],t.master={first_name:"",last_name:"",email:"",confirmation_email:"",organization:"",type_of_feedback:t.feedbackFields[0],user_feedback:""},t.reset=function(){t.user=angular.copy(t.master),t.isMatch=function(){return t.user.email===t.user.confirmation_email}},t.reset(),t.sendMail=function(){if(t.feedbackForm.$valid&&t.isMatch()){var o=t.user,n={method:"POST",url:e.django.host+":"+e.django.port+"/api/send-email/",headers:{"Content-Type":"application/json"},data:o};a(n).then(function(e){console.log(o),console.log("message successfully sent"),r.go("thanks")},function(e){r.go("thanks")})}else t.feedbackForm.$submitted=!0},t.feedbackErrors=[{msg:"This field is required."},{msg:"Please enter a valid email address."},{msg:"Email addresses do not match."}]}]).controller("FacetModalCtrl",["$scope","$rootScope","config","$uibModal",function(e,t,r,a){e.openFacetModal=function(t,o){var n=a.open({animation:!0,scope:e,templateUrl:r.app.root+"/search/search.facet_modal.html",controller:"FacetModalInstanceCtrl",resolve:{facets:function(){return t},category:function(){return o}}});n.result.then(function(t){if(t){var r=t[0],a=t[1];r.forEach(function(t){e.updateFacet(t,!0)}),a.forEach(function(t){e.updateFacet(t,!1)})}})}}]).controller("FacetModalInstanceCtrl",["$scope","$uibModalInstance","facets","category",function(e,t,r,a){function o(){S=r,e.facetCategories=[{name:"creator",display:"Creator/ Contributor"},{name:"subject",display:"Subject"},{name:"language",display:"Language"},{name:"grp_contributor",display:"From"}],e.currentFacets=r[a],e.categoryFacets=r[a],s()}function n(e){return e.category+e.value}function s(){for(var t in S)for(var r=S[t],a=0;a<r.length;a++){var o=r[a];if(o.active){e.filterCount++,y[t]?y[t]++:y[t]=1;var s=n(o);_[s]={facetObj:o,checked:!0}}e.selectedFacets[o.value]=o.active}}function c(t){e.currentFacets=S[t],e.categoryFacets=this.currentFacets,m=t,e.text="",v=!1,e.filterViewText=h[0]}function i(e){return m===e}function l(t){var r=t.category,a=t.value;e.selectedFacets[a]?(y[r]?y[r]++:y[r]=1,e.filterCount++):(e.filterCount--,y[r]--);var o=n(t);_[o]?_[o].checked=!_[o].checked:_[o]={facetObj:t,checked:!0}}function u(e){return y[e]}function d(){if(v=!v){e.filterViewText=h[1];for(var t=[],r=0;r<e.currentFacets.length;r++){var a=e.currentFacets[r];e.selectedFacets[a.value]&&t.push(a)}e.currentFacets=t}else e.filterViewText=h[0],e.currentFacets=S[m]}function p(){var e=[],r=[];for(var a in _){var o=_[a].facetObj;_[a].checked?e.push(o):r.push(o)}var n=[e,r];t.close(n)}function f(){t.close()}function g(){for(var t=[],r=0;r<e.categoryFacets.length;r++){var a=e.categoryFacets[r];a.value.toLowerCase().indexOf(e.text.toLowerCase())>-1&&t.push(a)}e.currentFacets=t}e.text="",e.filterCount=0,e.currentFacets=[],e.selectedFacets=[],e.facetCategories=[],e.isActive=i,e.switchFacetCategory=c,e.isCategorySelected=u,e.searchFilters=g,e.apply=p,e.checkFacet=l,e.toggleFilterView=d,e.close=f,e.filterViewText="See Only Checked Filters";var h=["See Only Checked Filters","See All Filters"],v=!1,m=a,S=[],y={},_={};o()}])}(),function(){"use strict";angular.module("app").directive("saveRecordButton",["$state","SavedRecordsService","SAVED_ITEMS",function(e,t,r){return{restrict:"AE",replace:"true",scope:!1,templateUrl:"app/partials/save-record-button.html",link:function(r,a,o){function n(e){t.saveRecord(e);var a=t.getRecords();a?r.savedRecords=a:r.savedRecords=[]}function s(a){t.removeRecord(a),r.savedRecords=t.getRecords(),"SavedRecordsCtrl"===e.current.controller&&r.refresh()}r.isRecordSaved=function(e){var r=t.getRecords();if(r){for(var a=0;a<r.length;a++){var o=r[a];if(o._id===e._id)return!0}return!1}return!1},r.saveRecordHover=function(e){this.showBookmarkText=!0,r.isRecordSaved(e)?r.bookMarkText="Remove Record":r.bookMarkText="Save Record"},r.saveRecordHoverOut=function(){this.showBookmarkText=!1},r.toggleSavingBook=function(e){r.isRecordSaved(e)?(s(e),r.bookMarkText="Save Record"):(n(e),r.bookMarkText="Remove Record")}}}}]).directive("storageEventListener",["$state","SavedRecordsService","SAVED_ITEMS",function(e,t,r){return{restrict:"AE",template:"",link:function(t,a,o){angular.element(window).on("storage",function(a){a.key===r.recordKey&&("SavedRecordsCtrl"===e.current.controller&&t.refresh(),t.$apply())})}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5lbnYuY29uZmlnLmpzIiwiYXBwLm1vZHVsZS5qcyIsImFwcC5jb25maWcucm91dGluZy5qcyIsImNvcmUubW9kdWxlLmpzIiwiY29uc3RhbnRzLmpzIiwic2VhcmNoLXJlcy1wYXJzZXIuanMiLCJzZWFyY2gtc2VydmljZS5qcyIsImRhdGEtc2VydmljZS5qcyIsInNhdmVkLXJlY29yZHMtc2VydmljZS5qcyIsInN0b3JhZ2Utc2VydmljZS5qcyIsIndpZGdldHMubW9kdWxlLmpzIiwiY29uZmlnLmpzIiwic2Nyb2xsLmpzIiwiYW5pbWF0aW9ucy5qcyIsInV0aWxzLmpzIiwiaG9tZS5tb2R1bGUuanMiLCJob21lLmNvbnRyb2xsZXIuanMiLCJzZWFyY2gubW9kdWxlLmpzIiwic2VhcmNoLmNvbnRyb2xsZXIuanMiLCJzZWFyY2guZGlyZWN0aXZlLmpzIiwic2F2ZWQtcmVjb3Jkcy5tb2R1bGUuanMiLCJzYXZlZC1yZWNvcmRzLmNvbnRyb2xsZXIuanMiLCJhZHZhbmNlZC1zZWFyY2gubW9kdWxlLmpzIiwiYWR2YW5jZWQtc2VhcmNoLmNvbnRyb2xsZXIuanMiLCJjb250cmlidXRvcnMubW9kdWxlLmpzIiwiY29udHJpYnV0b3JzLmNvbnRyb2xsZXIuanMiLCJib29rLWRldGFpbC5tb2R1bGUuanMiLCJib29rLWRldGFpbC5jb250cm9sbGVyLmpzIiwiYXBwLmNvbnRyb2xsZXIuanMiLCJhcHAuZGlyZWN0aXZlLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25zdGFudCIsImVudiIsImVsYXN0aWMiLCJob3N0IiwicG9ydCIsImFwaVZlcnNpb24iLCJhcHAiLCJyb290IiwiZGphbmdvIiwiY29uZmlnIiwiJGh0dHBQcm92aWRlciIsImRlZmF1bHRzIiwieHNyZkNvb2tpZU5hbWUiLCJ4c3JmSGVhZGVyTmFtZSIsImhlYWRlcnMiLCJwb3N0Iiwid2luZG93IiwiXyIsIiRjb21waWxlUHJvdmlkZXIiLCJkZWJ1Z0luZm9FbmFibGVkIiwiY29uc29sZSIsImxvZyIsInJ1biIsIiRyb290U2NvcGUiLCIkc3RhdGUiLCIkc3RhdGVQYXJhbXMiLCIkYWN0aXZlVGFicyIsInNob3dTcGlubm5lciIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJvdGhlcndpc2UiLCJzdGF0ZSIsInVybCIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsInBhcmFtcyIsInEiLCJhcnJheSIsImNyZWF0b3IiLCJncnBfY29udHJpYnV0b3IiLCJsYW5ndWFnZSIsInN1YmplY3QiLCJhZHZfY3JlYXRvciIsImFkdl9ncnBfY29udHJpYnV0b3IiLCJhZHZfbGFuZ3VhZ2UiLCJhZHZfc3ViamVjdCIsImFkdl9kYXRlIiwiYWR2X3RpdGxlIiwicmVzb2x2ZSIsInNlYXJjaFJlc3VsdHMiLCJTZWFyY2hTZXJ2aWNlIiwiRGF0YVNlcnZpY2UiLCJTT1JUX01PREVTIiwiQURWQU5DRURfU0VBUkNIIiwic2hvd1NwaW5uZXIiLCJKU09OIiwic3RyaW5naWZ5Iiwic3MiLCJvcHRzIiwiZ2V0RGVmYXVsdE9wdHNPYmoiLCJzaXplIiwicGFyc2VJbnQiLCJmcm9tIiwic29ydCIsInRvTG93ZXJDYXNlIiwiZGF0ZV9ndGUiLCJkYXRlIiwiZ3RlIiwiZGF0ZV9sdGUiLCJsdGUiLCJzZWVuIiwiZmlsdGVyIiwidGVybSIsIm1hcCIsImZhY2V0Q2F0ZWdvcmllc0xpc3QiLCJmb3JFYWNoIiwiY2F0ZWdvcnkiLCJsZW5ndGgiLCJmYWNldFZhbCIsIm5ld0ZhY2V0IiwiYnVpbGRGYWNldCIsImZhY2V0cyIsInB1c2giLCJhZHZhbmNlZEZpZWxkc0xpc3QiLCJuYW1lIiwicHJvcHMiLCJwYXJhbVZhbHVlcyIsInBhcmFtTmFtZSIsInBhcmFtVmFsIiwibmV3QWR2RmllbGQiLCJidWlsZEFkdmFuY2VkRmllbGQiLCJhZHZhbmNlZEZpZWxkcyIsInNlYXJjaCIsImJvb2siLCJfaWQiLCJib29rSUQiLCJjb250cmlidXRvcnMiLCJnZXRDb250cmlidXRvcnMiLCJzcGlubmVyIiwicmVjb3JkcyIsIiRxIiwiU2F2ZWRSZWNvcmRzU2VydmljZSIsIndoZW4iLCJnZXRSZWNvcmRzIiwidGhlbiIsInNlYXJjaGVzIiwiZ2V0U2VhcmNoZXMiLCJodG1sNU1vZGUiLCJrZXkiLCJkaXNwbGF5Iiwib3B0aW9ucyIsInJhd0tleSIsInJlbGV2YW5jZSIsIm1vZGUiLCJkYXRlX2FkZGVkIiwic29ydFF1ZXJ5IiwiX2luZ2VzdF9kYXRlIiwib3JkZXIiLCJ0aXRsZV9hc2MiLCJ0aXRsZV9kZXNjIiwiX3RpdGxlX2Rpc3BsYXkuc29ydCIsImRhdGVfYXNjIiwiZGF0ZV9kZXNjIiwiX2RhdGVfZmFjZXQiLCJyZWNvcmRLZXkiLCJzZWFyY2hLZXkiLCJnZXR0eUlEIiwic2VhcmNoT3B0cyIsIlNlYXJjaFJlc1BhcnNlciIsIkZBQ0VUUyIsInBhcnNlUmVzdWx0cyIsImhpdHMiLCJkYXRhIiwiX3NvdXJjZSIsInBhcnNlQWdncmVnYXRpb25SZXN1bHRzIiwiYWdnIiwiZmFjZXROYW1lIiwiYWN0aXZlRmFjZXRzIiwiYnVja2V0cyIsImZhY2V0T3B0aW9uIiwicGFyc2VkT3B0aW9uIiwidmFsdWUiLCJjb3VudCIsImRvY19jb3VudCIsImFjdGl2ZSIsImZhY2V0Iiwic2VydmljZSIsImZhY3RvcnkiLCJTT1JUX0RFRkFVTFQiLCJGUk9NX0RFRkFVTFQiLCJTSVpFX0RFRkFVTFQiLCJidWlsZFF1ZXJ5UGFyYW1zIiwicXVlcnlQYXJhbXMiLCJ0aGlzIiwiYWR2RmllbGQiLCJmaWVsZCIsInBhcnNlRmFjZXRzVG9PYmoiLCJfdGhpcyIsIm9iaiIsInVwZGF0ZU9wdHMiLCJuZXdPcHRzIiwibWVyZ2UiLCJ1cGRhdGVEYXRlIiwic2V0UmVzdWx0c0RhdGEiLCJyZXN1bHRzIiwibnVtVG90YWxIaXRzIiwidG90YWwiLCJhZ2dyZWdhdGlvbnMiLCJmYWNldE9wdGlvbnMiLCJyZXNldE9wdHMiLCJjYWxjdWxhdGVQYWdlIiwicGFnZSIsIk1hdGgiLCJjZWlsIiwiaXNWYWxpZENhdGVnb3J5IiwidW5kZWZpbmVkIiwiaW5kZXhPZiIsImlzVmFsaWRGYWNldCIsIkJvb2xlYW4iLCJpc1NhbWVGYWNldCIsImZhY2V0QSIsImZhY2V0QiIsImFjdGl2YXRlRmFjZXQiLCJkdXBlRmFjZXQiLCJvdGhlckZhY2V0IiwiZGVBY3RpdmF0ZUZhY2V0IiwicmVtb3ZlIiwiZiIsImNsZWFyRmFjZXRzSW4iLCJpIiwic3BsaWNlIiwidHJhbnNpdGlvblN0YXRlQW5kU2VhcmNoIiwiZ28iLCJyZWxvYWQiLCJpbmhlcml0IiwiT2JqZWN0Iiwia2V5cyIsIiRodHRwIiwicXVlcnkiLCJxdWVyeVRlcm0iLCJhZHZhbmNlZCIsInF1ZXJ5UGF0aCIsImpvaW4iLCJzZWFyY2hQcm9taXNlIiwiZ2V0IiwiZGVmZXJyZWQiLCJkZWZlciIsInN1Y2Nlc3MiLCJwYXJzZWREYXRhIiwiZXJyb3IiLCJyZXNwb25zZSIsInJlamVjdCIsImFyZ3VtZW50cyIsInByb21pc2UiLCJjb250cmlidXRvcnNQcm9taXNlIiwiZ2V0Qm9va0RhdGEiLCJnZXRSaXNSZWMiLCJnZXREY1JlYyIsIlNBVkVEX0lURU1TIiwiREVGQVVMVFMiLCJTdG9yYWdlU2VydmljZSIsInNlYXJjaGVzTWF0Y2giLCJvbGRTZWFyY2giLCJuZXdTZWFyY2giLCJpc0VxdWFsIiwic2F2ZVNlYXJjaCIsInRpbWVzdGFtcCIsImxhc3RTZWFyY2hPcHRzIiwibGFzdFNlYXJjaCIsIm51bVJlc3VsdHMiLCJ0aW1lIiwic2F2ZUl0ZW0iLCJnZXRJdGVtcyIsInJlbW92ZVNlYXJjaCIsInJlbW92ZUl0ZW0iLCJzYXZlUmVjb3JkIiwicmVjb3JkIiwicmVtb3ZlUmVjb3JkIiwidHlwZSIsIml0ZW1zIiwicGFyc2UiLCJpdGVtIiwic2F2ZWRJdGVtcyIsInNldEl0ZW0iLCJhbGVydCIsIm5ld1JlY29yZHMiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiZSIsIm5ld0l0ZW0iLCJpdGVtQXNTdHJpbmciLCJwYWdpbmF0aW9uVGVtcGxhdGVQcm92aWRlciIsInNldFBhdGgiLCJhbmNob3JTbW9vdGhTY3JvbGwiLCJzY3JvbGxUbyIsImVJRCIsImN1cnJlbnRZUG9zaXRpb24iLCJzZWxmIiwicGFnZVlPZmZzZXQiLCJkb2N1bWVudCIsImRvY3VtZW50RWxlbWVudCIsInNjcm9sbFRvcCIsImJvZHkiLCJlbG1ZUG9zaXRpb24iLCJlbG0iLCJnZXRFbGVtZW50QnlJZCIsInkiLCJvZmZzZXRUb3AiLCJub2RlIiwib2Zmc2V0UGFyZW50Iiwic3RhcnRZIiwic3RvcFkiLCJkaXN0YW5jZSIsInNwZWVkIiwicm91bmQiLCJzdGVwIiwibGVhcFkiLCJ0aW1lciIsInNldFRpbWVvdXQiLCJTY3JvbGxDdHJsIiwiJHNjb3BlIiwiJGxvY2F0aW9uIiwiZ290b0VsZW1lbnQiLCJoYXNoIiwiYW5pbWF0aW9uRnVuY3MiLCJhbmltYXRlVXAiLCJlbGVtZW50IiwiY2xhc3NOYW1lIiwiZG9uZSIsImNzcyIsInBvc2l0aW9uIiwidG9wIiwibGVmdCIsImpRdWVyeSIsImFuaW1hdGUiLCJjYW5jZWwiLCJzdG9wIiwiYW5pbWF0ZURvd24iLCJhZGRDbGFzcyIsInJlbW92ZUNsYXNzIiwiYW5pbWF0aW9uIiwiaW5wdXQiLCJpc1N0cmluZyIsInJlcGxhY2UiLCJjYXBpdGFsaXplZCIsImNoYXJBdCIsInRvVXBwZXJDYXNlIiwic2xpY2UiLCJIb21lUGFnZUN0cmwiLCJtb3N0UmVjZW50U2VhcmNoIiwidG90YWxUaXRsZXMiLCJudW1Ub3RhbFRpdGxlcyIsIlNlYXJjaEN0cmwiLCJ1cGRhdGVTZWFyY2giLCJEYXRlIiwibm93IiwiZ2V0VmFsaWRQYWdlU2l6ZU9wdGlvbnMiLCJwYXNzZWRUaHJlc2hvbGQiLCJhbGxQYWdlU2l6ZU9wdGlvbnMiLCJwYWdlU2l6ZSIsImlzT3BlbkNyZWF0b3IiLCJpc09wZW5TdWJqZWN0IiwiaXNPcGVuTGFuZ3VhZ2UiLCJpc09wZW5Gcm9tIiwiZnJvbURhdGUiLCJ0b0RhdGUiLCJkYXRlUmFuZ2UiLCJxdWVyeVRlcm1zIiwibmV3UXVlcnlUZXJtIiwicGFnaW5hdGlvbiIsImNhdGVnb3JpZXMiLCJzYXZlZFJlY29yZHMiLCJib29rTWFya1RleHQiLCJ2YWxpZFNvcnRNb2RlcyIsInZhbGlkUGFnZVNpemVPcHRpb25zIiwibmV3UXVlcnlTZWFyY2giLCJ0cmltIiwic2V0UGFnZVNpemUiLCJuZXdQYWdlU2l6ZSIsInNldFNvcnRNb2RlIiwic29ydE1vZGUiLCJzZXREYXRlUmFuZ2UiLCJzZXRQYWdlTnVtIiwibmV3UGFnZSIsIm5ld0Zyb20iLCJ1cGRhdGVGYWNldCIsInRvZ2dsZUZhY2V0IiwiY2xlYXJBZHZhbmNlZEZpZWxkIiwiaW5kZXgiLCJjbGVhclNlYXJjaE9wdHMiLCJjbGVhclF1ZXJ5VGVybSIsImNsZWFyRGF0ZVJhbmdlIiwiZGlyZWN0aXZlIiwic2NvcGUiLCJlbGVtIiwiYXR0ciIsImJpbmQiLCJ3aWR0aCIsInZhbCIsIm5ld1dpZHRoIiwicXVlcnlTZWxlY3RvciIsImZvY3VzIiwiJCIsIm9uIiwidGFyZ2V0IiwiaGFzQ2xhc3MiLCJpcyIsIlNhdmVkUmVjb3Jkc0N0cmwiLCJTQVZFRF9SRUNPUkRTX1NPUlQiLCJzYXZlZFNlYXJjaGVzIiwibnVtUmVjb3JkcyIsImN1cnJlbnRTb3J0IiwiY3VycmVudFBhZ2UiLCJyZWNvcmRzQWN0aXZlIiwic2VhcmNoZXNBY3RpdmUiLCJzZXRBY3RpdmVUYWIiLCJ0YWIiLCJyZWZyZXNoIiwic29ydFJlY29yZHMiLCJzb3J0RnVuY3Rpb24iLCJ0aXRsZUFaIiwiYSIsImIiLCJfdGl0bGVfZGlzcGxheSIsInRpdGxlWkEiLCJkYXRlQWRkZWQiLCJkYXRlQXNjZW5kIiwiZGF0ZURlc2MiLCJyZW1vdmVkIiwicnVuU2VhcmNoIiwiQWR2YW5jZWRTZWFyY2hDdHJsIiwiYWRkRmlsdGVyIiwibmV3RmlsdGVyIiwiaW5pdGlhbEZpZWxkIiwibGFzdEZpbHRlciIsImZpbHRlcnMiLCJzZWxlY3RGaWVsZCIsImFkdkZpZWxkcyIsImZpZWxkcyIsIiRvbiIsImV2ZW50IiwidG9TdGF0ZSIsInRvUGFyYW1zIiwiZnJvbVN0YXRlIiwiZnJvbVBhcmFtcyIsInRpdGxlIiwiQ29udHJpYnV0b3JzQ3RybCIsImluc3RpdHV0aW9ucyIsImNvbnRyaWJTZWFyY2giLCJjb250cmlidXRvciIsIkJvb2tEZXRhaWxDdHJsIiwiJHdpbmRvdyIsInJpc1JlYyIsInNhdmVBc0pzb24iLCJmaWxlbmFtZSIsInRvSnNvbiIsImZpbGVDb250ZW50cyIsImNyZWF0ZUJsb2JBbmREb3dubG9hZCIsInNhdmVBc1JpcyIsImZpbGVDb250ZW50c1JpcyIsIk1pbWVUeXBlIiwiYmxvYiIsIkJsb2IiLCJjcmVhdGVFdmVudCIsImNyZWF0ZUVsZW1lbnQiLCJkb3dubG9hZCIsImhyZWYiLCJVUkwiLCJjcmVhdGVPYmplY3RVUkwiLCJkYXRhc2V0IiwiZG93bmxvYWR1cmwiLCJpbml0TW91c2VFdmVudCIsImRpc3BhdGNoRXZlbnQiLCJib29rRGF0YSIsInJlZGlyZWN0IiwibG9jYXRpb24iLCJhc3NpZ24iLCJfcmVjb3JkX2xpbmsiLCJzZWFyY2hIZWxwIiwiZmVlZGJhY2tGaWVsZHMiLCJtYXN0ZXIiLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwiZW1haWwiLCJjb25maXJtYXRpb25fZW1haWwiLCJvcmdhbml6YXRpb24iLCJ0eXBlX29mX2ZlZWRiYWNrIiwidXNlcl9mZWVkYmFjayIsInJlc2V0IiwidXNlciIsImNvcHkiLCJpc01hdGNoIiwic2VuZE1haWwiLCJmZWVkYmFja0Zvcm0iLCIkdmFsaWQiLCJyZXEiLCJtZXRob2QiLCJDb250ZW50LVR5cGUiLCIkc3VibWl0dGVkIiwiZmVlZGJhY2tFcnJvcnMiLCJtc2ciLCIkdWliTW9kYWwiLCJvcGVuRmFjZXRNb2RhbCIsIm1vZGFsSW5zdGFuY2UiLCJvcGVuIiwicmVzdWx0IiwiYWN0aXZhdGVkRmFjZXRzIiwiZGVhY3RpdmF0ZWRGYWNldHMiLCIkdWliTW9kYWxJbnN0YW5jZSIsImluaXRpYWxpemUiLCJhbGxGYWNldHMiLCJmYWNldENhdGVnb3JpZXMiLCJjdXJyZW50RmFjZXRzIiwiY2F0ZWdvcnlGYWNldHMiLCJzZXRGYWNldHNDaGVja2VkIiwiZ2V0RmFjZXRLZXkiLCJwcm9wIiwiZmFjZXRzQnlQcm9wIiwiZmlsdGVyQ291bnQiLCJjYXRlZ29yeUNvdW50cyIsImZhY2V0c1RvQXBwbHkiLCJmYWNldE9iaiIsImNoZWNrZWQiLCJzZWxlY3RlZEZhY2V0cyIsInN3aXRjaEZhY2V0Q2F0ZWdvcnkiLCJuZXdDYXRlZ29yeSIsImFjdGl2ZUNhdGVnb3J5IiwidGV4dCIsInNlZU9ubHlDaGVja2VkIiwiZmlsdGVyVmlld1RleHQiLCJzZWVPbmx5Q2hlY2tlZFRleHQiLCJpc0FjdGl2ZSIsImNhdCIsImNoZWNrRmFjZXQiLCJmYWNldENhdGVnb3J5IiwiZmFjZXRUZXh0IiwiaXNDYXRlZ29yeVNlbGVjdGVkIiwidG9nZ2xlRmlsdGVyVmlldyIsImNoZWNrZWRGaWx0ZXJzIiwiY3VycmVudEZhY2V0IiwiYXBwbHkiLCJhY3RpdmF0ZWQiLCJkZWFjdGl2YXRlZCIsImZhY2V0S2V5IiwiZmFjZXRzVG9VcGRhdGUiLCJjbG9zZSIsInNlYXJjaEZpbHRlcnMiLCJmaWx0ZXJlZEZhY2V0cyIsInJlc3RyaWN0IiwibGluayIsImF0dHJzIiwiY3VycmVudCIsImlzUmVjb3JkU2F2ZWQiLCJzYXZlUmVjb3JkSG92ZXIiLCJzaG93Qm9va21hcmtUZXh0Iiwic2F2ZVJlY29yZEhvdmVyT3V0IiwidG9nZ2xlU2F2aW5nQm9vayIsInRlbXBsYXRlIiwiJGFwcGx5Il0sIm1hcHBpbmdzIjoiQ0FBQSxXQUNBLE1BQUFBLFNBQUFDLE9BQUEscUJBQ0FDLFNBQUEsVUFBQUMsSUFBQSxRQUFBQyxTQUFBQyxLQUFBLG1CQUFBQyxLQUFBLE9BQUFDLFdBQUEsT0FBQUMsS0FBQUMsS0FBQSxPQUFBQyxRQUFBTCxLQUFBLG1CQUFBQyxLQUFBLGFDREEsV0FDQSxZQUVBTixTQUFBQyxPQUFBLE9BQ0EsWUFDQSxlQUNBLGlCQUNBLFdBQ0EsY0FDQSx3Q0FDQSxXQUNBLGFBQ0Esb0JBQ0Esc0JBQ0EsaUJB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QSxHQUFBOUksR0FBQSxFQUFBQSxFQUFBOEksRUFBQTlQLE9BQUFnSCxJQUFBLENBQ0EsR0FBQWtVLEdBQUFwTCxFQUFBOUksRUFDQSxJQUFBa1UsRUFBQWphLE1BQUFELEVBQUFDLElBQ0EsT0FBQSxFQUdBLE9BQUEsRUFFQSxPQUFBLEdBUUFtUSxFQUFBZ0ssZ0JBQUEsU0FBQXBhLEdBQ0E0RCxLQUFBeVcsa0JBQUEsRUFDQWpLLEVBQUErSixjQUFBbmEsR0FDQW9RLEVBQUFyQixhQUFBLGdCQUVBcUIsRUFBQXJCLGFBQUEsZUFPQXFCLEVBQUFrSyxtQkFBQSxXQUNBMVcsS0FBQXlXLGtCQUFBLEdBT0FqSyxFQUFBbUssaUJBQUEsU0FBQXZhLEdBQ0FvUSxFQUFBK0osY0FBQW5hLElBQ0FnSixFQUFBaEosR0FDQW9RLEVBQUFyQixhQUFBLGdCQUVBakcsRUFBQTlJLEdBQ0FvUSxFQUFBckIsYUFBQSx1QkFNQW9CLFVBQUEsd0JBQUEsU0FBQSxzQkFBQSxjQUFBLFNBQUF6VSxFQUFBOEUsRUFBQXFILEdBQ0EsT0FDQWtTLFNBQUEsS0FDQVMsU0FBQSxHQUNBUixLQUFBLFNBQUE1SixFQUFBQyxFQUFBNEosR0FHQWpnQixRQUFBaVMsUUFBQS9RLFFBQUE0VixHQUFBLFVBQUEsU0FBQXFDLEdBQ0FBLEVBQUFwUyxNQUFBOEcsRUFBQTlGLFlBQ0EscUJBQUFyRyxFQUFBd2UsUUFBQTdkLFlBQ0ErVCxFQUFBd0IsVUFFQXhCLEVBQUFxSyIsImZpbGUiOiJhcHBfY29yZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkgeyBcbiByZXR1cm4gYW5ndWxhci5tb2R1bGUoXCJhcHAuZW52LmNvbmZpZ1wiLCBbXSlcbi5jb25zdGFudChcImNvbmZpZ1wiLCB7XCJlbnZcIjpcImxvY2FsXCIsXCJlbGFzdGljXCI6e1wiaG9zdFwiOlwibG9jYWwucG9ydGFsLmRldlwiLFwicG9ydFwiOlwiOTIwMFwiLFwiYXBpVmVyc2lvblwiOlwiMi4wXCJ9LFwiYXBwXCI6e1wicm9vdFwiOlwiYXBwXCJ9LFwiZGphbmdvXCI6e1wiaG9zdFwiOlwiaHR0cDovLzEyNy4wLjAuMVwiLFwicG9ydFwiOlwiODAwMFwifX0pO1xuXG59KSgpO1xuIiwiLyogQXBwIE1vZHVsZSAqL1xuKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcbiAgICAndWkucm91dGVyJyxcbiAgICAndWkuYm9vdHN0cmFwJyxcbiAgICAnYXBwLmVudi5jb25maWcnLFxuICAgICdhcHAuY29yZScsXG4gICAgJ2FwcC53aWRnZXRzJyxcbiAgICAnYW5ndWxhclV0aWxzLmRpcmVjdGl2ZXMuZGlyUGFnaW5hdGlvbicsXG4gICAgJ2FwcC5ob21lJyxcbiAgICAnYXBwLnNlYXJjaCcsXG4gICAgJ2FwcC5zYXZlZC1yZWNvcmRzJyxcbiAgICAnYXBwLmFkdmFuY2VkLXNlYXJjaCcsXG4gICAgJ2FwcC5jb250cm9sbGVyJyxcbiAgICAnYXBwLmNvbnRyaWJ1dG9ycycsXG4gICAgJ2FwcC5ib29rLWRldGFpbCcsXG4gICAgJ0FuZ3VsYXJQcmludCcsXG4gICAgJ3Ntb290aFNjcm9sbCcsXG4gICAgJ25nQW5pbWF0ZScsXG4gICAgJ2FuZ3VsYXJTcGlubmVyJ1xuICBdKVxuXG4gIC5jb25maWcoWyckaHR0cFByb3ZpZGVyJywgZnVuY3Rpb24oJGh0dHBQcm92aWRlcikge1xuICAgICRodHRwUHJvdmlkZXIuZGVmYXVsdHMueHNyZkNvb2tpZU5hbWUgPSAnY3NyZnRva2VuJztcbiAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLnhzcmZIZWFkZXJOYW1lID0gJ1gtQ1NSRlRva2VuJztcbiAgICAkaHR0cFByb3ZpZGVyLmRlZmF1bHRzLmhlYWRlcnMucG9zdFsnQ29udGVudC1UeXBlJ10gPSAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJztcblxuICB9XSlcblxuICAvLyBtYWtlIGxvZGFzaCBpbmplY3RhYmxlXG4gIC5jb25zdGFudCgnXycsIHdpbmRvdy5fKVxuXG4gIC8vIHR1cm4gb2ZmIGFuZ3VsYXIgZGVidWcgbW9kZSBmb3IgcHJvZHVjdGlvbjsgaW1wcm92ZXMgcGVyZm9ybWFuY2VcbiAgLmNvbmZpZyhbJyRjb21waWxlUHJvdmlkZXInLCAnY29uZmlnJywgZnVuY3Rpb24oJGNvbXBpbGVQcm92aWRlciwgY29uZmlnKXtcbiAgICBpZihjb25maWcuZW52ID09PSAncHJvZCcpe1xuICAgICAgJGNvbXBpbGVQcm92aWRlci5kZWJ1Z0luZm9FbmFibGVkKGZhbHNlKTtcbiAgICAgIGNvbnNvbGUubG9nKCdJbiBwcm9kdWN0aW9uLiBEZWJ1ZyBtb2RlIGRpc2FibGVkJyk7XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICBjb25zb2xlLmxvZygnSW4gJyArIGNvbmZpZy5lbnYgKyAnLiBEZWJ1ZyBtb2RlIGVuYWJsZWQnKTtcbiAgICB9XG4gIH1dKVxuXG4gIC5ydW4oWyckcm9vdFNjb3BlJywgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc3RhdGUsICRzdGF0ZVBhcmFtcyl7XG4gICAgLy8gQ29udmVuaWVuY2UgdG8gYWNjZXNzIHRoaW5ncyBhbnkgc2NvcGUgdy9vdXQgaW5qZWN0aW9uXG4gICAgJHJvb3RTY29wZS4kc3RhdGUgPSAkc3RhdGU7XG4gICAgJHJvb3RTY29wZS4kc3RhdGVQYXJhbXMgPSAkc3RhdGVQYXJhbXM7XG5cbiAgICAvLyBhc3NpZ24gdGhpcyBoZXJlIHRvIHBlcnNpc3Qgb3BlbiB0YWJzIGFjcm9zcyBzdGFnZSBjaGFuZ2VzXG4gICAgJHJvb3RTY29wZS4kYWN0aXZlVGFicyA9IFtdO1xuICAgICRyb290U2NvcGUuc2hvd1NwaW5ubmVyID0gZmFsc2U7XG4gIH1dKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgLm1vZHVsZSgnYXBwJylcbiAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsICdjb25maWcnLCBmdW5jdGlvbigkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlciwgY29uZmlnKXtcbiAgICAvLyByZWRpcmVjdCB0byBob21lIGJ5IGRlZmF1bHRcbiAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG5cbiAgICAvLyBhc3NpZ24gc3RhdGVzIHRvIHVybHNcbiAgICAkc3RhdGVQcm92aWRlclxuICAgIC8vIGFic3RyYWN0IHN0YXRlIHVzZWQgdG8gbG9hZCBvdGhlciBzZWFyY2ggc3RhdGVzXG4gICAgICAuc3RhdGUoJ2hvbWUnLCB7XG4gICAgICAgIHVybDogJy8nLFxuICAgICAgICB0ZW1wbGF0ZVVybDogY29uZmlnLmFwcC5yb290ICsgJy9ob21lL2hvbWUuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdIb21lUGFnZUN0cmwnXG4gICAgICB9KVxuICAgICAgLnN0YXRlKCdzZWFyY2hSZXN1bHRzJywge1xuICAgICAgICB1cmw6ICcvc2VhcmNoP3EmZnJvbSZzaXplJnNvcnQmY3JlYXRvciZncnBfY29udHJpYnV0b3ImbGFuZ3VhZ2Umc3ViamVjdCZkYXRlX2d0ZSZkYXRlX2x0ZSZhZHZfY3JlYXRvciZhZHZfZGF0ZSZhZHZfZ3JwX2NvbnRyaWJ1dG9yJmFkdl9sYW5ndWFnZSZhZHZfc3ViamVjdCZhZHZfdGl0bGUnLFxuICAgICAgICBjb250cm9sbGVyOiAnU2VhcmNoQ3RybCcsXG4gICAgICAgIHRlbXBsYXRlVXJsOiBjb25maWcuYXBwLnJvb3QgKyAnL3NlYXJjaC9zZWFyY2gucmVzdWx0cy5odG1sJyxcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgcTogeyBhcnJheTogdHJ1ZX0sXG4gICAgICAgICAgLy8gZmFjZXQgb3B0aW9uc1xuICAgICAgICAgIGNyZWF0b3I6IHsgYXJyYXk6IHRydWUgfSxcbiAgICAgICAgICBncnBfY29udHJpYnV0b3I6IHsgYXJyYXk6IHRydWUgfSxcbiAgICAgICAgICBsYW5ndWFnZTogeyBhcnJheTogdHJ1ZSB9LFxuICAgICAgICAgIHN1YmplY3Q6IHsgYXJyYXk6IHRydWUgfSxcbiAgICAgICAgICAvLyBhZHZhbmNlZCBmaWVsZHNcbiAgICAgICAgICBhZHZfY3JlYXRvcjogeyBhcnJheTogdHJ1ZSB9LFxuICAgICAgICAgIGFkdl9ncnBfY29udHJpYnV0b3I6IHsgYXJyYXk6IHRydWUgfSxcbiAgICAgICAgICBhZHZfbGFuZ3VhZ2U6IHsgYXJyYXk6IHRydWUgfSxcbiAgICAgICAgICBhZHZfc3ViamVjdDogeyBhcnJheTogdHJ1ZSB9LFxuICAgICAgICAgIGFkdl9kYXRlOiB7IGFycmF5OiB0cnVlIH0sXG4gICAgICAgICAgYWR2X3RpdGxlOiB7IGFycmF5OiB0cnVlIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIHNlYXJjaFJlc3VsdHM6IFsnJHJvb3RTY29wZScsICckc3RhdGVQYXJhbXMnLCAnU2VhcmNoU2VydmljZScsICdEYXRhU2VydmljZScsICdTT1JUX01PREVTJywgJ0FEVkFOQ0VEX1NFQVJDSCcsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzdGF0ZVBhcmFtcywgU2VhcmNoU2VydmljZSwgRGF0YVNlcnZpY2UsIFNPUlRfTU9ERVMsIEFEVkFOQ0VEX1NFQVJDSCl7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLnNob3dTcGlubmVyID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSb3V0ZXIgLSBTZWFyY2hSZXN1bHRzIC0gaW4gUmVzb2x2ZSAtICRzdGF0ZVBhcmFtczogJyArIEpTT04uc3RyaW5naWZ5KCRzdGF0ZVBhcmFtcykpO1xuICAgICAgICAgICAgdmFyIHNzID0gU2VhcmNoU2VydmljZTtcbiAgICAgICAgICAgIHZhciBvcHRzID0gc3MuZ2V0RGVmYXVsdE9wdHNPYmooKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5zaXplKSB7XG4gICAgICAgICAgICAgIG9wdHMuc2l6ZSA9IHBhcnNlSW50KCRzdGF0ZVBhcmFtcy5zaXplKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgkc3RhdGVQYXJhbXMuZnJvbSkge1xuICAgICAgICAgICAgICBvcHRzLmZyb20gPSBwYXJzZUludCgkc3RhdGVQYXJhbXMuZnJvbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoJHN0YXRlUGFyYW1zLnNvcnQpIHtcbiAgICAgICAgICAgICAgb3B0cy5zb3J0ID0gJHN0YXRlUGFyYW1zLnNvcnQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgkc3RhdGVQYXJhbXMuZGF0ZV9ndGUpIHtcbiAgICAgICAgICAgICAgb3B0cy5kYXRlLmd0ZSA9IHBhcnNlSW50KCRzdGF0ZVBhcmFtcy5kYXRlX2d0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoJHN0YXRlUGFyYW1zLmRhdGVfbHRlKSB7XG4gICAgICAgICAgICAgIG9wdHMuZGF0ZS5sdGUgPSBwYXJzZUludCgkc3RhdGVQYXJhbXMuZGF0ZV9sdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoJHN0YXRlUGFyYW1zLnEpIHtcbiAgICAgICAgICAgICAgdmFyIHNlZW4gPSB7fTtcbiAgICAgICAgICAgICAgb3B0cy5xID0gJHN0YXRlUGFyYW1zLnEuZmlsdGVyKGZ1bmN0aW9uKHRlcm0pe1xuICAgICAgICAgICAgICAgIGlmIChzZWVuW3Rlcm1dKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHNlZW5bdGVybV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgb3B0cy5xID0gb3B0cy5xLm1hcChmdW5jdGlvbih0ZXJtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRlcm0udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGJ1aWxkIG9wdHMgZm9yIGZhY2V0IG9wdGlvbnNcbiAgICAgICAgICAgIHNzLmZhY2V0Q2F0ZWdvcmllc0xpc3QuZm9yRWFjaChmdW5jdGlvbihjYXRlZ29yeSl7XG4gICAgICAgICAgICAgIGlmKCRzdGF0ZVBhcmFtc1tjYXRlZ29yeV0gJiYgJHN0YXRlUGFyYW1zW2NhdGVnb3J5XS5sZW5ndGgpe1xuICAgICAgICAgICAgICAgICRzdGF0ZVBhcmFtc1tjYXRlZ29yeV0uZm9yRWFjaChmdW5jdGlvbihmYWNldFZhbCl7XG4gICAgICAgICAgICAgICAgICB2YXIgbmV3RmFjZXQgPSBzcy5idWlsZEZhY2V0KGNhdGVnb3J5LCBmYWNldFZhbCwgMCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICBpZihuZXdGYWNldCl7XG4gICAgICAgICAgICAgICAgICAgIG9wdHMuZmFjZXRzLnB1c2gobmV3RmFjZXQpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gYnVpbGQgb3B0cyBmb3IgYWR2YW5jZWQgZmllbGRzXG4gICAgICAgICAgICBzcy5hZHZhbmNlZEZpZWxkc0xpc3QuZm9yRWFjaChmdW5jdGlvbihuYW1lKXtcbiAgICAgICAgICAgICAgdmFyIHByb3BzID0gQURWQU5DRURfU0VBUkNIW25hbWVdO1xuICAgICAgICAgICAgICB2YXIgcGFyYW1WYWx1ZXMgPSAkc3RhdGVQYXJhbXNbcHJvcHMucGFyYW1OYW1lXTtcbiAgICAgICAgICAgICAgaWYocGFyYW1WYWx1ZXMpe1xuICAgICAgICAgICAgICAgIHBhcmFtVmFsdWVzLmZvckVhY2goZnVuY3Rpb24ocGFyYW1WYWwpe1xuICAgICAgICAgICAgICAgICAgdmFyIG5ld0FkdkZpZWxkID0gc3MuYnVpbGRBZHZhbmNlZEZpZWxkKHByb3BzLCBwYXJhbVZhbCk7XG4gICAgICAgICAgICAgICAgICBpZihuZXdBZHZGaWVsZCl7XG4gICAgICAgICAgICAgICAgICAgIG9wdHMuYWR2YW5jZWRGaWVsZHMucHVzaChuZXdBZHZGaWVsZCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUm91dGVyIC0gU2VhcmNoUmVzdWx0cyAtIGluIFJlc29sdmUgLSBvcHRzOiAnICsgSlNPTi5zdHJpbmdpZnkob3B0cykpO1xuICAgICAgICAgICAgc3Mub3B0cyA9IG9wdHM7XG4gICAgICAgICAgICByZXR1cm4gRGF0YVNlcnZpY2Uuc2VhcmNoKHNzLm9wdHMpO1xuICAgICAgICAgIH1dXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC5zdGF0ZSgnYm9va3MnLCB7XG4gICAgICAgIHVybDogJy9ib29rcy86Ym9va0lEJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6IGNvbmZpZy5hcHAucm9vdCArICcvYm9va19kZXRhaWwvYm9vay1kZXRhaWwuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdCb29rRGV0YWlsQ3RybCcsXG4gICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICBib29rOiBbJyRzdGF0ZVBhcmFtcycsIGZ1bmN0aW9uKCRzdGF0ZVBhcmFtcykge1xuICAgICAgICAgICAgcmV0dXJuIHtfaWQ6ICRzdGF0ZVBhcmFtcy5ib29rSUR9XG4gICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLnN0YXRlKCdhZHZhbmNlZCcsIHtcbiAgICAgICAgdXJsOiAnL2FkdmFuY2VkJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6IGNvbmZpZy5hcHAucm9vdCArICcvYWR2YW5jZWRfc2VhcmNoL2FkdmFuY2VkLXNlYXJjaC5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ0FkdmFuY2VkU2VhcmNoQ3RybCdcbiAgICAgIH0pXG5cbiAgICAgIC5zdGF0ZSgnY29udHJpYnV0b3JzJywge1xuICAgICAgICB1cmw6ICcvY29udHJpYnV0b3JzJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6IGNvbmZpZy5hcHAucm9vdCArICcvY29udHJpYnV0b3JzL2NvbnRyaWJ1dG9ycy5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ0NvbnRyaWJ1dG9yc0N0cmwnLFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgY29udHJpYnV0b3JzOiBbJyRyb290U2NvcGUnLCAnRGF0YVNlcnZpY2UnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCBEYXRhU2VydmljZSl7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLnNob3dTcGlubmVyID0gZmFsc2U7XG4gICAgICAgICAgICByZXR1cm4gRGF0YVNlcnZpY2UuZ2V0Q29udHJpYnV0b3JzKCk7XG4gICAgICAgICAgfV1cbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgLnN0YXRlKCdmZWVkYmFjaycsIHtcbiAgICAgICAgdXJsOiAnL2ZlZWRiYWNrJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6IGNvbmZpZy5hcHAucm9vdCArICcvcGFydGlhbHMvZmVlZGJhY2suaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdGZWVkYmFja0Zvcm1DdHJsJ1xuICAgICAgfSlcblxuICAgICAgLnN0YXRlKCd0aGFua3MnLCB7XG4gICAgICAgIHVybDogJy90aGFua3MnLFxuICAgICAgICB0ZW1wbGF0ZVVybDogY29uZmlnLmFwcC5yb290ICsgJy9wYXJ0aWFscy90aGFua3MuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdGZWVkYmFja0Zvcm1DdHJsJ1xuICAgICAgfSlcblxuICAgICAgLnN0YXRlKCdoZWxwJywge1xuICAgICAgICB1cmw6ICcvaGVscCcsXG4gICAgICAgIHRlbXBsYXRlVXJsOiBjb25maWcuYXBwLnJvb3QgKyAnL3BhcnRpYWxzL2hlbHAuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdTZWFyY2hIZWxwQ3RybCdcbiAgICAgIH0pXG5cbiAgICAgIC5zdGF0ZSgnZmFxJywge1xuICAgICAgICB1cmw6ICcvZmFxJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6IGNvbmZpZy5hcHAucm9vdCArICcvcGFydGlhbHMvZmFxcy5odG1sJyxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIHNwaW5uZXI6IFsnJHJvb3RTY29wZScsIGZ1bmN0aW9uKCRyb290U2NvcGUpIHtcbiAgICAgICAgICAgICRyb290U2NvcGUuc2hvd1NwaW5uZXIgPSBmYWxzZTtcbiAgICAgICAgICB9XVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLnN0YXRlKCdzYXZlZFJlY29yZHMnLCB7XG4gICAgICAgIHVybDogJy9zYXZlZCcsXG4gICAgICAgIHRlbXBsYXRlVXJsOiBjb25maWcuYXBwLnJvb3QgKyAnL3NhdmVkX3JlY29yZHMvc2F2ZWQtcmVjb3Jkcy5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ1NhdmVkUmVjb3Jkc0N0cmwnLFxuICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgcmVjb3JkczogWyckcScsICdTYXZlZFJlY29yZHNTZXJ2aWNlJywgZnVuY3Rpb24oJHEsIFNhdmVkUmVjb3Jkc1NlcnZpY2UpIHtcbiAgICAgICAgICAgIHJldHVybiAkcS53aGVuKFNhdmVkUmVjb3Jkc1NlcnZpY2UuZ2V0UmVjb3JkcygpKS50aGVuKGZ1bmN0aW9uKHJlY29yZHMpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHJlY29yZHM7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XSxcbiAgICAgICAgICBzZWFyY2hlczogWyckcScsICdTYXZlZFJlY29yZHNTZXJ2aWNlJywgZnVuY3Rpb24oJHEsIFNhdmVkUmVjb3Jkc1NlcnZpY2UpIHtcbiAgICAgICAgICAgIHJldHVybiAkcS53aGVuKFNhdmVkUmVjb3Jkc1NlcnZpY2UuZ2V0U2VhcmNoZXMoKSkudGhlbihmdW5jdGlvbihzZWFyY2hlcyl7XG4gICAgICAgICAgICAgIHJldHVybiBzZWFyY2hlcztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1dXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgLy8gZm9yIG5pY2VyIFVSTHMgdy9vdXQgJyMnLiBOb3RlOiA8YmFzZT4gdGFnIHJlcXVpcmVkIG9uIGluZGV4Lmh0bWwgd2l0aCBodG1sNU1vZGVcbiAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG4gIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmNvcmUnLCBbXSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5hZHZhbmNlZC1zZWFyY2gnKVxuICAgIC5jb25zdGFudCgnQURWQU5DRURfU0VBUkNIJywge1xuICAgICAgdGl0bGU6IHtcbiAgICAgICAgcGFyYW1OYW1lOiAnYWR2X3RpdGxlJyxcbiAgICAgICAgZGlzcGxheTogJ1RpdGxlJyxcbiAgICAgICAgc2VhcmNoS2V5OiAnZHVibGluX2NvcmUudGl0bGUnXG4gICAgICB9LFxuICAgICAgY3JlYXRvcjoge1xuICAgICAgICBwYXJhbU5hbWU6ICdhZHZfY3JlYXRvcicsXG4gICAgICAgIGRpc3BsYXk6ICdDcmVhdG9yJyxcbiAgICAgICAgc2VhcmNoS2V5OiAnZHVibGluX2NvcmUuY3JlYXRvcidcbiAgICAgIH0sXG4gICAgICBkYXRlOiB7XG4gICAgICAgIHBhcmFtTmFtZTogJ2Fkdl9kYXRlJyxcbiAgICAgICAgZGlzcGxheTogJ0RhdGUnLFxuICAgICAgICBzZWFyY2hLZXk6ICdkdWJsaW5fY29yZS5kYXRlJ1xuICAgICAgfSxcbiAgICAgIGxhbmd1YWdlOiB7XG4gICAgICAgIHBhcmFtTmFtZTogJ2Fkdl9sYW5ndWFnZScsXG4gICAgICAgIGRpc3BsYXk6ICdMYW5ndWFnZScsXG4gICAgICAgIHNlYXJjaEtleTogJ2R1Ymxpbl9jb3JlLmxhbmd1YWdlJ1xuICAgICAgfSxcbiAgICAgIHN1YmplY3Q6IHtcbiAgICAgICAgcGFyYW1OYW1lOiAnYWR2X3N1YmplY3QnLFxuICAgICAgICBkaXNwbGF5OiAnU3ViamVjdCcsXG4gICAgICAgIHNlYXJjaEtleTogJ2R1Ymxpbl9jb3JlLnN1YmplY3QnXG4gICAgICB9LFxuICAgICAgZ3JwX2NvbnRyaWJ1dG9yOiB7XG4gICAgICAgIHBhcmFtTmFtZTogJ2Fkdl9ncnBfY29udHJpYnV0b3InLFxuICAgICAgICBkaXNwbGF5OiAnRnJvbScsXG4gICAgICAgIHNlYXJjaEtleTogJ19ncnBfY29udHJpYnV0b3InXG4gICAgICB9LFxuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgLm1vZHVsZSgnYXBwLmNvcmUnKVxuICAuZmFjdG9yeSgnU2VhcmNoUmVzUGFyc2VyJywgWydfJywgJ0ZBQ0VUUycsIFNlYXJjaFJlc1BhcnNlcl0pO1xuXG4gIC8qIFNlYXJjaFJlc1BhcnNlclxuICAgKlxuICAgKiBQYXJzZSBzZWFyY2ggcmVzdWx0cyB0byBtYWtlIGVhc2llciBmb3IgY2xpZW50IGFwcCB0byB3b3JrIHdpdGhcbiAgICovXG4gIGZ1bmN0aW9uIFNlYXJjaFJlc1BhcnNlcihfLCBGQUNFVFMpe1xuXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLy8gRXhwb3NlIFNlcnZpY2VcbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIC8vIGZ1bmN0aW9ucyAvL1xuICAgICAgcGFyc2VSZXN1bHRzOiBwYXJzZVJlc3VsdHMsXG4gICAgICBwYXJzZUFnZ3JlZ2F0aW9uUmVzdWx0czogcGFyc2VBZ2dyZWdhdGlvblJlc3VsdHNcbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLy9QdWJsaWMgRnVuY3Rpb25zXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgLyoqXG4gICAgICogcGFyc2Ugc2VhcmNoIHJlc3VsdCBoaXRzIGRhdGEgdG8gc2ltcGxpZnkgb2JqZWN0IHN0cnVjdHVyZVxuICAgICAqIEBwYXJhbSB7YXJyYXl9IGhpdHMgZnJvbSBFUyByZXNwb25zZSBvYmouIGNvbnRhaW5zIHNlYXJjaCByZXN1bHRzIChoaXRzIHJldHVybmVkKVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHBhcnNlUmVzdWx0cyhoaXRzKXtcbiAgICAgIHJldHVybiBoaXRzLm1hcChmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgdmFyIGJvb2sgPSBkYXRhLl9zb3VyY2U7XG4gICAgICAgIC8vIF9pZCByZXByZXNlbnRzIEVTIGlkLiBUaHVzIGlmIGFuICdpZCcgZmllbGQgaXMgZXZlciBhZGRlZCBpdCB3b24ndCBnZXQgb3ZlcndyaXR0ZW5cbiAgICAgICAgYm9vay5faWQgPSBkYXRhLl9pZDtcbiAgICAgICAgcmV0dXJuIGJvb2s7XG4gICAgICB9KTtcblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhcnNlIHNlYXJjaCByZXN1bHQgYWdncmVnYXRpb24gZGF0YSBmb3IgYSBzaW5nbGUgYWdncmVnYXRpb25cbiAgICAgKiB0byBzaW1wbGlmeSBvYmplY3Qgc3RydWN0aW9uLlxuICAgICAqIEFsc28gYWRkIGEgYm9vbCBwcm9wZXJ0eSB0byBhbGxvdyBmYWNldCB0byBiZSBhY3RpdmF0ZWRcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gYWdnIEFnZ3JlZ2F0aW9uIG9iamVjdCBpbiBmaWVsZCBmcm9tIEVTIHJlc3BvbnNlIG9iai4gQ29udGFpbnMgYWdncmVnYXRpb24gZm9yIGEgZmFjZXQuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGZhY2V0TmFtZSBGYWNldCBvcHRpb24gbmFtZVxuICAgICAqIEBwYXJhbSB7YXJyYXl9IGFjdGl2ZUZhY2V0cyBBcnJheSBvZiBvYmplY3RzIG9mIGFsbCBhY3RpdmUgZmFjZXRzLlxuICAgICAqIEVhY2ggb2JqZWN0IG11c3QgaGF2ZSBhICdjYXRlZ29yeScgcHJvcCAoZmFjZXQgY2F0ZWdvcnkpIGFuZCBhbiAndmFsdWUnIHByb3AgKHZhbHVlKVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHBhcnNlQWdncmVnYXRpb25SZXN1bHRzKGFnZywgZmFjZXROYW1lLCBhY3RpdmVGYWNldHMpe1xuICAgICAgY29uc29sZS5sb2coJy4uLi5hY3RpdmVGYWNldHM6Ojo6ICcgKyBhY3RpdmVGYWNldHMpO1xuICAgICAgcmV0dXJuIGFnZy5idWNrZXRzLm1hcChmdW5jdGlvbihmYWNldE9wdGlvbil7XG5cbiAgICAgICAgdmFyIHBhcnNlZE9wdGlvbiA9IHtcbiAgICAgICAgICBjYXRlZ29yeTogZmFjZXROYW1lLFxuICAgICAgICAgIHZhbHVlOiBmYWNldE9wdGlvbi5rZXksXG4gICAgICAgICAgY291bnQ6IGZhY2V0T3B0aW9uLmRvY19jb3VudCxcbiAgICAgICAgICBhY3RpdmU6IGZhbHNlXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gc2V0IGFjdGl2ZSBmYWNldHMgc28gYXZhaWxhYmxlIGZhY2V0cyBzaWRlYmFyIGRvZXMgbm90IHNob3cgdGhlbVxuICAgICAgICAvLyB2YWxpZGF0ZSBpbnB1dHMgYmMgdy9iYWQgaW5wdXQgYXBwbGljYXRpb24gYnJlYWtzLCBhbmQgdGhlIGZhY2V0IG9ianMgYXJlIGJyaXR0bGUuXG4gICAgICAgIC8vIGVmZmVjdGl2ZWx5IHdlIGFyZSByZXF1aXJpbmcgYSBzcGVjaWZpYyBvYmplY3Qgc3RydWN0dXJlIGZvciBhY3RpdmVGYWNldHMgb2JqcyBmb3IgZmFjZXQgYWN0aXZhdGlvbi5cbiAgICAgICAgaWYoYWN0aXZlRmFjZXRzLmxlbmd0aCl7XG4gICAgICAgICAgYWN0aXZlRmFjZXRzLmZvckVhY2goZnVuY3Rpb24oZmFjZXQpe1xuICAgICAgICAgICAgaWYoZmFjZXQuY2F0ZWdvcnkgJiYgZmFjZXQudmFsdWUgJiYgcGFyc2VkT3B0aW9uLmNhdGVnb3J5ICYmIHBhcnNlZE9wdGlvbi52YWx1ZSl7XG4gICAgICAgICAgICAgIGlmKGZhY2V0LmNhdGVnb3J5ID09PSBwYXJzZWRPcHRpb24uY2F0ZWdvcnkgJiYgZmFjZXQudmFsdWUgPT09IHBhcnNlZE9wdGlvbi52YWx1ZSl7XG4gICAgICAgICAgICAgICAgcGFyc2VkT3B0aW9uLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgZmFjZXQuY291bnQgPSBwYXJzZWRPcHRpb24uY291bnQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFyc2VkT3B0aW9uO1xuICAgICAgfSk7XG4gICAgfVxuXG4gIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIC8qIGpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgLm1vZHVsZSgnYXBwLmNvcmUnKVxuICAuZmFjdG9yeSgnU2VhcmNoU2VydmljZScsIFsnJHN0YXRlJywgJ1NlYXJjaFJlc1BhcnNlcicsICdfJywgJ0ZBQ0VUUycsICdBRFZBTkNFRF9TRUFSQ0gnLCAnU09SVF9ERUZBVUxUJywgJ0ZST01fREVGQVVMVCcsICdTSVpFX0RFRkFVTFQnLCBTZWFyY2hTZXJ2aWNlXSk7XG5cbiAgLyogU2VhcmNoU2VydmljZVxuICAgKlxuICAgKiBSdW4gc2VhcmNoZXMsIGFjY2VzcyByZXN1bHRzIGFuZCBzZWFyY2ggcXVlcnkgb3B0cyB0aHJvdWdoIHRoaXMgc2VydmljZS5cbiAgICogVXNlIHRvIHByb3ZpZGUgY29uc2lzdGVudCBzZWFyY2ggc3RhdGUgdG8uLi5cbiAgICogLi52YXJpb3VzIGNvbnRyb2xsZXJzLCBldGMgYWNyb3NzIGFwcGxpY2F0aW9uLlxuICAgKiBIYW5kbGVzIHNlYXJjaCB2YXJpYWJsZXMsIG92ZXJhbGwgc2VhcmNoIHN0YXRlLCBldGMuXG4gICAqL1xuICBmdW5jdGlvbiBTZWFyY2hTZXJ2aWNlKCRzdGF0ZSwgU2VhcmNoUmVzUGFyc2VyLCBfLCBGQUNFVFMsIEFEVkFOQ0VEX1NFQVJDSCwgU09SVF9ERUZBVUxULCBGUk9NX0RFRkFVTFQsIFNJWkVfREVGQVVMVCl7XG4gICAgdmFyIGZhY2V0Q2F0ZWdvcmllc0xpc3QgPSBbJ2NyZWF0b3InLCAnZ3JwX2NvbnRyaWJ1dG9yJywgJ2xhbmd1YWdlJywgJ3N1YmplY3QnXTtcblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIC8vIEV4cG9zZSBTZXJ2aWNlXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIC8qIHZhcmlhYmxlcyAqL1xuICAgICAgcmVzdWx0czoge1xuICAgICAgICBoaXRzOiBudWxsLFxuICAgICAgICBudW1Ub3RhbEhpdHM6IG51bGwsXG4gICAgICAgIGZhY2V0T3B0aW9uczoge31cbiAgICAgIH0sXG4gICAgICBvcHRzOiBnZXREZWZhdWx0T3B0c09iaigpLFxuICAgICAgZmFjZXRDYXRlZ29yaWVzTGlzdDogWydjcmVhdG9yJywgJ2dycF9jb250cmlidXRvcicsICdsYW5ndWFnZScsICdzdWJqZWN0J10sXG4gICAgICBhZHZhbmNlZEZpZWxkc0xpc3Q6IE9iamVjdC5rZXlzKEFEVkFOQ0VEX1NFQVJDSCksXG5cbiAgICAgIC8qIGZ1bmN0aW9ucyAqL1xuICAgICAgLy8gZ2VuZXJhbCBvcHRzIHVwZGF0ZVxuICAgICAgdXBkYXRlT3B0czogdXBkYXRlT3B0cyxcbiAgICAgIHJlc2V0T3B0czogcmVzZXRPcHRzLFxuICAgICAgLy8gc3BlY2lmaWMgb3B0cyB1cGRhdGVcbiAgICAgIHVwZGF0ZURhdGU6IHVwZGF0ZURhdGUsXG4gICAgICAvLyBmYWNldHMgYW5kIGFkdmFuY2VkIGZpZWxkc1xuICAgICAgaXNWYWxpZENhdGVnb3J5OiBpc1ZhbGlkQ2F0ZWdvcnksXG4gICAgICBpc1ZhbGlkRmFjZXQ6IGlzVmFsaWRGYWNldCxcbiAgICAgIGlzU2FtZUZhY2V0OiBpc1NhbWVGYWNldCxcbiAgICAgIGJ1aWxkRmFjZXQ6IGJ1aWxkRmFjZXQsXG4gICAgICBhY3RpdmF0ZUZhY2V0OiBhY3RpdmF0ZUZhY2V0LFxuICAgICAgZGVBY3RpdmF0ZUZhY2V0OiBkZUFjdGl2YXRlRmFjZXQsXG4gICAgICBjbGVhckZhY2V0c0luOiBjbGVhckZhY2V0c0luLFxuICAgICAgYnVpbGRBZHZhbmNlZEZpZWxkOiBidWlsZEFkdmFuY2VkRmllbGQsXG4gICAgICAvLyB1dGlsaXR5XG4gICAgICBjYWxjdWxhdGVQYWdlOiBjYWxjdWxhdGVQYWdlLFxuICAgICAgcGFyc2VGYWNldHNUb09iajogcGFyc2VGYWNldHNUb09iaixcbiAgICAgIGdldERlZmF1bHRPcHRzT2JqOiBnZXREZWZhdWx0T3B0c09iaixcbiAgICAgIC8vIHNlYXJjaCBleGVjdXRpb25cbiAgICAgIGJ1aWxkUXVlcnlQYXJhbXM6IGJ1aWxkUXVlcnlQYXJhbXMsXG4gICAgICB0cmFuc2l0aW9uU3RhdGVBbmRTZWFyY2g6IHRyYW5zaXRpb25TdGF0ZUFuZFNlYXJjaCxcbiAgICAgIHNldFJlc3VsdHNEYXRhOiBzZXRSZXN1bHRzRGF0YSxcbiAgICB9O1xuXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLy9QdWJsaWMgRnVuY3Rpb25zXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIG9iamVjdCB3aXRoIGNvcnJlY3QgZGF0YSBzdHJ1Y3R1cmUgZm9yIHNlYXJjaCBvcHRzXG4gICAgICogYW5kIGRlZmF1bHQgc2VhcmNoIG9wdHMgc2V0dGluZ3NcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXREZWZhdWx0T3B0c09iaigpe1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZnJvbTogRlJPTV9ERUZBVUxULFxuICAgICAgICBzaXplOiBTSVpFX0RFRkFVTFQsXG4gICAgICAgIHE6IFtdLFxuICAgICAgICBzb3J0OiBTT1JUX0RFRkFVTFQsXG4gICAgICAgIGZhY2V0czogW10sXG4gICAgICAgIGFkdmFuY2VkRmllbGRzOiBbXSxcbiAgICAgICAgZGF0ZToge1xuICAgICAgICAgIGd0ZTogbnVsbCxcbiAgICAgICAgICBsdGU6IG51bGxcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBzZWFyY2ggb3B0cyBvYmogaW50byBVUkwgcXVlcnkgcGFyYW1zIHdoaWNoIGNhbiBiZSBwYXNzZWRcbiAgICAgKiBpbnRvIHRoZSBzZWFyY2ggcmVzdWx0cyBzdGF0ZS5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBTZWFyY2ggb3B0cyBpbiBxdWVyeSBwYXJhbXMgZm9ybVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJ1aWxkUXVlcnlQYXJhbXMoKXtcbiAgICAgIC8vIGRlZmF1bHQgc2V0dGluZ3NcbiAgICAgIHZhciBxdWVyeVBhcmFtcyA9IHt9O1xuICAgICAgcXVlcnlQYXJhbXMucSA9IHRoaXMub3B0cy5xO1xuICAgICAgcXVlcnlQYXJhbXMuZnJvbSA9IHRoaXMub3B0cy5mcm9tO1xuICAgICAgcXVlcnlQYXJhbXMuc2l6ZSA9IHRoaXMub3B0cy5zaXplO1xuICAgICAgcXVlcnlQYXJhbXMuc29ydCA9IHRoaXMub3B0cy5zb3J0O1xuXG4gICAgICAvLyBkYXRlIHJhbmdlXG4gICAgICBxdWVyeVBhcmFtcy5kYXRlX2d0ZSA9IHRoaXMub3B0cy5kYXRlLmd0ZTtcbiAgICAgIHF1ZXJ5UGFyYW1zLmRhdGVfbHRlID0gdGhpcy5vcHRzLmRhdGUubHRlO1xuXG4gICAgICAvLyBmYWNldCBvcHRpb25zIGFuZCBhZHZhbmNlZCBmaWVsZHNcbiAgICAgIC8vIGZvciBzdGF0ZSB0cmFuc2l0aW9ucyB0aGlzIG5lZWRlZCBpZiBpbmhlcml0ID0gdHJ1ZSB0byBwcmV2ZW50IHpvbWJpZSBxdWVyeSBwYXJhbXMuXG4gICAgICAvLyBrZWVwIGFzIGNoZWNrIGFnYWluc3QgcmVncmVzc2lvbiBvciBjaGFuZ2UuXG4gICAgICB0aGlzLmZhY2V0Q2F0ZWdvcmllc0xpc3QuZm9yRWFjaChmdW5jdGlvbihjYXRlZ29yeSl7XG4gICAgICAgIHF1ZXJ5UGFyYW1zW2NhdGVnb3J5XSA9IFtdO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMub3B0cy5mYWNldHMuZm9yRWFjaChmdW5jdGlvbihmYWNldCl7XG4gICAgICAgIHF1ZXJ5UGFyYW1zW2ZhY2V0LmNhdGVnb3J5XS5wdXNoKGZhY2V0LnZhbHVlKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBmb3Igc3RhdGUgdHJhbnNpdGlvbnMgdGhpcyBuZWVkZWQgaWYgaW5oZXJpdCA9IHRydWUgdG8gcHJldmVudCB6b21iaWUgcXVlcnkgcGFyYW1zLlxuICAgICAgLy8ga2VlcCBhcyBjaGVjayBhZ2FpbnN0IHJlZ3Jlc3Npb24gb3IgY2hhbmdlLlxuICAgICAgdGhpcy5hZHZhbmNlZEZpZWxkc0xpc3QuZm9yRWFjaChmdW5jdGlvbihuYW1lKXtcbiAgICAgICAgcXVlcnlQYXJhbXNbIEFEVkFOQ0VEX1NFQVJDSFtuYW1lXS5wYXJhbU5hbWUgXSAgPSBbXTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLm9wdHMuYWR2YW5jZWRGaWVsZHMuZm9yRWFjaChmdW5jdGlvbihhZHZGaWVsZCl7XG4gICAgICAgIHF1ZXJ5UGFyYW1zW2FkdkZpZWxkLmZpZWxkLnBhcmFtTmFtZV0ucHVzaChhZHZGaWVsZC50ZXJtKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zb2xlLmxvZygnU2VhcmNoU2VydmljZTo6YnVpbGRRdWVyeVBhcmFtcyAtIHF1ZXJ5UGFyYW1zOiAnICsgSlNPTi5zdHJpbmdpZnkocXVlcnlQYXJhbXMpKTtcbiAgICAgIHJldHVybiBxdWVyeVBhcmFtcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcmV0dXJucyB7b2JqZWN0fSBEYXRhIHN0cnVjdCBvZiBhY3RpdmUgZmFjZXRzLCBlYWNoIG9iamVjdCBwcm9wZXJ0eVxuICAgICAqIGlzIGEgZmFjZXQgY2F0ZWdvcnkgd2l0aCBhbiBhcnJheSBvZiB0aGUgYWN0aXZlIGZhY2V0cyBpbiB0aGF0IGNhdGVnb3J5LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHBhcnNlRmFjZXRzVG9PYmooKXtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICB2YXIgb2JqID0ge307XG5cbiAgICAgIHRoaXMuZmFjZXRDYXRlZ29yaWVzTGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGNhdGVnb3J5KXtcbiAgICAgICAgb2JqW2NhdGVnb3J5XSA9IFtdO1xuICAgICAgICBvYmpbY2F0ZWdvcnldID0gX3RoaXMub3B0cy5mYWNldHMuZmlsdGVyKGZ1bmN0aW9uKGZhY2V0KXtcbiAgICAgICAgICByZXR1cm4gZmFjZXQuY2F0ZWdvcnkgPT09IGNhdGVnb3J5O1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zb2xlLmxvZygnU2VhcmNoU2VydmljZTo6cGFyc2VGYWNldHNUb09iaiAtIGZhY2V0cyBvYmo6ICcgKyBKU09OLnN0cmluZ2lmeShvYmopKTtcbiAgICAgIHJldHVybiBvYmo7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlcyBvcHRzLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRzIC0gc2VhcmNoIG9wdGlvbnNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1cGRhdGVPcHRzKG5ld09wdHMpe1xuICAgICAgbmV3T3B0cyA9IG5ld09wdHMgfHwge307XG4gICAgICBjb25zb2xlLmxvZygnU2VhcmNoU2VydmljZTo6dXBkYXRlT3B0cyAtLSBuZXdPcHRzOiAnICsgSlNPTi5zdHJpbmdpZnkobmV3T3B0cykpO1xuICAgICAgaWYgKG5ld09wdHMucSkge1xuICAgICAgICB0aGlzLm9wdHMucSA9IG5ld09wdHMucTtcbiAgICAgIH1cbiAgICAgIGlmKG5ld09wdHMuc29ydCAmJiAodHlwZW9mIG5ld09wdHMuc29ydCA9PT0gJ29iamVjdCcpICYmIG5ld09wdHMuc29ydC5tb2RlKXtcbiAgICAgICAgbmV3T3B0cy5zb3J0ID0gbmV3T3B0cy5zb3J0Lm1vZGU7XG4gICAgICB9XG5cbiAgICAgIF8ubWVyZ2UodGhpcy5vcHRzLCBuZXdPcHRzKTtcblxuICAgICAgY29uc29sZS5sb2coJ1NlYXJjaFNlcnZpY2U6OnVwZGF0ZU9wdHMgLS0gb3B0cyBub3c6ICcgKyBKU09OLnN0cmluZ2lmeSh0aGlzLm9wdHMpKTtcbiAgICAgIHJldHVybiB0aGlzLm9wdHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIGRhdGUgZmlsdGVyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGd0ZSAtIGRhdGUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGx0ZSAtIGRhdGUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvXG4gICAgICogQHJldHVybiB7Ym9vbH0gcmV0dXJucyB0cnVlIG9uIHN1Y2Nlc3NmdWwgdXBkYXRlXG4gICAgICovXG4gICAgZnVuY3Rpb24gdXBkYXRlRGF0ZShndGUsIGx0ZSl7XG4gICAgICBpZihndGUpeyB0aGlzLm9wdHMuZGF0ZS5ndGUgPSBndGU7IH1cbiAgICAgIGlmKGx0ZSl7IHRoaXMub3B0cy5kYXRlLmd0ZSA9IGx0ZTsgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IFNlYXJjaFNlcnZpY2UgcmVzdWx0cyB2YWx1ZXMgb25jZSByZXNwb25zZSBwcm9taXNlIGlzIHJlc29sdmVkXG4gICAgICogUGFyc2UgZGF0YSBmcm9tIEVTIGludG8gZGVzaXJlZCBmb3JtYXQuIEFzc2lnbiB0byBTZWFyY2hTZXJ2aWNlIGFuZCByZXR1cm5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSByZXN1bHRzIC0gUmVzdWx0cyBvYmplY3QgZnJvbSBFbGFzdGljc2VhcmNoXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBvYmplY3Qgd2l0aCBhIHByb3BlcnR5IGZvciBlYWNoIHNlYXJjaCByZXN1bHQgdHlwZSB3ZSdyZSBpbnRlcmVzdGVkIGluLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNldFJlc3VsdHNEYXRhKHJlc3VsdHMpe1xuXG4gICAgICB0aGlzLnJlc3VsdHMuaGl0cyA9IFNlYXJjaFJlc1BhcnNlci5wYXJzZVJlc3VsdHMocmVzdWx0cy5oaXRzLmhpdHMpO1xuICAgICAgdGhpcy5yZXN1bHRzLm51bVRvdGFsSGl0cyA9IHJlc3VsdHMuaGl0cy50b3RhbDtcblxuICAgICAgLy8gc2V0IGZhY2V0IG9wdGlvbnNcbiAgICAgIHZhciBhbGxBZ2dyZWdhdGlvbnMgPSByZXN1bHRzLmFnZ3JlZ2F0aW9ucztcblxuICAgICAgLy8gbXVzdCBkbyBgdmFyX3RoaXMgPSB0aGlzYCBzbyAndGhpcycgaXMgY29ycmVjdCBpbnNpZGUgdGhlIGZvckVhY2goKSwgb3RoZXJ3aXNlIGZhaWx1cmUuXG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgdGhpcy5mYWNldENhdGVnb3JpZXNMaXN0LmZvckVhY2goZnVuY3Rpb24oY2F0ZWdvcnkpe1xuICAgICAgICBfdGhpcy5yZXN1bHRzLmZhY2V0T3B0aW9uc1tjYXRlZ29yeV0gPSBTZWFyY2hSZXNQYXJzZXIucGFyc2VBZ2dyZWdhdGlvblJlc3VsdHMocmVzdWx0cy5hZ2dyZWdhdGlvbnNbY2F0ZWdvcnldW2NhdGVnb3J5XSwgY2F0ZWdvcnksIF90aGlzLm9wdHMuZmFjZXRzKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyByZXR1cm4gcGFyc2VkIGRhdGEgc28gaXQgY2FuIGJlIGFzc2lnbmVkIG9uIHNjb3BlIG9yIGVsc2V3aGVyZVxuICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAgaGl0czogdGhpcy5yZXN1bHRzLmhpdHMsXG4gICAgICAgIG51bVRvdGFsSGl0czogdGhpcy5yZXN1bHRzLm51bVRvdGFsSGl0cyxcbiAgICAgICAgZmFjZXRzOiB0aGlzLnJlc3VsdHMuZmFjZXRPcHRpb25zXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gb2JqO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGRlZmF1bHQgU2VhcmNoIE9wdHMgb2JqZWN0LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlc2V0T3B0cygpe1xuICAgICAgdGhpcy5vcHRzID0gdGhpcy5nZXREZWZhdWx0T3B0c09iaigpO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogQ2FsY3VsYXRlIGN1cnJlbnQgcGFnZSBiYXNlZCBvbiAnZnJvbScgYW5kICdzaXplJyBwYXJhbXNcbiAgICAgKiBAcmV0dXJuIHtpbnR9IHRoZSBjdXJyZW50IHBhZ2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjYWxjdWxhdGVQYWdlKCkge1xuICAgICAgLy8gTWF0aC5jZWlsIHNvIHRoZSBwYWdlIGNvbWVzIG91dCByaWdodCBmb3IgdGltZXMgbGlrZSBmcm9tPTMwLCBzaXplPTI1XG4gICAgICB2YXIgcGFnZSA9IDEgKyBNYXRoLmNlaWwodGhpcy5vcHRzLmZyb20gLyB0aGlzLm9wdHMuc2l6ZSk7XG4gICAgICByZXR1cm4gcGFnZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3QgYSBmYWNldCBvYmplY3RcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2F0ZWdvcnkgdmFsaWQgZmFjZXQgY2F0ZW9ncnkgLSByZXF1aXJlZFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSBzdWNoIGFzICdhcnQnIG9yICdwaWNhc3NvJyAtIHJlcXVpcmVkXG4gICAgICogQHBhcmFtIHtpbnR9IGNvdW50IGNhbiBiZSBudWxsIC0gbnVtYmVyIG9mIGhpdHMgYXNzb2NpYXRlZCB3L3RoaXMgZmFjZXQgLSBvcHRpb25hbFxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gYWN0aXZlIGlmIGZhY2V0IGlzIGFjdGl2ZSBvciBub3QtIG9wdGlvbmFsXG4gICAgICovXG4gICAgZnVuY3Rpb24gYnVpbGRGYWNldChjYXRlZ29yeSwgdmFsdWUsIGNvdW50LCBhY3RpdmUpe1xuICAgICAgaWYoIWlzVmFsaWRDYXRlZ29yeShjYXRlZ29yeSkgfHwgIXZhbHVlKXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdmFyIGZhY2V0PSB7XG4gICAgICAgIGNhdGVnb3J5OiBjYXRlZ29yeSxcbiAgICAgICAgdmFsdWU6IHZhbHVlXG4gICAgICB9O1xuXG4gICAgICBpZihjb3VudCl7IGZhY2V0LmNvdW50ID0gY291bnQ7IH1cbiAgICAgIGlmKGFjdGl2ZSAhPT0gdW5kZWZpbmVkKXsgZmFjZXQuYWN0aXZlID0gYWN0aXZlOyB9XG4gICAgICByZXR1cm4gZmFjZXQ7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBDb25zdHJ1Y3QgYW4gYWR2YW5jZWQgZmllbGQgb2JqZWN0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdFtdfHN0cmluZ30gZmllbGQgLSBvYmplY3QgZnJvbSBBRFZBTkNFRF9TRUFSQ0ggY29uc3RhbnQgcHJvcFxuICAgICAqIHdpdGggaW5mbyBvbiBhZHZhbmNlZCBmaWVsZCB0byBmaWx0ZXIgd2l0aGluLlxuICAgICAqIE9yLCBzdHJpbmcgd2l0aCBuYW1lIG9mIHRoZSBhZHZhbmNlZCBmaWVsZC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGVybSAtIHZhbHVlIHRvIGZpbHRlciBmb3Igd2l0aGluIHRoZSBhZHZhbmNlZCBmaWVsZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJ1aWxkQWR2YW5jZWRGaWVsZChmaWVsZCwgdGVybSl7XG4gICAgICBpZighZmllbGQuc2VhcmNoS2V5KXtcbiAgICAgICAgZmllbGQgPSBBRFZBTkNFRF9TRUFSQ0hbZmllbGRdO1xuICAgICAgICBpZighZmllbGQuc2VhcmNoS2V5KXtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnNvbGUubG9nKCdTZWFyY2hTZXJ2aWNlOjpidWlsZEFkdmFuY2VkRmllbGQgLSBmaWVsZCwgdGVybTogJyArIEpTT04uc3RyaW5naWZ5KGZpZWxkKSArICcgJyArIHRlcm0pO1xuICAgICAgcmV0dXJuIHtmaWVsZDogZmllbGQsIHRlcm06IHRlcm19O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIHN0cmluZyBpcyB2YWxpZCBmYWNldCBjYXRlZ29yeVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjYXRlZ29yeSBjYXRlZ29yeSB0byBjaGVja1xuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IHRydWUgaWYgdmFsaWRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc1ZhbGlkQ2F0ZWdvcnkoY2F0ZWdvcnkpe1xuICAgICAgcmV0dXJuIChmYWNldENhdGVnb3JpZXNMaXN0LmluZGV4T2YoY2F0ZWdvcnkpID4gLTEpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGZhY2V0IGlzIHZhbGlkXG4gICAgICogRmFjZXQgY29uc2lkZXJlZCB2YWxpZCBpZiAnY2F0ZWdvcnknIHBhcmFtIGlzIHZhbGlkIGFuZCAndmFsdWUnIHBhcmFtIGV4aXN0cy5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gZmFjZXQgYSBmYWNldCBvYmplY3RcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSB0cnVlIGlmIHZhbGlkXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNWYWxpZEZhY2V0KGZhY2V0KXtcbiAgICAgIHJldHVybiBCb29sZWFuKGZhY2V0LmNhdGVnb3J5ICYmIGlzVmFsaWRDYXRlZ29yeShmYWNldC5jYXRlZ29yeSkgJiYgZmFjZXQudmFsdWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIHR3byBmYWNldHMgYXJlIHRoZSBzYW1lXG4gICAgICogQ29tcGFyZXMgJ2NhdGVnb3J5JyBhbmQgJ3ZhbHVlJyBwYXJhbXMgb25seS5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gZmFjZXRBIGZhY2V0IG9iamVjdFxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBmYWNldEIgZmFjZXQgb2JqZWN0XG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gdHJ1ZSBpZiBzYW1lXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNTYW1lRmFjZXQoZmFjZXRBLCBmYWNldEIpe1xuICAgICAgaWYoZmFjZXRBLmNhdGVnb3J5LnRvTG93ZXJDYXNlKCkgIT09IGZhY2V0Qi5jYXRlZ29yeS50b0xvd2VyQ2FzZSgpKXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYoZmFjZXRBLnZhbHVlLnRvTG93ZXJDYXNlKCkgIT09IGZhY2V0Qi52YWx1ZS50b0xvd2VyQ2FzZSgpKXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IGEgZmFjZXQncyAnYWN0aXZlJyBwcm9wIHRvIHRydWUsIGFuZCBhZGRzIHRvIG9wdHMuZmFjZXRzW11cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gVmFsaWQgZmFjZXQgb2JqZWN0XG4gICAgICogQHJldHVybnMge0Jvb2x9IFRydWUgaWYgZmFjZXQgc3VjY2Vzc2Z1bGx5IGFkZGVkLFxuICAgICAqIGZhbHNlIGlmIGZhY2V0IG9iaiB3YXMgaW52YWxpZCBvciBmYWlsdXJlLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFjdGl2YXRlRmFjZXQoZmFjZXQpe1xuICAgICAgdmFyIGR1cGVGYWNldCA9IGZhbHNlO1xuXG4gICAgICBpZighaXNWYWxpZEZhY2V0KGZhY2V0KSl7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGZhY2V0LmFjdGl2ZSA9IHRydWU7XG5cbiAgICAgIHRoaXMub3B0cy5mYWNldHMuZm9yRWFjaChmdW5jdGlvbihvdGhlckZhY2V0KXtcbiAgICAgICAgaWYoaXNTYW1lRmFjZXQoZmFjZXQsIG90aGVyRmFjZXQpKXtcbiAgICAgICAgICBvdGhlckZhY2V0LmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgZHVwZUZhY2V0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZighZHVwZUZhY2V0KXtcbiAgICAgICAgdGhpcy5vcHRzLmZhY2V0cy5wdXNoKGZhY2V0KTtcbiAgICAgIH1cbiAgICAgIGNvbnNvbGUubG9nKCdTZWFyY2hTZXJ2aWNlOjphY3RpdmF0ZUZhY2V0IC0tIHRoaXMub3B0cy5mYWNldHNbXSBhZnRlciBuZXcgZmFjZXQ6ICcgKyBKU09OLnN0cmluZ2lmeSh0aGlzLm9wdHMuZmFjZXRzKSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgYSBmYWNldCdzICdhY3RpdmUnIHByb3AgdG8gZmFsc2UsIHJlbW92ZSBmcm9tIG9wdHMuZmFjZXRzW11cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gVmFsaWQgZmFjZXQgb2JqXG4gICAgICogQHJldHVybnMge0Jvb2x9IFRydWUgaWYgZmFjZXQgc3VjY2Vzc2Z1bGx5IHJlbW92ZWQsXG4gICAgICogZmFsc2UgaWYgZmFjZXQgb2JqIHdhcyBpbnZhbGlkIG9yIGZhaWx1cmUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gZGVBY3RpdmF0ZUZhY2V0KGZhY2V0KXtcbiAgICAgIGlmKCFpc1ZhbGlkRmFjZXQoZmFjZXQpKXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgZmFjZXQuYWN0aXZlID0gZmFsc2U7XG4gICAgICBfLnJlbW92ZSh0aGlzLm9wdHMuZmFjZXRzLCBmdW5jdGlvbihmKXtcbiAgICAgICAgcmV0dXJuIGlzU2FtZUZhY2V0KGZhY2V0LCBmKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFyIGZhY2V0cyBpbiBhIHBhcnRpY3VsYXIgY2F0ZWdvcnkgb3IgY2xlYXIgYWxsIGZhY2V0cy5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2F0ZWdvcnkgZmFjZXQgY2F0ZWdvcnkgdG8gY2xlYXIuIG9yLCAnYWxsJyB0byBjbGVhciBhbGwgZmFjZXRzXG4gICAgICogQHJldHVybiB7Ym9vbGFufSB0cnVlIG9uIHN1Y2Nlc3MsIGZhbHNlIGlmICdjYXRlZ29yeScgYXJnIGlzIGludmFsaWRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbGVhckZhY2V0c0luKGNhdGVnb3J5KXtcbiAgICAgIGlmKGNhdGVnb3J5ID09PSAnYWxsJyl7XG4gICAgICAgIHRoaXMub3B0cy5mYWNldHMgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICBlbHNlIGlmKCFpc1ZhbGlkQ2F0ZWdvcnkoY2F0ZWdvcnkpKXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5vcHRzLmZhY2V0cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgIGlmKHRoaXMub3B0cy5mYWNldHNbaV0uY2F0ZWdvcnkgPT09IGNhdGVnb3J5KXtcbiAgICAgICAgICB0aGlzLm9wdHMuZmFjZXRzLnNwbGljZShpLCAxKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJhbnNpdGlvbiB0byBTZWFyY2hSZXN1bHRzIHN0YXRlXG4gICAgICogYW5kIHBhc3MgcXVlcnkgcGFyYW1ldGVycyBmb3Igc2VhcmNoIG9wdGlvbnMuXG4gICAgICogSW4gU2VhcmNoUmVzdWx0cyBzdGF0ZSBzZWFyY2ggb3B0aW9ucyB3aWxsIGJlIHNldFxuICAgICAqIGJhc2VkIG9uIHF1ZXJ5IHBhcmFtcyBhbmQgYW4gRWxhc3RpY3NlYXJjaCBxdWVyeSBleGVjdXRlZC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0cmFuc2l0aW9uU3RhdGVBbmRTZWFyY2goKXtcbiAgICAgICRzdGF0ZS5nbygnc2VhcmNoUmVzdWx0cycsIHRoaXMuYnVpbGRRdWVyeVBhcmFtcygpLCB7cmVsb2FkOiB0cnVlLCBpbmhlcml0OiBmYWxzZX0pO1xuICAgIH1cblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLy9Qcml2YXRlIEZ1bmN0aW9uc1xuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblxuICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAubW9kdWxlKCdhcHAuY29yZScpXG4gIC5mYWN0b3J5KCdEYXRhU2VydmljZScsIFsnJHEnLCAnJGh0dHAnLCAnY29uZmlnJywgJ1NlYXJjaFNlcnZpY2UnLCBEYXRhU2VydmljZV0pO1xuXG4gIC8qIERhdGFTZXJ2aWNlIC0gZ2V0IGFsbCBkYXRhIHRocm91Z2ggdGhpcyBzZXJ2aWNlICovXG4gIGZ1bmN0aW9uIERhdGFTZXJ2aWNlKCRxLCAkaHR0cCwgY29uZmlnLCBTZWFyY2hTZXJ2aWNlKSB7XG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLy8gRXhwb3NlIFNlcnZpY2VcbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgZ2V0Q29udHJpYnV0b3JzOiBnZXRDb250cmlidXRvcnMsXG4gICAgICBnZXRCb29rRGF0YTogZ2V0Qm9va0RhdGEsXG4gICAgICBnZXREY1JlYzogZ2V0RGNSZWMsXG4gICAgICBnZXRSaXNSZWM6IGdldFJpc1JlYyxcbiAgICAgIHNlYXJjaDogc2VhcmNoXG4gICAgfTtcblxuICAgIC8vY29uc29sZS5sb2coJ2FwcC5jb3JlLi4uLi4uLi5SZXR1cm5pbmcgRGF0YVNlcnZpY2UgZmFjdG9yeScpO1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIC8vUHVibGljIEZ1bmN0aW9uc1xuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIC8qKlxuICAgICAqIENhbGwgZGphbmdvIGFwaSBmb3IgZ2VuZXJhbCBzZWFyY2ggcXVlcnkuIFVzZSBtdWx0aSBzZWFyY2ggY2FsbFxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBvcHRzIHNlYXJjaCBvcHRzIC0gc2VlIFNlYXJjaFNlcnZpY2UgZm9yIG1vcmUgZGV0YWlscy5cbiAgICAgKiBAcmV0dXJucyB7cHJvbWlzZX0gcmVzdWx0cyBkYXRhIHdyYXBwZWQgaW4gYSBwcm9taXNlLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNlYXJjaChvcHRzKXtcbiAgICAgIHZhciBxdWVyeSA9IFtcImZyb209XCIgKyBvcHRzLmZyb20sIFwic2l6ZT1cIiArIG9wdHMuc2l6ZSwgXCJzb3J0PVwiICsgb3B0cy5zb3J0XTtcbiAgICAgIGlmIChvcHRzLnEubGVuZ3RoKSB7XG4gICAgICAgIG9wdHMucS5mb3JFYWNoKGZ1bmN0aW9uKHF1ZXJ5VGVybSl7XG4gICAgICAgICAgcXVlcnkucHVzaChcInE9XCIgKyBxdWVyeVRlcm0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRzLmRhdGUuZ3RlKSB7XG4gICAgICAgIHF1ZXJ5LnB1c2goXCJkYXRlX2d0ZT1cIiArIG9wdHMuZGF0ZS5ndGUpO1xuICAgICAgfVxuXG4gICAgICBpZiAob3B0cy5kYXRlLmx0ZSkge1xuICAgICAgICBxdWVyeS5wdXNoKFwiZGF0ZV9sdGU9XCIgKyBvcHRzLmRhdGUubHRlKTtcbiAgICAgIH1cbiAgICAgIG9wdHMuZmFjZXRzLmZvckVhY2goZnVuY3Rpb24oZmFjZXQpe1xuICAgICAgICBxdWVyeS5wdXNoKGZhY2V0LmNhdGVnb3J5ICsgXCI9XCIgKyBmYWNldC52YWx1ZSk7XG4gICAgICB9KTtcbiAgICAgIG9wdHMuYWR2YW5jZWRGaWVsZHMuZm9yRWFjaChmdW5jdGlvbihhZHZhbmNlZCkge1xuICAgICAgICBxdWVyeS5wdXNoKGFkdmFuY2VkLmZpZWxkLnBhcmFtTmFtZSArIFwiPVwiICsgYWR2YW5jZWQudGVybSk7XG4gICAgICB9KTtcblxuICAgICAgdmFyIHF1ZXJ5UGF0aCA9IHF1ZXJ5LmpvaW4oXCImXCIpO1xuICAgICAgdmFyIHNlYXJjaFByb21pc2UgPSAkaHR0cC5nZXQoY29uZmlnLmRqYW5nby5ob3N0ICsgJzonICsgY29uZmlnLmRqYW5nby5wb3J0ICsgJy9hcGkvYm9va3MvJyArIHF1ZXJ5UGF0aCk7XG4gICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgc2VhcmNoUHJvbWlzZS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgdmFyIHBhcnNlZERhdGEgPSBkYXRhWzBdO1xuICAgICAgICBwYXJzZWREYXRhLmFnZ3JlZ2F0aW9ucyA9IGRhdGFbMV0uYWdncmVnYXRpb25zO1xuICAgICAgICB2YXIgcmVzdWx0cyA9IFNlYXJjaFNlcnZpY2Uuc2V0UmVzdWx0c0RhdGEocGFyc2VkRGF0YSk7XG4gICAgICAgIGRlZmVycmVkLnJlc29sdmUocmVzdWx0cyk7XG4gICAgICB9KS5lcnJvcihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICBkZWZlcnJlZC5yZWplY3QoYXJndW1lbnRzKTtcbiAgICAgICAgY29uc29sZS5sb2coJ0RhdGFTZXJ2aWNlOjpzZWFyY2ggLS0gZXJyb3I6ICcgKyBKU09OLnN0cmluZ2lmeShyZXNwb25zZSkpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGRhdGEgZnJvbSBkamFuZ28gYXBpIGZvciBjb250cmlidXRvcnNcbiAgICAgKiBAcmV0dXJucyBwcm9taXNlIHdpdGggZGF0YSBmcm9tIGRqYW5nbyBhcGlcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRDb250cmlidXRvcnMoKXtcbiAgICAgIHZhciBjb250cmlidXRvcnNQcm9taXNlID0gJGh0dHAuZ2V0KGNvbmZpZy5kamFuZ28uaG9zdCArICc6JyArIGNvbmZpZy5kamFuZ28ucG9ydCArICcvYXBpL2NvbnRyaWJ1dG9ycycpO1xuICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgIGNvbnRyaWJ1dG9yc1Byb21pc2Uuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIGRlZmVycmVkLnJlc29sdmUoZGF0YSk7XG4gICAgICB9KS5lcnJvcihmdW5jdGlvbigpIHtcbiAgICAgICAgZGVmZXJyZWQucmVqZWN0KGFyZ3VtZW50cyk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgZGF0YSBmcm9tIGRqYW5nbyBhcGkgZm9yIHBhcnRpY3VsYXIgYm9vayByZWNvcmRcbiAgICAgKiBAcGFyYW0gYm9va0lEIHtzdHJpbmd9IGlkIG9mIHJlY29yZCB0byBnZXRcbiAgICAgKiBAcmV0dXJucyBwcm9taXNlIHdpdGggZGF0YSBmcm9tIGRqYW5nbyBhcGlcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRCb29rRGF0YShib29rSUQpe1xuICAgICAgcmV0dXJuICRodHRwLmdldChjb25maWcuZGphbmdvLmhvc3QgKyAnOicgKyBjb25maWcuZGphbmdvLnBvcnQgKyAnL2FwaS9ib29rL3Jhdy8nICsgYm9va0lEKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGRhdGEgZnJvbSBkamFuZ28gYXBpIGZvciBwYXJ0aWN1bGFyIGJvb2sgcmVjb3JkXG4gICAgICogQHBhcmFtIGJvb2tJRCB7c3RyaW5nfSBpZCBvZiByZWNvcmQgdG8gZ2V0XG4gICAgICogQHBhcmFtIGZvcm1hdCB7eycnIHwgJ2pzb24nIHwgJ3Jpcyd9IGZvcm1hdCB0byByZXR1cm4gcmVjb3JkIGRhdGEgaW4uIG51bGwgb3IgZW1wdHkgc3RyaW5nIGlzIGRlZmF1bHQgYW5kIHNob3VsZCBiZSB1c2VkIGZvciBib29rIGRldGFpbCBwYWdlIGluZm8uXG4gICAgICogQHJldHVybnMgcHJvbWlzZSB3aXRoIGRhdGEgZnJvbSBkamFuZ28gYXBpXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UmlzUmVjKGJvb2tJRCl7XG4gICAgICBjb25zb2xlLmxvZygnZ2V0dGluZyByaXMgcmVjb3JkJyk7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KGNvbmZpZy5kamFuZ28uaG9zdCArICc6JyArIGNvbmZpZy5kamFuZ28ucG9ydCArICcvYXBpL2Jvb2svcmF3LycgKyBib29rSUQgKyAnLnJpcycpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldERjUmVjKGJvb2tJRCl7XG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KGNvbmZpZy5kamFuZ28uaG9zdCArICc6JyArIGNvbmZpZy5kamFuZ28ucG9ydCArICcvYXBpL2Jvb2svJyArIGJvb2tJRCk7XG4gICAgfVxuICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC5jb3JlJylcbiAgICAuZmFjdG9yeSgnU2F2ZWRSZWNvcmRzU2VydmljZScsIFsnJHJvb3RTY29wZScsICdTQVZFRF9JVEVNUycsICdERUZBVUxUUycsICdTdG9yYWdlU2VydmljZScsICdfJywgU2F2ZWRSZWNvcmRzU2VydmljZV0pO1xuXG4gIGZ1bmN0aW9uIFNhdmVkUmVjb3Jkc1NlcnZpY2UoJHJvb3RTY29wZSwgU0FWRURfSVRFTVMsIERFRkFVTFRTLCBTdG9yYWdlU2VydmljZSwgXyl7XG5cbiAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgIGdldFJlY29yZHM6IGdldFJlY29yZHMsXG4gICAgICBzYXZlUmVjb3JkOiBzYXZlUmVjb3JkLFxuICAgICAgcmVtb3ZlUmVjb3JkOiByZW1vdmVSZWNvcmQsXG4gICAgICBzYXZlU2VhcmNoOiBzYXZlU2VhcmNoLFxuICAgICAgZ2V0U2VhcmNoZXM6IGdldFNlYXJjaGVzLFxuICAgICAgcmVtb3ZlU2VhcmNoOiByZW1vdmVTZWFyY2hcbiAgICB9O1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgLyoqXG4gICAgICogSGVscGVyIGZ1bmN0aW9uIHRvIGNoZWNrIGlmIHR3byBzZWFyY2hlcyBoYXZlIG1hdGNoaW5nIG9wdGlvbnNcbiAgICAgKiBEb2VzIG5vdCB0YWtlIHBhZ2UsIHNvcnQgb3B0aW9ucywgcGFnZSBzaXplIGludG8gY29uc2lkZXJhdGlvblxuICAgICAqIEBwYXJhbSBvbGRTZWFyY2gge29iamVjdH0gc2VhcmNoIHRvIGNvbXBhcmVcbiAgICAgKiBAcGFyYW0gbmV3U2VhcmNoIHtvYmplY3R9IHNlYXJjaCB0byBjb21wYXJlXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHdoZXRoZXIgc2VhcmNoZXMgbWF0Y2hcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzZWFyY2hlc01hdGNoKG9sZFNlYXJjaCwgbmV3U2VhcmNoKSB7XG4gICAgICBpZiAob2xkU2VhcmNoLnEgIT09IG5ld1NlYXJjaC5xKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmKG5ld1NlYXJjaC5mYWNldHMgJiYgbmV3U2VhcmNoLmZhY2V0cy5sZW5ndGggPiAwKXtcbiAgICAgICAgaWYgKCFfLmlzRXF1YWwob2xkU2VhcmNoLmZhY2V0cywgbmV3U2VhcmNoLmZhY2V0cykpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChuZXdTZWFyY2guYWR2YW5jZWRGaWVsZHMgJiYgbmV3U2VhcmNoLmFkdmFuY2VkRmllbGRzLmxlbmd0aCA+IDApe1xuICAgICAgICBpZiAoIV8uaXNFcXVhbChvbGRTZWFyY2guYWR2YW5jZWRGaWVsZHMsIG5ld1NlYXJjaC5hZHZhbmNlZEZpZWxkcykpe1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKG5ld1NlYXJjaC5kYXRlKSB7XG4gICAgICAgIGlmKCFfLmlzRXF1YWwob2xkU2VhcmNoLmRhdGUsIG5ld1NlYXJjaC5kYXRlKSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2F2ZXMgc2VhcmNoIGlmIGl0IGRpZmZlcnMgZnJvbSB0aGUgbGFzdCBzYXZlZCBzZWFyY2hcbiAgICAgKiBAcGFyYW0gc2VhcmNoT3B0cyB7b2JqZWN0fSBjdXJyZW50IHNlYXJjaCBvcHRpb25zXG4gICAgICogQHBhcmFtIHJlc3VsdHMge251bWJlcn0gbnVtYmVyIG9mIHJlc3VsdHMgZm9yIGdpdmVuIHNlYXJjaCBvcHRpb25zXG4gICAgICovXG4gICAgZnVuY3Rpb24gc2F2ZVNlYXJjaChzZWFyY2hPcHRzLCByZXN1bHRzLCB0aW1lc3RhbXApIHtcbiAgICAgIHZhciBzZWFyY2hlcyA9IGdldFNlYXJjaGVzKCk7XG4gICAgICB2YXIgbGFzdFNlYXJjaE9wdHMgPSBERUZBVUxUUy5zZWFyY2hPcHRzO1xuICAgICAgaWYgKHNlYXJjaGVzICYmIHNlYXJjaGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdmFyIGxhc3RTZWFyY2ggPSBzZWFyY2hlc1tzZWFyY2hlcy5sZW5ndGggLSAxXS5vcHRzO1xuICAgICAgICBpZiAobGFzdFNlYXJjaCkge1xuICAgICAgICAgIGxhc3RTZWFyY2hPcHRzID0gbGFzdFNlYXJjaDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYoIXNlYXJjaGVzTWF0Y2gobGFzdFNlYXJjaE9wdHMsIHNlYXJjaE9wdHMpKSB7XG4gICAgICAgIHZhciBuZXdTZWFyY2ggPSB7XG4gICAgICAgICAgb3B0czogc2VhcmNoT3B0cyxcbiAgICAgICAgICBudW1SZXN1bHRzOiByZXN1bHRzLFxuICAgICAgICAgIHRpbWU6IHRpbWVzdGFtcFxuICAgICAgICB9O1xuICAgICAgICBzYXZlSXRlbShTQVZFRF9JVEVNUy5zZWFyY2hLZXksIG5ld1NlYXJjaCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHNlYXJjaGVzIGZyb20gc3RvcmFnZVxuICAgICAqIEByZXR1cm5zIHthcnJheX0gb2Ygc2VhcmNoIG9iamVjdHNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRTZWFyY2hlcygpIHtcbiAgICAgIHJldHVybiBnZXRJdGVtcyhTQVZFRF9JVEVNUy5zZWFyY2hLZXkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgc2VhcmNoIG9iamVjdCBmcm9tIHNlYXJjaCBoaXN0b3J5XG4gICAgICogQHBhcmFtIHNlYXJjaCB7b2JqZWN0fSBzZWFyY2ggdG8gcmVtb3ZlXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVtb3ZlU2VhcmNoKHNlYXJjaCkge1xuICAgICAgcmVtb3ZlSXRlbShTQVZFRF9JVEVNUy5zZWFyY2hLZXksIHNlYXJjaCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29udmVuaWVuY2UgZnVuY3Rpb24gZm9yIHJldHVybmluZyByZWNvcmRzXG4gICAgICogQHJldHVybnMge2FycmF5fSByZWNvcmRzXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UmVjb3JkcygpIHtcbiAgICAgIHJldHVybiBnZXRJdGVtcyhTQVZFRF9JVEVNUy5yZWNvcmRLZXkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnZlbmllbmNlIGZ1bmN0aW9uIGZvciBzYXZpbmcgcmVjb3Jkcy5cbiAgICAgKiBAcGFyYW0gcmVjb3JkIHtvYmplY3R9IHJlY29yZCB0byBzYXZlXG4gICAgICovXG4gICAgZnVuY3Rpb24gc2F2ZVJlY29yZChyZWNvcmQpIHtcbiAgICAgIHNhdmVJdGVtKFNBVkVEX0lURU1TLnJlY29yZEtleSwgcmVjb3JkKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZW5pZW5jZSBmdW5jdGlvbiBmb3IgcmVtb3ZpbmcgcmVjb3Jkc1xuICAgICAqIEBwYXJhbSByZWNvcmQge29iamVjdH0gcmVjb3JkIHRvIHJlbW92ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlbW92ZVJlY29yZChyZWNvcmQpIHtcbiAgICAgIHJlbW92ZUl0ZW0oU0FWRURfSVRFTVMucmVjb3JkS2V5LCByZWNvcmQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBpdGVtcyBmcm9tIHN0b3JhZ2Ugc2VydmljZS5cbiAgICAgKiBIYW5kbGVzIGRlLXNlcmlhbGl6aW5nIGRhdGFcbiAgICAgKiBAcGFyYW0gdHlwZSB7c3RyaW5nfSB0eXBlIG9mIGl0ZW1zIHRvIGdldFxuICAgICAqIEByZXR1cm5zIGFycmF5IG9mIGl0ZW0gb2JqZWN0XG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0SXRlbXModHlwZSkge1xuICAgICAgdmFyIGl0ZW1zID0gU3RvcmFnZVNlcnZpY2UuZ2V0SXRlbXModHlwZSk7XG4gICAgICBpZiAoaXRlbXMpIHtcbiAgICAgICAgdmFyIHJlY29yZHMgPSBKU09OLnBhcnNlKGl0ZW1zKTtcbiAgICAgICAgaWYoIXJlY29yZHNbdHlwZV0pIHtcbiAgICAgICAgICByZWNvcmRzW3R5cGVdID0gW107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlY29yZHNbdHlwZV07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gaXRlbXM7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbHMgU3RvcmFnZVNlcnZpY2UgdG8gc2F2ZSBpdGVtLlxuICAgICAqIEhhbmRsZXMgc2VyaWFsaXppbmcgYW5kIGRlLXNlcmlhbGl6aW5nIG9mIGRhdGFcbiAgICAgKiBDaGVja3MgaWYgc2F2aW5nIHN1Y2NlZWRlZFxuICAgICAqIEBwYXJhbSB0eXBlIHtzdHJpbmd9IHR5cGUgb2YgaXRlbSB0byBzYXZlXG4gICAgICogQHBhcmFtIGl0ZW0ge29iamVjdH0gaXRlbSB0byBzYXZlXG4gICAgICovXG4gICAgZnVuY3Rpb24gc2F2ZUl0ZW0odHlwZSwgaXRlbSkge1xuICAgICAgdmFyIHNhdmVkSXRlbXMgPSBTdG9yYWdlU2VydmljZS5nZXRJdGVtcyh0eXBlKTtcbiAgICAgIGlmIChzYXZlZEl0ZW1zKSB7XG4gICAgICAgIHNhdmVkSXRlbXMgPSBKU09OLnBhcnNlKHNhdmVkSXRlbXMpO1xuICAgICAgICBpZighc2F2ZWRJdGVtc1t0eXBlXSl7XG4gICAgICAgICAgc2F2ZWRJdGVtc1t0eXBlXSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHNhdmVkSXRlbXNbdHlwZV0ucHVzaChpdGVtKTtcbiAgICAgICAgdmFyIHN1Y2Nlc3MgPSBTdG9yYWdlU2VydmljZS5zZXRJdGVtKHR5cGUsIEpTT04uc3RyaW5naWZ5KHNhdmVkSXRlbXMpKTtcbiAgICAgICAgaWYgKCFzdWNjZXNzICYmIHR5cGUgPT09IFNBVkVEX0lURU1TLnJlY29yZEtleSkge1xuICAgICAgICAgIGFsZXJ0KFwiRXJyb3I6IENvdWxkIG5vdCBzYXZlIHJlY29yZCB0byBsb2NhbCBzdG9yYWdlLiBQbGVhc2UgY2hlY2sgeW91ciBicm93c2VyIHNldHRpbmdzLlwiKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBTQVZFRF9JVEVNUy5yZWNvcmRLZXkpIHtcbiAgICAgICAgYWxlcnQoXCJFcnJvcjogQ291bGQgbm90IHNhdmUgcmVjb3JkIHRvIGxvY2FsIHN0b3JhZ2UuIFBsZWFzZSBjaGVjayB5b3VyIGJyb3dzZXIgc2V0dGluZ3MuXCIpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxzIFN0b3JhZ2VTZXJ2aWNlIHRvIHJlbW92ZSBpdGVtLlxuICAgICAqIEhhbmRsZXMgc2VyaWFsaXppbmcgYW5kIGRlc2VyaWFsaXppbmcgZGF0YVxuICAgICAqIEBwYXJhbSB0eXBlIHtzdHJpbmd9IHR5cGUgb2YgaXRlbSB0byBzYXZlXG4gICAgICogQHBhcmFtIGl0ZW0ge29iamVjdH0gaXRlbSB0byBzYXZlXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVtb3ZlSXRlbSh0eXBlLCBpdGVtKSB7XG4gICAgICB2YXIgaXRlbXMgPSBTdG9yYWdlU2VydmljZS5nZXRJdGVtcyh0eXBlKTtcbiAgICAgIGlmIChpdGVtcykge1xuICAgICAgICBpdGVtcyA9IEpTT04ucGFyc2UoaXRlbXMpO1xuICAgICAgICB2YXIgcmVjb3JkcyA9IGl0ZW1zW3R5cGVdO1xuICAgICAgICBpZiAocmVjb3Jkcykge1xuICAgICAgICAgIHZhciBuZXdSZWNvcmRzID0gcmVjb3Jkcy5maWx0ZXIoZnVuY3Rpb24gKHJlY29yZCkge1xuICAgICAgICAgICAgaWYodHlwZSA9PT0gU0FWRURfSVRFTVMucmVjb3JkS2V5KSB7XG4gICAgICAgICAgICAgIHJldHVybiByZWNvcmQuX2lkICE9PSBpdGVtLl9pZDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBpdGVtLnRpbWUgIT09IHJlY29yZC50aW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGl0ZW1zW3R5cGVdID0gbmV3UmVjb3JkcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpdGVtc1t0eXBlXSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzdWNjZXNzID0gU3RvcmFnZVNlcnZpY2Uuc2V0SXRlbSh0eXBlLCBKU09OLnN0cmluZ2lmeShpdGVtcykpO1xuICAgICAgICBpZiAoIXN1Y2Nlc3MgJiYgdHlwZSA9PT0gU0FWRURfSVRFTVMucmVjb3JkS2V5KSB7XG4gICAgICAgICAgYWxlcnQoXCJFcnJvcjogQ291bGQgbm90IHJlbW92ZSBpdGVtLiBQbGVhc2UgY2hlY2sgeW91ciBicm93c2VyIHNldHRpbmdzLlwiKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWxlcnQoXCJFcnJvcjogQ291bGQgbm90IHJlbW92ZSBpdGVtLiBQbGVhc2UgY2hlY2sgeW91ciBicm93c2VyIHNldHRpbmdzLlwiKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAuY29yZScpXG4gICAgLmZhY3RvcnkoJ1N0b3JhZ2VTZXJ2aWNlJywgW1N0b3JhZ2VTZXJ2aWNlXSk7XG5cbiAgZnVuY3Rpb24gU3RvcmFnZVNlcnZpY2UoKXtcblxuICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgZ2V0SXRlbXM6IGdldEl0ZW1zLFxuICAgICAgc2V0SXRlbTogc2V0SXRlbVxuICAgIH07XG5cbiAgICByZXR1cm4gc2VydmljZTtcblxuICAgIC8qKlxuICAgICAqIEdldCBpdGVtcyBmcm9tIGxvY2FsIHN0b3JhZ2VcbiAgICAgKiBAcGFyYW0ga2V5IHtzdHJpbmd9IGl0ZW0gdG8gZ2V0XG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IGl0ZW0gb3IgZmFsc2UgaWYgZmFpbHVyZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldEl0ZW1zKGtleSl7XG4gICAgICB0cnkge1xuICAgICAgICB2YXIgaXRlbSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSk7XG4gICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYoaXRlbSkge1xuICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBuZXdJdGVtID0ge307XG4gICAgICAgIHZhciBpdGVtQXNTdHJpbmcgPSBKU09OLnN0cmluZ2lmeShuZXdJdGVtKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIGl0ZW1Bc1N0cmluZyk7XG4gICAgICAgICAgcmV0dXJuIGl0ZW1Bc1N0cmluZztcbiAgICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IGl0ZW0gaW4gbG9jYWwgc3RvcmFnZVxuICAgICAqIEBwYXJhbSBrZXkge3N0cmluZ30ga2V5IGZvciB0aGUgaXRlbVxuICAgICAqIEBwYXJhbSBpdGVtIHtzdHJpbmd9IGl0ZW0gdG8gc3RvcmVcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gd2hldGhlciBzZXR0aW5nIGl0ZW0gc3VjY2VlZGVkXG4gICAgICovXG4gICAgZnVuY3Rpb24gc2V0SXRlbShrZXksIGl0ZW0pe1xuICAgICAgdHJ5IHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBpdGVtKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAud2lkZ2V0cycsIFsnYW5ndWxhclV0aWxzLmRpcmVjdGl2ZXMuZGlyUGFnaW5hdGlvbiddKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwLndpZGdldHMnKVxuICAgIC5jb25maWcoWydjb25maWcnLCAncGFnaW5hdGlvblRlbXBsYXRlUHJvdmlkZXInLCBmdW5jdGlvbihjb25maWcsIHBhZ2luYXRpb25UZW1wbGF0ZVByb3ZpZGVyKXtcbiAgICAgIC8vIFNldCB0ZW1wbGF0ZSBmb3IgZGlyUGFnaW5hdGlvbiBkaXJlY3RpdmVcbiAgICAgIGNvbnNvbGUubG9nKCcuLi53aWRnZXRDb25maWc6IFNldHRpbmcgcGFnaW5hdGlvblRlbXBsYXRlUHJvdmlkZXInKTtcbiAgICAgIHBhZ2luYXRpb25UZW1wbGF0ZVByb3ZpZGVyLnNldFBhdGgoY29uZmlnLmFwcC5yb290ICsgJy9ib3dlcl9jb21wb25lbnRzL2FuZ3VsYXJVdGlscy9kaXJQYWdpbmF0aW9uLmN1c3RvbS50cGwuaHRtbCcpO1xuICAgIH1dKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAud2lkZ2V0cycsIFtdKVxuICAgIC5zZXJ2aWNlKCdhbmNob3JTbW9vdGhTY3JvbGwnLCBbYW5jaG9yU21vb3RoU2Nyb2xsXSlcbiAgICAuY29udHJvbGxlcignU2Nyb2xsQ3RybCcsIFsnJHNjb3BlJywgJyRsb2NhdGlvbicsICdhbmNob3JTbW9vdGhTY3JvbGwnLCBTY3JvbGxDdHJsXSk7XG5cbiAgICBmdW5jdGlvbiBhbmNob3JTbW9vdGhTY3JvbGwoKXtcbiAgICAgIHRoaXMuc2Nyb2xsVG8gPSBmdW5jdGlvbihlSUQpIHtcbiAgICAgICAgdmFyIHN0YXJ0WSA9IGN1cnJlbnRZUG9zaXRpb24oKTtcbiAgICAgICAgdmFyIHN0b3BZID0gZWxtWVBvc2l0aW9uKGVJRCk7XG4gICAgICAgIHZhciBkaXN0YW5jZSA9IHN0b3BZID4gc3RhcnRZID8gc3RvcFkgLSBzdGFydFkgOiBzdGFydFkgLSBzdG9wWTtcbiAgICAgICAgaWYgKGRpc3RhbmNlIDwgMTAwKSB7XG4gICAgICAgICAgc2Nyb2xsVG8oMCwgc3RvcFkpOyByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc3BlZWQgPSBNYXRoLnJvdW5kKGRpc3RhbmNlIC8gMTAwKTtcbiAgICAgICAgaWYgKHNwZWVkID49IDIwKSBzcGVlZCA9IDIwO1xuXG4gICAgICAgIHZhciBzdGVwID0gTWF0aC5yb3VuZChkaXN0YW5jZSAvIDI1KTtcbiAgICAgICAgdmFyIGxlYXBZID0gc3RvcFkgPiBzdGFydFkgPyBzdGFydFkgKyBzdGVwIDogc3RhcnRZIC0gc3RlcDtcbiAgICAgICAgdmFyIHRpbWVyID0gMDtcblxuICAgICAgICBpZiAoc3RvcFkgPiBzdGFydFkpIHtcbiAgICAgICAgICBmb3IgKCB2YXIgaT1zdGFydFk7IGk8c3RvcFk7IGkrPXN0ZXAgKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KFwid2luZG93LnNjcm9sbFRvKDAsIFwiK2xlYXBZK1wiKVwiLCB0aW1lciAqIHNwZWVkKTtcbiAgICAgICAgICAgIGxlYXBZICs9IHN0ZXA7IGlmIChsZWFwWSA+IHN0b3BZKSBsZWFwWSA9IHN0b3BZOyB0aW1lcisrO1xuICAgICAgICAgIH0gcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGZvciAoIHZhciBpPXN0YXJ0WTsgaT5zdG9wWTsgaS09c3RlcCApIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoXCJ3aW5kb3cuc2Nyb2xsVG8oMCwgXCIrbGVhcFkrXCIpXCIsIHRpbWVyICogc3BlZWQpO1xuICAgICAgICAgICAgbGVhcFkgLT0gc3RlcDsgaWYgKGxlYXBZIDwgc3RvcFkpIGxlYXBZID0gc3RvcFk7IHRpbWVyKys7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgZnVuY3Rpb24gY3VycmVudFlQb3NpdGlvbigpIHtcbiAgICAgICAgICAgIC8vIEZpcmVmb3gsIENocm9tZSwgT3BlcmEsIFNhZmFyaVxuICAgICAgICAgICAgaWYgKHNlbGYucGFnZVlPZmZzZXQpIHJldHVybiBzZWxmLnBhZ2VZT2Zmc2V0O1xuICAgICAgICAgICAgLy8gSW50ZXJuZXQgRXhwbG9yZXIgNiAtIHN0YW5kYXJkcyBtb2RlXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3ApXG4gICAgICAgICAgICAgIHJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgICAgICAgICAgLy8gSW50ZXJuZXQgRXhwbG9yZXIgNiwgNyBhbmQgOFxuICAgICAgICAgICAgaWYgKGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wKSByZXR1cm4gZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBlbG1ZUG9zaXRpb24oZUlEKSB7XG4gICAgICAgICAgICB2YXIgZWxtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZUlEKTtcbiAgICAgICAgICAgIHZhciB5ID0gZWxtLm9mZnNldFRvcDtcbiAgICAgICAgICAgIHZhciBub2RlID0gZWxtO1xuICAgICAgICAgICAgd2hpbGUgKG5vZGUub2Zmc2V0UGFyZW50ICYmIG5vZGUub2Zmc2V0UGFyZW50ICE9IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgICAgICAgICAgbm9kZSA9IG5vZGUub2Zmc2V0UGFyZW50O1xuICAgICAgICAgICAgICB5ICs9IG5vZGUub2Zmc2V0VG9wO1xuICAgICAgICAgICAgfSByZXR1cm4geTtcbiAgICAgICAgICB9XG4gICAgICB9O1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBTY3JvbGxDdHJsICgkc2NvcGUsICRsb2NhdGlvbiwgYW5jaG9yU21vb3RoU2Nyb2xsKSB7XG4gICAgICAkc2NvcGUuZ290b0VsZW1lbnQgPSBmdW5jdGlvbiAoZUlEKXtcbiAgICAgICAgLy8gc2V0IHRoZSBsb2NhdGlvbi5oYXNoIHRvIHRoZSBpZCBvZlxuICAgICAgICAvLyB0aGUgZWxlbWVudCB5b3Ugd2lzaCB0byBzY3JvbGwgdG8uXG4gICAgICAgICRsb2NhdGlvbi5oYXNoKCdib3R0b20nKTtcbiAgICAgICAgLy8gY2FsbCAkYW5jaG9yU2Nyb2xsKClcbiAgICAgICAgYW5jaG9yU21vb3RoU2Nyb2xsLnNjcm9sbFRvKGVJRCk7XG4gICAgICB9O1xuICAgIH07XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcC53aWRnZXRzJywgWyduZ0FuaW1hdGUnXSlcbiAgICAuYW5pbWF0aW9uKCcuYm9vaycsIGFuaW1hdGlvbkZ1bmNzKTtcblxuICAgIGZ1bmN0aW9uIGFuaW1hdGlvbkZ1bmNzKCkge1xuICAgICAgdmFyIGFuaW1hdGVVcCA9IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSwgZG9uZSkge1xuICAgICAgICBpZihjbGFzc05hbWUgIT0gJ2FjdGl2ZScpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxlbWVudC5jc3Moe1xuICAgICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgICAgIHRvcDogNTAwLFxuICAgICAgICAgIGxlZnQ6IDAsXG4gICAgICAgICAgZGlzcGxheTogJ2Jsb2NrJ1xuICAgICAgICB9KTtcblxuICAgICAgICBqUXVlcnkoZWxlbWVudCkuYW5pbWF0ZSh7XG4gICAgICAgICAgdG9wOiAwXG4gICAgICAgIH0sIGRvbmUpO1xuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbihjYW5jZWwpIHtcbiAgICAgICAgICBpZihjYW5jZWwpIHtcbiAgICAgICAgICAgIGVsZW1lbnQuc3RvcCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgdmFyIGFuaW1hdGVEb3duID0gZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lLCBkb25lKSB7XG4gICAgICAgIGlmKGNsYXNzTmFtZSAhPSAnYWN0aXZlJykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBlbGVtZW50LmNzcyh7XG4gICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICAgICAgbGVmdDogMCxcbiAgICAgICAgICB0b3A6IDBcbiAgICAgICAgfSk7XG5cbiAgICAgICAgalF1ZXJ5KGVsZW1lbnQpLmFuaW1hdGUoe1xuICAgICAgICAgIHRvcDogLTUwMFxuICAgICAgICB9LCBkb25lKTtcblxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oY2FuY2VsKSB7XG4gICAgICAgICAgaWYoY2FuY2VsKSB7XG4gICAgICAgICAgICBlbGVtZW50LnN0b3AoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFkZENsYXNzOiBhbmltYXRlVXAsXG4gICAgICAgIHJlbW92ZUNsYXNzOiBhbmltYXRlRG93blxuICAgICAgfTtcbiAgICB9O1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdhcHAud2lkZ2V0cycsIFtdKVxuICAgIC5maWx0ZXIoJ3N0cmlwc3BhY2VzJywgW2Z1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgICAgICAgIGlmICghYW5ndWxhci5pc1N0cmluZyhpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaW5wdXQucmVwbGFjZSgvW1xcc10vZywgJycpO1xuICAgICAgICB9O1xuICAgIH1dKVxuICAgIC5maWx0ZXIoJ2NhcGl0YWxpemUnLCBbZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oaW5wdXQpIHtcbiAgICAgICAgaWYgKCFhbmd1bGFyLmlzU3RyaW5nKGlucHV0KSkge1xuICAgICAgICAgIHJldHVybiBpbnB1dDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2FwaXRhbGl6ZWQgPSBpbnB1dC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGlucHV0LnNsaWNlKDEpO1xuICAgICAgICByZXR1cm4gY2FwaXRhbGl6ZWQ7XG4gICAgICB9O1xuICAgIH1dKTtcbiAgICBcbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAuaG9tZScsIFtdKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gIC5tb2R1bGUoJ2FwcC5ob21lJylcbiAgLmNvbnRyb2xsZXIoJ0hvbWVQYWdlQ3RybCcsIFsnJHNjb3BlJywgJ1NlYXJjaFNlcnZpY2UnLCAnJHN0YXRlJywgJ1NPUlRfTU9ERVMnLCAnY29uZmlnJywgSG9tZVBhZ2VDdHJsXSk7XG5cbiAgZnVuY3Rpb24gSG9tZVBhZ2VDdHJsKCRzY29wZSwgU2VhcmNoU2VydmljZSwgJHN0YXRlLCBTT1JUX01PREVTLCBjb25maWcpIHtcbiAgICAkc2NvcGUudG90YWxUaXRsZXMgPSBjb25maWcubnVtVG90YWxUaXRsZXM7XG5cbiAgICAkc2NvcGUubmV3U2VhcmNoID0gIG5ld1NlYXJjaDtcbiAgICAkc2NvcGUubW9zdFJlY2VudFNlYXJjaCA9IG1vc3RSZWNlbnRTZWFyY2g7XG4gICAgJHNjb3BlLnNob3dTcGlubmVyID0gZmFsc2U7XG5cbiAgICBmdW5jdGlvbiBuZXdTZWFyY2gob3B0cykge1xuICAgICAgU2VhcmNoU2VydmljZS5yZXNldE9wdHMoKTtcbiAgICAgIFNlYXJjaFNlcnZpY2UudXBkYXRlT3B0cyhvcHRzKTtcbiAgICAgIFNlYXJjaFNlcnZpY2UudHJhbnNpdGlvblN0YXRlQW5kU2VhcmNoKCk7XG4gICAgICAkc2NvcGUuc2hvd1NwaW5uZXIgPSB0cnVlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG1vc3RSZWNlbnRTZWFyY2goKXtcbiAgICAgIFNlYXJjaFNlcnZpY2UucmVzZXRPcHRzKCk7XG4gICAgICBTZWFyY2hTZXJ2aWNlLnVwZGF0ZU9wdHMoe3NvcnQ6IFNPUlRfTU9ERVMuZGF0ZV9hZGRlZCwgZnJvbTogMH0pO1xuICAgICAgU2VhcmNoU2VydmljZS50cmFuc2l0aW9uU3RhdGVBbmRTZWFyY2goKTtcbiAgICAgICRzY29wZS5zaG93U3Bpbm5lciA9IHRydWU7XG4gICAgfVxuICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5zZWFyY2gnLCBbXSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAubW9kdWxlKCdhcHAuc2VhcmNoJylcbiAgLmNvbnRyb2xsZXIoJ1NlYXJjaEN0cmwnLCBbJyRzY29wZScsICckc3RhdGUnLCAnU2VhcmNoU2VydmljZScsICdTYXZlZFJlY29yZHNTZXJ2aWNlJywgJ3NlYXJjaFJlc3VsdHMnLCAnU09SVF9NT0RFUycsICdERUZBVUxUUycsICdGQUNFVFMnLCAnU09SVF9ERUZBVUxUJywgU2VhcmNoQ3RybF0pO1xuXG4gIGZ1bmN0aW9uIFNlYXJjaEN0cmwoJHNjb3BlLCAkc3RhdGUsIFNlYXJjaFNlcnZpY2UsIFNhdmVkUmVjb3Jkc1NlcnZpY2UsIHNlYXJjaFJlc3VsdHMsIFNPUlRfTU9ERVMsIERFRkFVTFRTLCBGQUNFVFMsIFNPUlRfREVGQVVMVCl7XG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLy9Jbml0XG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICB2YXIgc3MgPSBTZWFyY2hTZXJ2aWNlO1xuXG4gICAgJHNjb3BlLmlzT3BlbkNyZWF0b3IgPSB0cnVlO1xuICAgICRzY29wZS5pc09wZW5TdWJqZWN0ID0gdHJ1ZTtcbiAgICAkc2NvcGUuaXNPcGVuTGFuZ3VhZ2UgPSB0cnVlO1xuICAgICRzY29wZS5pc09wZW5Gcm9tID0gdHJ1ZTtcblxuICAgICRzY29wZS5oaXRzID0gc2VhcmNoUmVzdWx0cy5oaXRzO1xuICAgICRzY29wZS5udW1Ub3RhbEhpdHMgPSBzZWFyY2hSZXN1bHRzLm51bVRvdGFsSGl0cztcbiAgICAkc2NvcGUuZmFjZXRzID0gc2VhcmNoUmVzdWx0cy5mYWNldHM7XG5cbiAgICAvLyBiaW5kIHNlYXJjaCBvcHRzIHRvIHNjb3BlXG4gICAgJHNjb3BlLmFjdGl2ZUZhY2V0cyA9IHNzLm9wdHMuZmFjZXRzO1xuICAgICRzY29wZS5hZHZhbmNlZEZpZWxkcyA9IHNzLm9wdHMuYWR2YW5jZWRGaWVsZHM7XG5cbiAgICAkc2NvcGUuZnJvbURhdGUgPSBzcy5vcHRzLmRhdGUuZ3RlO1xuICAgICRzY29wZS50b0RhdGUgPSBzcy5vcHRzLmRhdGUubHRlO1xuICAgICRzY29wZS5kYXRlUmFuZ2UgPSBzcy5vcHRzLmRhdGU7XG5cbiAgICAkc2NvcGUucXVlcnlUZXJtcyA9IHNzLm9wdHMucTtcbiAgICAkc2NvcGUubmV3UXVlcnlUZXJtID0gXCJcIjtcbiAgICAkc2NvcGUucGFnaW5hdGlvbiA9IHtcbiAgICAgIC8vIG11c3QgcGFyc2VJbnQgc28gaXMgdHJlYXRlZCBhcyBpbnQgaW4gY29kZVxuICAgICAgcGFnZSA6IHNzLmNhbGN1bGF0ZVBhZ2UoKSxcbiAgICAgIHNpemUgOiBwYXJzZUludChzcy5vcHRzLnNpemUpLFxuICAgICAgZnJvbSA6IHBhcnNlSW50KHNzLm9wdHMuZnJvbSlcbiAgICB9O1xuXG4gICAgJHNjb3BlLmNhdGVnb3JpZXMgPSBGQUNFVFM7XG4gICAgJHNjb3BlLnNvcnQgPSBTT1JUX01PREVTW3NzLm9wdHMuc29ydF0uZGlzcGxheTtcbiAgICAkc2NvcGUuc2hvd1NwaW5uZXIgPSBmYWxzZTtcblxuICAgIGNvbnNvbGUubG9nKCdTZWFyY2hDdHJsOjokc2NvcGUuc29ydDogJyArIEpTT04uc3RyaW5naWZ5KCRzY29wZS5zb3J0KSk7XG4gICAgY29uc29sZS5sb2coJ1NlYXJjaEN0cmw6OiRzY29wZS5wYWdpbmF0aW9uOiAnICsgSlNPTi5zdHJpbmdpZnkoJHNjb3BlLnBhZ2luYXRpb24pKTtcbiAgICBjb25zb2xlLmxvZygnU2VhcmNoQ3RybDo6JHNjb3BlLm51bVRvdGFsSGl0czogJyArICRzY29wZS5udW1Ub3RhbEhpdHMpO1xuXG4gICAgJHNjb3BlLnNhdmVkUmVjb3JkcyA9IFNhdmVkUmVjb3Jkc1NlcnZpY2UuZ2V0UmVjb3JkcygpO1xuXG4gICAgJHNjb3BlLmJvb2tNYXJrVGV4dCA9IFwiXCI7XG4gICAgc2F2ZVNlYXJjaChzcy5vcHRzLCAkc2NvcGUubnVtVG90YWxIaXRzKTtcblxuXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLy9WYXJpYWJsZXNcbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAkc2NvcGUuYWxsUGFnZVNpemVPcHRpb25zID0gWzEwLDI1LDUwLDEwMF07XG4gICAgJHNjb3BlLnZhbGlkU29ydE1vZGVzID0gU09SVF9NT0RFUztcbiAgICAkc2NvcGUudmFsaWRQYWdlU2l6ZU9wdGlvbnMgPSBnZXRWYWxpZFBhZ2VTaXplT3B0aW9ucygkc2NvcGUubnVtVG90YWxIaXRzKTtcblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIC8vUHJpdmF0ZS9IZWxwZXIgRnVuY3Rpb25zXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblxuICAgIC8qKlxuICAgICAqIENsZWFyIGFsbCBhY3RpdmUgZmFjZXRzIGZyb20gY29udHJvbGxlci4gRG9lcyBub3QgdXBkYXRlIFNlYXJjaFNlcnZpY2Ugb3IgcmV0cmlnZ2VyIHNlYXJjaC5cbiAgICAgKiBTaG91bGQgYWx3YXlzIHJ1biB1cGRhdGVTZWFyY2goKSB3L25ldyBmYWNldCBvcHRzIGFmdGVyIGV4ZWN1dGluZyB0aGlzIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNsZWFyQWN0aXZlRmFjZXRzKCl7XG4gICAgICAvLyBuZWVkIHRvIGRvIHRoaXMgc28gZmFjZXRzIGRvbid0IHJlc2V0IHRoZW1zZWx2ZXNcbiAgICAgICRzY29wZS5hY3RpdmVGYWNldHMuZm9yRWFjaChmdW5jdGlvbihmYWNldCl7XG4gICAgICAgIGZhY2V0LmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgICAkc2NvcGUuYWN0aXZlRmFjZXRzID0gW107XG4gICAgICAkc2NvcGUuYWR2YW5jZWRGaWVsZHMgPSBbXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZWxvYWQgc2VhcmNoIHJlc3VsdCBzdGF0ZSB0byB0cmlnZ2VyIHNlYXJjaC5cbiAgICAgKiBpZiBubyBvcHRzIHBhc3NlZCB1c2VzIFNlYXJjaFNlcnZpY2Uub3B0cy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1cGRhdGVTZWFyY2gob3B0cykge1xuICAgICAgLy8gdXNlIFNlYXJjaFNlcnZpY2Uub3B0cyBhcyBjYW5vbmljYWxcbiAgICAgIHNzLnVwZGF0ZU9wdHMob3B0cyk7XG4gICAgICBjb25zb2xlLmxvZygnU2VhcmNoQ3RybDo6dXBkYXRlU2VhcmNoKCkgLS0gYWRkXFwnbCBvcHRzOiAnICsgSlNPTi5zdHJpbmdpZnkob3B0cykpO1xuICAgICAgY29uc29sZS5sb2coJ1NlYXJjaEN0cmw6OnVwZGF0ZVNlYXJjaCgpIC0tIG1lcmdlZCBTZWFyY2hTZXJ2aWNlLm9wdHM6ICcgKyBKU09OLnN0cmluZ2lmeShzcy5vcHRzKSk7XG4gICAgICAkc2NvcGUuc2hvd1NwaW5uZXIgPSB0cnVlO1xuICAgICAgc3MudHJhbnNpdGlvblN0YXRlQW5kU2VhcmNoKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2F2ZXMgY3VycmVudCBzZWFyY2ggb3B0aW9ucyB0byBzdG9yYWdlXG4gICAgICogQHBhcmFtIHNlYXJjaE9wdHMge29iamVjdH0gb3B0aW9ucyB0byBzYXZlXG4gICAgICogQHBhcmFtIHJlc3VsdHMge2ludGVnZXJ9IG51bWJlciBvZiByZXN1bHRzIGZvciBzZWFyY2ggb3B0aW9uc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNhdmVTZWFyY2ggKHNlYXJjaE9wdHMsIHJlc3VsdHMpIHtcbiAgICAgIHZhciB0aW1lc3RhbXAgPSBEYXRlLm5vdygpO1xuICAgICAgU2F2ZWRSZWNvcmRzU2VydmljZS5zYXZlU2VhcmNoKHNlYXJjaE9wdHMsIHJlc3VsdHMsIHRpbWVzdGFtcCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0VmFsaWRQYWdlU2l6ZU9wdGlvbnMobnVtVG90YWxIaXRzKXtcbiAgICAgIHZhciBwYXNzZWRUaHJlc2hvbGQgPSBmYWxzZTtcbiAgICAgIHJldHVybiAkc2NvcGUuYWxsUGFnZVNpemVPcHRpb25zXG4gICAgICAgIC5maWx0ZXIoZnVuY3Rpb24ocGFnZVNpemUpe1xuICAgICAgICAgIC8vIHJldHVybiBwYWdlU2l6ZU9wdGlvbiAxIGdyZWF0ZXIgdGhhbiBudW1Ub3RhbEhpdHMsXG4gICAgICAgICAgLy8gc28gYWxsIGhpdHMgY2FuIGJlIHZpZXdlZCBvbiAxIHBhZ2UuXG4gICAgICAgICAgaWYoIXBhc3NlZFRocmVzaG9sZCAmJiAocGFnZVNpemUgPj0gbnVtVG90YWxIaXRzKSl7XG4gICAgICAgICAgICBwYXNzZWRUaHJlc2hvbGQgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIHBhZ2VTaXplO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcGFnZVNpemUgPD0gbnVtVG90YWxIaXRzO1xuICAgICAgICB9KTtcbiAgICB9XG5cblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIC8vRnVuY3Rpb25zXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAvKipcbiAgICAgKiBpbml0IHNlYXJjaCBvbiBuZXcgcXVlcnkgdGVybVxuICAgICAqIEFkZGluZyBuZXcgcXVlcnkgdGVybSB0byBwcmV2aW91cyBxdWVyeSB0ZXJtXG4gICAgICovXG4gICAgJHNjb3BlLm5ld1F1ZXJ5U2VhcmNoID0gZnVuY3Rpb24ocXVlcnkpe1xuICAgICAgdmFyIG5ld1F1ZXJ5O1xuICAgICAgaWYgKHF1ZXJ5KSB7XG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkudHJpbSgpO1xuICAgICAgICBpZiAoJHNjb3BlLnF1ZXJ5VGVybXMuaW5kZXhPZihxdWVyeSkgPT09IC0xKXtcbiAgICAgICAgICAkc2NvcGUucXVlcnlUZXJtcy5wdXNoKHF1ZXJ5LnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB2YXIgb3B0cyA9IHtcbiAgICAgICAgcTogJHNjb3BlLnF1ZXJ5VGVybXMsXG4gICAgICAgIGZyb206IDAsXG4gICAgICAgIHNvcnQ6IFNPUlRfTU9ERVNbU09SVF9ERUZBVUxUXVxuICAgICAgfTtcbiAgICAgICRzY29wZS5uZXdRdWVyeVRlcm0gPSBcIlwiO1xuICAgICAgdXBkYXRlU2VhcmNoKG9wdHMpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiB1cGRhdGUgcGFnZXNpemUuIGluaXQgbmV3IHNlYXJjaCBpZiBwYWdlc2l6ZSBpbmNyZWFzZXNcbiAgICAgKiBwYWdpbmF0aW9uIHJlc2V0cyBpZiBwYWdlU2l6ZSBjaGFuZ2VzXG4gICAgICovXG4gICAgJHNjb3BlLnNldFBhZ2VTaXplID0gZnVuY3Rpb24obmV3UGFnZVNpemUpe1xuICAgICAgY29uc29sZS5sb2coJ1NlYXJjaEN0cmw6OnNldFBhZ2VTaXplIC0gY3VycmVudDogJyArIHNzLm9wdHMuc2l6ZSArICcgLCBuZXc6ICcgKyBuZXdQYWdlU2l6ZSk7XG4gICAgICB1cGRhdGVTZWFyY2goe3NpemU6IG5ld1BhZ2VTaXplLCBmcm9tOiAwfSk7XG4gICAgfTtcblxuICAgICRzY29wZS5zZXRTb3J0TW9kZSA9IGZ1bmN0aW9uKHNvcnRNb2RlKSB7XG4gICAgICBjb25zb2xlLmxvZygnQ2hhbmdpbmcgc29ydCB0byAnICsgc29ydE1vZGUuZGlzcGxheSk7XG4gICAgICB1cGRhdGVTZWFyY2goe3NvcnQ6IHNvcnRNb2RlLCBmcm9tOiAwfSk7XG4gICAgfTtcblxuICAgICAkc2NvcGUuc2V0RGF0ZVJhbmdlID0gZnVuY3Rpb24oZnJvbURhdGUsIHRvRGF0ZSkge1xuICAgICAgY29uc29sZS5sb2coXCJmcm9tRGF0ZTogXCIgKyBmcm9tRGF0ZSArIFwiLCB0b0RhdGU6IFwiICsgdG9EYXRlKTtcbiAgICAgIHVwZGF0ZVNlYXJjaCh7ZGF0ZToge1wiZ3RlXCI6IGZyb21EYXRlLCBcImx0ZVwiOiB0b0RhdGV9LCBmcm9tOiAwfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIHRyaWdnZXIgc2VhcmNoIHRvIHBvcHVsYXRlIG5ldyBwYWdlIGFuZCB1cGRhdGUgJHNjb3BlIC8gc3RhdGVcbiAgICAgKi9cbiAgICAkc2NvcGUuc2V0UGFnZU51bSA9IGZ1bmN0aW9uKG5ld1BhZ2Upe1xuICAgICAgY29uc29sZS5sb2coJ1NlYXJjaEN0cmw6OnNldFBhZ2VOdW0gLS0gY2FsY3VsYXRlUGFnZSgpOicgKyBzcy5jYWxjdWxhdGVQYWdlKCkgKyAnICwgbmV3UGFnZTogJyArIG5ld1BhZ2UpO1xuICAgICAgaWYoc3MuY2FsY3VsYXRlUGFnZSgpICE9PSBuZXdQYWdlKXtcbiAgICAgICAgdmFyIG5ld0Zyb20gPSBzcy5vcHRzLnNpemUgKiAobmV3UGFnZSAtIDEpO1xuICAgICAgICBjb25zb2xlLmxvZygnU2VhcmNoQ3RybC4uLi4uLi4udXBkYXRpbmcgZnJvbSBmcm9tOiAnICsgc3Mub3B0cy5mcm9tICsgJyB0bzogJyArIG5ld0Zyb20pO1xuICAgICAgICB1cGRhdGVTZWFyY2goe2Zyb206IG5ld0Zyb219KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQWN0aXZhdGUgb3IgZGVhY3RpdmF0ZSBhIGZhY2V0LiBUcmlnZ2VycyBzZWFyY2ggdXBkYXRlLlxuICAgICAqIEBwYXJhbSBmYWNldE9wdGlvbiB7b2JqZWN0fSBGYWNldCBvYmplY3RcbiAgICAgKiBAcGFyYW0gYWN0aXZlIHtib29sZWFufSBTZXQgdHJ1ZSB0byBhY3RpdmF0ZSBmYWNldCwgZmFsc2UgdG8gZGVhY3RpdmF0ZVxuICAgICAqL1xuICAgICRzY29wZS51cGRhdGVGYWNldCA9IGZ1bmN0aW9uKGZhY2V0T3B0aW9uLCBhY3RpdmUpe1xuICAgICAgJHNjb3BlLnNob3dTcGlubmVyID0gdHJ1ZTtcbiAgICAgIGlmKGFjdGl2ZSl7XG4gICAgICAgIHNzLmFjdGl2YXRlRmFjZXQoZmFjZXRPcHRpb24pO1xuICAgICAgfVxuICAgICAgZWxzZXtcbiAgICAgICAgc3MuZGVBY3RpdmF0ZUZhY2V0KGZhY2V0T3B0aW9uKTtcbiAgICAgIH1cblxuICAgICAgLy9yZXNldCBwYWdpbmF0aW9uIHdoZW4gYXBwbHlpbmcgZmFjZXRcbiAgICAgIHNzLnVwZGF0ZU9wdHMoe2Zyb206IDB9KTtcbiAgICAgIHNzLnRyYW5zaXRpb25TdGF0ZUFuZFNlYXJjaCgpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBUb2dnbGVzIGZhY2V0LmFjdGl2ZSBzdGF0dXNcbiAgICAgKiBAcGFyYW0gZmFjZXQge29iamVjdH0gRmFjZXQgb2JqZWN0XG4gICAgICovXG4gICAgJHNjb3BlLnRvZ2dsZUZhY2V0ID0gZnVuY3Rpb24oZmFjZXQpe1xuICAgICAgJHNjb3BlLnVwZGF0ZUZhY2V0KGZhY2V0LCAhZmFjZXQuYWN0aXZlKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBmaWVsZCBmcm9tIHNlYXJjaCBmaWx0ZXJzIGFuZCByZXJ1bnMgc2VhcmNoLlxuICAgICAqIEZvciBmaWVsZHMgZnJvbSBBZHZhbmNlZCBTZWFyY2ggb25seS5cbiAgICAgKiBAcGFyYW0gZmllbGQge29iamVjdH0gZmllbGQgdG8gcmVtb3ZlXG4gICAgICovXG4gICAgJHNjb3BlLmNsZWFyQWR2YW5jZWRGaWVsZCA9IGZ1bmN0aW9uKGZpZWxkKSB7XG4gICAgICAkc2NvcGUuc2hvd1NwaW5uZXIgPSB0cnVlO1xuICAgICAgdmFyIGluZGV4ID0gc3Mub3B0cy5hZHZhbmNlZEZpZWxkcy5pbmRleE9mKGZpZWxkKTtcbiAgICAgIHNzLm9wdHMuYWR2YW5jZWRGaWVsZHMuc3BsaWNlKGluZGV4LCAxKTtcblxuICAgICAgLy9yZXNldCBwYWdpbmF0aW9uIGFuZCB1cGRhdGUgc2VhcmNoXG4gICAgICBzcy51cGRhdGVPcHRzKHthZHZhbmNlZEZpZWxkczogc3Mub3B0cy5hZHZhbmNlZEZpZWxkcywgZnJvbTogMH0pO1xuICAgICAgc3MudHJhbnNpdGlvblN0YXRlQW5kU2VhcmNoKCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENsZWFyIFNlYXJjaCBPcHRpb25zXG4gICAgICovXG4gICAgJHNjb3BlLmNsZWFyU2VhcmNoT3B0cyA9IGZ1bmN0aW9uKCl7XG4gICAgICAkc2NvcGUuc2hvd1NwaW5uZXIgPSB0cnVlO1xuICAgICAgc3MucmVzZXRPcHRzKCk7XG4gICAgICBzcy50cmFuc2l0aW9uU3RhdGVBbmRTZWFyY2goKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBxdWVyeSB0ZXJtLCB0aGVuIHJ1bnMgc2VhcmNoIG9uIGVtcHR5IHF1ZXJ5IHRlcm0gc3RyaW5nXG4gICAgICovXG4gICAgJHNjb3BlLmNsZWFyUXVlcnlUZXJtID0gZnVuY3Rpb24ocXVlcnlUZXJtKSB7XG4gICAgICAkc2NvcGUuc2hvd1NwaW5uZXIgPSB0cnVlO1xuICAgICAgJHNjb3BlLnF1ZXJ5VGVybXMgPSAkc2NvcGUucXVlcnlUZXJtcy5maWx0ZXIoZnVuY3Rpb24ocXVlcnkpIHtcbiAgICAgICAgcmV0dXJuIHF1ZXJ5ICE9PSBxdWVyeVRlcm07XG4gICAgICB9KTtcbiAgICAgIHVwZGF0ZVNlYXJjaCh7cTokc2NvcGUucXVlcnlUZXJtcywgZnJvbTogMH0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBkYXRlIHJhbmdlIGZpbHRlciwgdGhlbiBydW5zIHNlYXJjaCBhZ2FpblxuICAgICAqL1xuICAgICRzY29wZS5jbGVhckRhdGVSYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgc3Mub3B0cy5kYXRlID0ge307XG4gICAgICB1cGRhdGVTZWFyY2goe2Zyb206IDB9KTtcbiAgICB9O1xuICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAubW9kdWxlKCdhcHAuc2VhcmNoJylcbiAgLmRpcmVjdGl2ZSgnYWRqdXN0U2l6ZScsIGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtLCBhdHRyKXtcbiAgICAgIGVsZW0uYmluZChcImtleXVwXCIsIGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciB3aWR0aCA9IGVsZW0udmFsKCkubGVuZ3RoO1xuICAgICAgICBpZiAod2lkdGggPiAzKXtcbiAgICAgICAgICB2YXIgbmV3V2lkdGggPSAxMDAgKyAod2lkdGggKiA1KTtcbiAgICAgICAgICBlbGVtLmNzcygnd2lkdGgnLCBuZXdXaWR0aCArICdweCcpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuICB9KVxuICAuZGlyZWN0aXZlKCdmb2N1c0hvbWVTZWFyY2gnLCBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW0sIGF0dHIpe1xuICAgICAgZWxlbVswXS5xdWVyeVNlbGVjdG9yKCcuc2VhcmNoLWlucHV0JykuZm9jdXMoKTtcbiAgICB9O1xuICB9KVxuICAuZGlyZWN0aXZlKCdmb2N1c1NlYXJjaE9uTG9hZCcsIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbSwgYXR0cil7XG4gICAgICBlbGVtWzBdLnF1ZXJ5U2VsZWN0b3IoJyNmYWNldC1jaGlwLWlucHV0JykuZm9jdXMoKTtcbiAgICAgIGVsZW0uYWRkQ2xhc3MoJ2lucHV0LWRpdi1mb2N1cycpO1xuICAgIH07XG4gIH0pXG4gIC5kaXJlY3RpdmUoJ2ZvY3VzU2VhcmNoSW5wdXQnLCBmdW5jdGlvbigpe1xuICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbSwgYXR0cil7XG4gICAgICBlbGVtWzBdLnF1ZXJ5U2VsZWN0b3IoJyNmYWNldC1jaGlwLWlucHV0JykuZm9jdXMoKTtcbiAgICAgIGVsZW0uYWRkQ2xhc3MoJ2lucHV0LWRpdi1mb2N1cycpO1xuXG4gICAgICAkKGRvY3VtZW50KS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKCEkKGUudGFyZ2V0KS5oYXNDbGFzcyhcImZhY2V0LXNlYXJjaFwiKSAmJiAhJChlLnRhcmdldCkuaXMoXCJhXCIpICYmICEkKGUudGFyZ2V0KS5pcyhcImJ1dHRvblwiKSAmJiBlLnRhcmdldC50eXBlICE9PSBcImNoZWNrYm94XCIpIHtcbiAgICAgICAgICBpZihlbGVtLmhhc0NsYXNzKCdpbnB1dC1kaXYtZm9jdXMnKSl7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwicmVtb3ZpbmcgZm9jdXNcIik7XG4gICAgICAgICAgICBlbGVtLnJlbW92ZUNsYXNzKCdpbnB1dC1kaXYtZm9jdXMnKTtcbiAgICAgICAgICB9ICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGVsZW0uYmluZChcImNsaWNrXCIsIGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBpbnB1dCA9IGVsZW1bMF0ucXVlcnlTZWxlY3RvcignI2ZhY2V0LWNoaXAtaW5wdXQnKTtcbiAgICAgICAgaW5wdXQuZm9jdXMoKTtcbiAgICAgICAgZWxlbS5hZGRDbGFzcygnaW5wdXQtZGl2LWZvY3VzJyk7XG4gICAgICB9KTtcbiAgICB9O1xuICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLnNhdmVkLXJlY29yZHMnLCBbXSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhciAubW9kdWxlKCdhcHAuc2F2ZWQtcmVjb3JkcycpXG4gICAgLmNvbnRyb2xsZXIoJ1NhdmVkUmVjb3Jkc0N0cmwnLCBbJyRzY29wZScsICckc3RhdGUnLCAncmVjb3JkcycsICdzZWFyY2hlcycsICdTYXZlZFJlY29yZHNTZXJ2aWNlJywgJ1NlYXJjaFNlcnZpY2UnLCAnU0FWRURfUkVDT1JEU19TT1JUJywgJ18nLCBTYXZlZFJlY29yZHNDdHJsXSk7XG5cbiAgZnVuY3Rpb24gU2F2ZWRSZWNvcmRzQ3RybCgkc2NvcGUsICRzdGF0ZSwgcmVjb3Jkcywgc2VhcmNoZXMsIFNhdmVkUmVjb3Jkc1NlcnZpY2UsIFNlYXJjaFNlcnZpY2UsIFNBVkVEX1JFQ09SRFNfU09SVCwgXykge1xuICAgICRzY29wZS5zYXZlZFJlY29yZHMgPSByZWNvcmRzO1xuICAgICRzY29wZS5zYXZlZFNlYXJjaGVzID0gc2VhcmNoZXM7XG5cbiAgICAkc2NvcGUubnVtUmVjb3JkcyA9ICRzY29wZS5zYXZlZFJlY29yZHMubGVuZ3RoO1xuXG4gICAgJHNjb3BlLmN1cnJlbnRTb3J0ID0gXCJcIjtcbiAgICAkc2NvcGUuY3VycmVudFBhZ2UgPSAxO1xuXG4gICAgJHNjb3BlLnJlY29yZHNBY3RpdmUgPSB0cnVlO1xuICAgICRzY29wZS5zZWFyY2hlc0FjdGl2ZSA9IGZhbHNlO1xuXG4gICAgJHNjb3BlLnZhbGlkU29ydE1vZGVzID0gU0FWRURfUkVDT1JEU19TT1JUO1xuICAgICRzY29wZS5zaG93U3Bpbm5lciA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogU2V0cyB3aGljaCB0YWIgaXMgdGhlICdhY3RpdmUnIHRhYlxuICAgICAqIEBwYXJhbSB0YWJcbiAgICAgKi9cbiAgICAkc2NvcGUuc2V0QWN0aXZlVGFiID0gZnVuY3Rpb24odGFiKSB7XG4gICAgICBpZiAodGFiID09PSAncmVjb3JkcycpIHtcbiAgICAgICAgJHNjb3BlLnJlY29yZHNBY3RpdmUgPSB0cnVlO1xuICAgICAgICAkc2NvcGUuc2VhcmNoZXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICRzY29wZS5yZWNvcmRzQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICRzY29wZS5zZWFyY2hlc0FjdGl2ZSA9IHRydWU7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgc2NvcGUgdmFyaWFibGVzXG4gICAgICovXG4gICAgJHNjb3BlLnJlZnJlc2ggPSBmdW5jdGlvbigpIHtcbiAgICAgICRzY29wZS5zYXZlZFJlY29yZHMgPSBTYXZlZFJlY29yZHNTZXJ2aWNlLmdldFJlY29yZHMoKTtcbiAgICAgICRzY29wZS5udW1SZWNvcmRzID0gJHNjb3BlLnNhdmVkUmVjb3Jkcy5sZW5ndGg7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFNvcnQgcmVjb3JkcyBhY2NvcmRpbmcgdG8gc29ydCBtb2RlXG4gICAgICogQHBhcmFtIHNvcnRNb2RlXG4gICAgICovXG4gICAgJHNjb3BlLnNvcnRSZWNvcmRzID0gZnVuY3Rpb24oc29ydE1vZGUpIHtcbiAgICAgIHZhciBzb3J0RnVuY3Rpb247XG4gICAgICBzd2l0Y2goc29ydE1vZGUubW9kZSkge1xuICAgICAgICBjYXNlIFNBVkVEX1JFQ09SRFNfU09SVC50aXRsZUFaLm1vZGU6XG4gICAgICAgICAgc29ydEZ1bmN0aW9uID0gZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgaWYoYS5fdGl0bGVfZGlzcGxheSA8IGIuX3RpdGxlX2Rpc3BsYXkpIHJldHVybiAtMTtcbiAgICAgICAgICAgIGlmKGEuX3RpdGxlX2Rpc3BsYXkgPiBiLl90aXRsZV9kaXNwbGF5KSByZXR1cm4gMTtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgIH07XG4gICAgICAgICAgJHNjb3BlLmN1cnJlbnRTb3J0ID0gU0FWRURfUkVDT1JEU19TT1JULnRpdGxlQVouZGlzcGxheTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBTQVZFRF9SRUNPUkRTX1NPUlQudGl0bGVaQS5tb2RlOlxuICAgICAgICAgIHNvcnRGdW5jdGlvbiA9IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgICAgIGlmKGEuX3RpdGxlX2Rpc3BsYXkgPiBiLl90aXRsZV9kaXNwbGF5KSByZXR1cm4gLTE7XG4gICAgICAgICAgICBpZihhLl90aXRsZV9kaXNwbGF5IDwgYi5fdGl0bGVfZGlzcGxheSkgcmV0dXJuIDE7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICB9O1xuICAgICAgICAgICRzY29wZS5jdXJyZW50U29ydCA9IFNBVkVEX1JFQ09SRFNfU09SVC50aXRsZVpBLmRpc3BsYXk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgU0FWRURfUkVDT1JEU19TT1JULmRhdGVBZGRlZC5tb2RlOlxuICAgICAgICAgIHNvcnRGdW5jdGlvbiA9IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgICAgICAgIGlmKGEuX2luZ2VzdF9kYXRlIDwgYi5faW5nZXN0X2RhdGUpIHJldHVybiAtMTtcbiAgICAgICAgICAgIGlmKGEuX2luZ2VzdF9kYXRlID4gYi5faW5nZXN0X2RhdGUpIHJldHVybiAxO1xuICAgICAgICAgICAgcmV0dXJuIGEuX3RpdGxlX2Rpc3BsYXkgPCBiLl90aXRsZV9kaXNwbGF5ID8gLTEgOiAxO1xuICAgICAgICAgIH07XG4gICAgICAgICAgJHNjb3BlLmN1cnJlbnRTb3J0ID0gU0FWRURfUkVDT1JEU19TT1JULmRhdGVBZGRlZC5kaXNwbGF5O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFNBVkVEX1JFQ09SRFNfU09SVC5kYXRlQXNjZW5kLm1vZGU6XG4gICAgICAgICAgc29ydEZ1bmN0aW9uID0gZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgaWYoYS5fZGF0ZV9mYWNldCA8IGIuX2RhdGVfZmFjZXQpIHJldHVybiAtMTtcbiAgICAgICAgICAgIGlmKGEuX2RhdGVfZmFjZXQgPiBiLl9kYXRlX2ZhY2V0KSByZXR1cm4gMTtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgIH07XG4gICAgICAgICAgJHNjb3BlLmN1cnJlbnRTb3J0ID0gU0FWRURfUkVDT1JEU19TT1JULmRhdGVBc2NlbmQuZGlzcGxheTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBTQVZFRF9SRUNPUkRTX1NPUlQuZGF0ZURlc2MubW9kZTpcbiAgICAgICAgICBzb3J0RnVuY3Rpb24gPSBmdW5jdGlvbihhLCBiKSB7XG4gICAgICAgICAgICBpZihhLl9kYXRlX2ZhY2V0ID4gYi5fZGF0ZV9mYWNldCkgcmV0dXJuIC0xO1xuICAgICAgICAgICAgaWYoYS5fZGF0ZV9mYWNldCA8IGIuX2RhdGVfZmFjZXQpIHJldHVybiAxO1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgfTtcbiAgICAgICAgICAkc2NvcGUuY3VycmVudFNvcnQgPSBTQVZFRF9SRUNPUkRTX1NPUlQuZGF0ZURlc2MuZGlzcGxheTtcbiAgICAgIH1cbiAgICAgICRzY29wZS5jdXJyZW50UGFnZSA9IDE7XG4gICAgICAkc2NvcGUuc2F2ZWRSZWNvcmRzID0gJHNjb3BlLnNhdmVkUmVjb3Jkcy5zb3J0KHNvcnRGdW5jdGlvbik7XG4gICAgfTtcblxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBzZWFyY2ggaXRlbSBmcm9tIHNlYXJjaCBsaXN0XG4gICAgICogQHBhcmFtIHNlYXJjaFxuICAgICAqL1xuICAgICRzY29wZS5yZW1vdmVTZWFyY2ggPSBmdW5jdGlvbihzZWFyY2gpIHtcbiAgICAgIHZhciByZW1vdmVkID0ge1xuICAgICAgICBvcHRzOiBzZWFyY2gub3B0cyxcbiAgICAgICAgbnVtUmVzdWx0czogc2VhcmNoLm51bVJlc3VsdHMsXG4gICAgICAgIHRpbWU6IHNlYXJjaC50aW1lXG4gICAgICB9O1xuICAgICAgU2F2ZWRSZWNvcmRzU2VydmljZS5yZW1vdmVTZWFyY2gocmVtb3ZlZCk7XG4gICAgICAkc2NvcGUuc2F2ZWRTZWFyY2hlcyA9IFNhdmVkUmVjb3Jkc1NlcnZpY2UuZ2V0U2VhcmNoZXMoKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZXMgc2VhcmNoXG4gICAgICogQHBhcmFtIHNlYXJjaCB7b2JqZWN0fVxuICAgICAqL1xuICAgICRzY29wZS5ydW5TZWFyY2ggPSBmdW5jdGlvbihzZWFyY2gpIHtcbiAgICAgICRzY29wZS5zaG93U3Bpbm5lciA9IHRydWU7XG4gICAgICBTZWFyY2hTZXJ2aWNlLnJlc2V0T3B0cygpO1xuICAgICAgU2VhcmNoU2VydmljZS51cGRhdGVPcHRzKHNlYXJjaC5vcHRzKTtcbiAgICAgIFNlYXJjaFNlcnZpY2UudHJhbnNpdGlvblN0YXRlQW5kU2VhcmNoKCk7XG4gICAgfTtcblxuICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5hZHZhbmNlZC1zZWFyY2gnLCBbXSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAubW9kdWxlKCdhcHAuYWR2YW5jZWQtc2VhcmNoJylcbiAgLmNvbnRyb2xsZXIoJ0FkdmFuY2VkU2VhcmNoQ3RybCcsIFsnJHNjb3BlJywgJyRzdGF0ZScsICdTZWFyY2hTZXJ2aWNlJywgJ0FEVkFOQ0VEX1NFQVJDSCcsIEFkdmFuY2VkU2VhcmNoQ3RybF0pO1xuXG4gIGZ1bmN0aW9uIEFkdmFuY2VkU2VhcmNoQ3RybCgkc2NvcGUsICRzdGF0ZSwgU2VhcmNoU2VydmljZSwgQURWQU5DRURfU0VBUkNIKXtcbiAgICAkc2NvcGUuZmlsdGVycyA9IFtdO1xuICAgICRzY29wZS5maWVsZHMgPSBbXTtcbiAgICAkc2NvcGUucXVlcnlUZXJtID0gXCJcIjtcblxuICAgICRzY29wZS5hZGRGaWx0ZXIgPSBhZGRGaWx0ZXI7XG4gICAgJHNjb3BlLnNlbGVjdEZpZWxkID0gc2VsZWN0RmllbGQ7XG4gICAgJHNjb3BlLnNlYXJjaCA9IHNlYXJjaDtcblxuICAgIHZhciBpbml0aWFsRmllbGQgPSB7ZGlzcGxheTogXCItIFNlbGVjdCBGaWVsZCAtXCIsIHNlYXJjaEtleTogXCJcIn07XG5cbiAgICAkc2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24gKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zKSB7XG4gICAgICAvLyBzZWxlY3RlZCBhZHYgZmlsdGVycyBwbHVzIGluaXRpYWwgZW1wdHkgZmlsdGVyXG4gICAgICAkc2NvcGUuc2hvd1NwaW5uZXIgPSBmYWxzZTtcbiAgICAgICRzY29wZS5maWx0ZXJzID0gW3tmaWVsZDogaW5pdGlhbEZpZWxkLCB0ZXJtOiBcIlwiLCBsYXN0RmlsdGVyOiB0cnVlfV07XG5cbiAgICAgIC8vIG9ianMgdy9zZXR0aW5ncyBmb3IgZWFjaCBhdmFpbGFibGUgYWR2IGZpZWxkXG4gICAgICAkc2NvcGUuZmllbGRzID0gW1xuICAgICAgICAgIEFEVkFOQ0VEX1NFQVJDSC50aXRsZSxcbiAgICAgICAgICBBRFZBTkNFRF9TRUFSQ0guY3JlYXRvcixcbiAgICAgICAgICBBRFZBTkNFRF9TRUFSQ0guZGF0ZSxcbiAgICAgICAgICBBRFZBTkNFRF9TRUFSQ0gubGFuZ3VhZ2UsXG4gICAgICAgICAgQURWQU5DRURfU0VBUkNILnN1YmplY3QsXG4gICAgICAgICAgQURWQU5DRURfU0VBUkNILmdycF9jb250cmlidXRvcixcbiAgICAgICAgXTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEFkZHMgbmV3IGZpbHRlciBvYmplY3QgdG8gdGhlIGZpbHRlcnMgYXJyYXksIHdoaWNoIGFuZ3VsYXJcbiAgICAgKiB3aWxsIHVzZSB0byByZW5kZXIgb3V0IGFub3RoZXIgaW5wdXQgYm94IGFuZCBkcm9wZG93biBtZW51XG4gICAgICogZm9yIHRoZSBuZXcgZmllbGQuXG4gICAgICpcbiAgICAgKiBuZXdGaWx0ZXIuZmllbGQgLSBvYmplY3Qgd2l0aCBpbmZvIG9uIHRoZSBhZHYgZmllbGQgdG8gYmUgZmlsdGVyZWRcbiAgICAgKiBuZXdGaWx0ZXIudGVybSAtIHN0cmluZyB0byBmaWx0ZXIgYnlcbiAgICAgKiBuZXdGaWx0ZXIubGFzdEZpbHRlciAtIGJvb2wsIG9ubHkgdXNlZCBpbiBjb250cm9sbGVyL3ZpZXdcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhZGRGaWx0ZXIoKSB7XG4gICAgICB2YXIgbmV3RmlsdGVyID0ge1xuICAgICAgICBmaWVsZDogaW5pdGlhbEZpZWxkLFxuICAgICAgICB0ZXJtOiBcIlwiLFxuICAgICAgICBsYXN0RmlsdGVyOiB0cnVlXG4gICAgICB9O1xuICAgICAgJHNjb3BlLmZpbHRlcnNbJHNjb3BlLmZpbHRlcnMubGVuZ3RoIC0gMV0ubGFzdEZpbHRlciA9IGZhbHNlO1xuICAgICAgJHNjb3BlLmZpbHRlcnMucHVzaChuZXdGaWx0ZXIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHMgZmlsdGVyIG9iamVjdCdzIGZpZWxkIHRvIHRoZSBvbmUgc2VsZWN0ZWQgaW4gdGhlIGRyb3AtZG93biBtZW51LlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBmaWx0ZXIgLSB0aGUgZmlsdGVyIG9iamVjdCBjb250YWluaW5nIHRoZSBkYXRhIGZvciB0aGUgbWVudSBhbmQgaW5wdXQgYm94XG4gICAgICogQHBhcmFtIHtPYmplY3R9IGZpZWxkIC0gdGhlIGZpZWxkIG9iamVjdCBjb250YWluaW5nIGRpc3BsYXkgYW5kIGVsYXN0aWMgc2VhcmNoIGRhdGFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzZWxlY3RGaWVsZChmaWx0ZXIsIGZpZWxkKSB7XG4gICAgICBmaWx0ZXIuZmllbGQgPSBmaWVsZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSdW5zIHNlYXJjaCB3aXRoIGtleXdvcmRzIGFuZCBmaWx0ZXJzIGFzIHByb3ZpZGVkIGJ5IHVzZXIuXG4gICAgICogRmlyc3QgcHJvY2Vzc2VzIGZpbHRlcnMgdG8gaW5jbHVkZSBvbmx5IHRob3NlIHdpdGggZmllbGQgc2VsZWN0ZWQgYW5kIGtleXdvcmRzLlxuICAgICAqIEFkZHMgdGhvc2UgaXRlbXMgdG8gYW4gb3B0cyBvYmplY3QgYW5kIHVwZGF0ZXMgU2VhcmNoU2VydmljZSBvcHRzLlxuICAgICAqIFRoZW4gdHJhbnNpdGlvbnMgdG8gU2VhcmNoIFJlc3VsdHMgc3RhdGUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gc2VhcmNoKCkge1xuICAgICAgJHNjb3BlLnNob3dTcGlubmVyID0gdHJ1ZTtcbiAgICAgIHZhciBhZHZGaWVsZHMgPSBbXTtcbiAgICAgIHZhciBxdWVyeSA9IFtdO1xuICAgICAgaWYgKCRzY29wZS5xdWVyeVRlcm0pIHtcbiAgICAgICAgcXVlcnkucHVzaCgkc2NvcGUucXVlcnlUZXJtKTtcbiAgICAgIH1cblxuICAgICAgJHNjb3BlLmZpbHRlcnMuZm9yRWFjaChmdW5jdGlvbihmaWx0ZXIpe1xuICAgICAgICBpZihmaWx0ZXIudGVybSAmJiBmaWx0ZXIuZmllbGQgIT09IGluaXRpYWxGaWVsZCl7XG4gICAgICAgICAgYWR2RmllbGRzLnB1c2goXG4gICAgICAgICAgICBTZWFyY2hTZXJ2aWNlLmJ1aWxkQWR2YW5jZWRGaWVsZChmaWx0ZXIuZmllbGQsIGZpbHRlci50ZXJtKVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICB2YXIgb3B0cyA9IHtcbiAgICAgICAgcTogcXVlcnksXG4gICAgICAgIGFkdmFuY2VkRmllbGRzOiBhZHZGaWVsZHNcbiAgICAgIH07XG5cbiAgICAgIFNlYXJjaFNlcnZpY2UucmVzZXRPcHRzKCk7XG4gICAgICBTZWFyY2hTZXJ2aWNlLnVwZGF0ZU9wdHMob3B0cyk7XG4gICAgICBTZWFyY2hTZXJ2aWNlLnRyYW5zaXRpb25TdGF0ZUFuZFNlYXJjaCgpO1xuICAgIH1cbiAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdhcHAuY29udHJpYnV0b3JzJywgW10pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXJcbiAgLm1vZHVsZSgnYXBwLmNvbnRyaWJ1dG9ycycpXG4gIC5jb250cm9sbGVyKCdDb250cmlidXRvcnNDdHJsJywgWyckc2NvcGUnLCAnU2VhcmNoU2VydmljZScsICdjb250cmlidXRvcnMnLCBDb250cmlidXRvcnNDdHJsXSk7XG5cbiAgZnVuY3Rpb24gQ29udHJpYnV0b3JzQ3RybCgkc2NvcGUsIFNlYXJjaFNlcnZpY2UsIGNvbnRyaWJ1dG9ycykge1xuICAgIHZhciBzcyA9IFNlYXJjaFNlcnZpY2U7XG4gICAgJHNjb3BlLmluc3RpdHV0aW9ucyA9IGNvbnRyaWJ1dG9ycztcblxuICAgIC8vIGZvciB3aGVuIHVzZXIgY2xpY2tzIG9uIHJlY29yZHMgZm9yIGEgcGFydGljdWxhciBpbnN0aXR1dGlvbi5cbiAgICAkc2NvcGUuY29udHJpYlNlYXJjaCA9IGZ1bmN0aW9uKGNvbnRyaWJ1dG9yKSB7XG4gICAgICBzcy5yZXNldE9wdHMoKTtcbiAgICAgIHNzLmFjdGl2YXRlRmFjZXQoIHNzLmJ1aWxkRmFjZXQoJ2dycF9jb250cmlidXRvcicsIGNvbnRyaWJ1dG9yKSApO1xuICAgICAgc3MudHJhbnNpdGlvblN0YXRlQW5kU2VhcmNoKCk7XG4gICAgfTtcbiAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2FwcC5ib29rLWRldGFpbCcsIFtdKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyXG4gIC5tb2R1bGUoJ2FwcC5ib29rLWRldGFpbCcpXG4gIC5jb250cm9sbGVyKCdCb29rRGV0YWlsQ3RybCcsIFsnJHNjb3BlJywgJyRzdGF0ZVBhcmFtcycsICckd2luZG93JywgJ2Jvb2snLCAnRGF0YVNlcnZpY2UnLCBCb29rRGV0YWlsQ3RybF0pO1xuXG4gIGZ1bmN0aW9uIEJvb2tEZXRhaWxDdHJsKCRzY29wZSwgJHN0YXRlUGFyYW1zLCAkd2luZG93LCBib29rLCBEYXRhU2VydmljZSwgcmlzUmVjKSB7XG4gICAgJHNjb3BlLnNhdmVBc0pzb24gPSBzYXZlQXNKc29uO1xuICAgICRzY29wZS5zYXZlQXNSaXMgPSBzYXZlQXNSaXM7XG5cbiAgICAkc2NvcGUuc2hvd1NwaW5uZXIgPSB0cnVlO1xuICAgICRzY29wZS5ib29rID0gYm9vaztcbiAgICBEYXRhU2VydmljZS5nZXRCb29rRGF0YSgkc2NvcGUuYm9vay5faWQpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgdmFyIGJvb2tEYXRhID0gZGF0YS5fc291cmNlO1xuICAgICAgYm9va0RhdGEuX2lkID0gZGF0YS5faWQ7XG4gICAgICAkc2NvcGUuYm9vayA9IGJvb2tEYXRhO1xuICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24oKSB7XG4gICAgICAkc2NvcGUuc2hvd1NwaW5uZXIgPSBmYWxzZTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIHNhdmVBc0pzb24oKSB7XG4gICAgICB2YXIgZmlsZW5hbWUgPSAnYm9vay5qc29uJztcbiAgICAgICRzY29wZS5zaG93U3Bpbm5lciA9IHRydWU7XG4gICAgICBEYXRhU2VydmljZS5nZXREY1JlYygkc2NvcGUuYm9vay5faWQpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICBkYXRhID0gYW5ndWxhci50b0pzb24oZGF0YSwgdW5kZWZpbmVkLCAyKTtcbiAgICAgICAgICAkc2NvcGUuZmlsZUNvbnRlbnRzID0gZGF0YTtcbiAgICAgICAgfVxuICAgICAgICBjcmVhdGVCbG9iQW5kRG93bmxvYWQoZGF0YSwgJ3RleHQvanNvbicsIGZpbGVuYW1lKTtcbiAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24oKSB7XG4gICAgICAgICRzY29wZS5zaG93U3Bpbm5lciA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHNhdmVBc1JpcygpIHtcbiAgICAgIHZhciBmaWxlbmFtZSA9ICdib29rLnJpcyc7XG4gICAgICAkc2NvcGUuc2hvd1NwaW5uZXIgPSB0cnVlO1xuICAgICAgRGF0YVNlcnZpY2UuZ2V0UmlzUmVjKCRzY29wZS5ib29rLl9pZCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICRzY29wZS5maWxlQ29udGVudHNSaXMgPSBkYXRhO1xuICAgICAgICBjcmVhdGVCbG9iQW5kRG93bmxvYWQoZGF0YSwgJ2FwcGxpY2F0aW9uL3gtcmVzZWFyY2gtaW5mby1zeXN0ZW1zJywgZmlsZW5hbWUpO1xuICAgICAgfSkuZmluYWxseShmdW5jdGlvbigpIHtcbiAgICAgICAgJHNjb3BlLnNob3dTcGlubmVyID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVCbG9iQW5kRG93bmxvYWQoZGF0YSwgTWltZVR5cGUsIGZpbGVuYW1lKXtcbiAgICAgIHZhciBibG9iID0gbmV3IEJsb2IoW2RhdGFdLCB7dHlwZTogTWltZVR5cGV9KSxcbiAgICAgICAgZSA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdNb3VzZUV2ZW50cycpLFxuICAgICAgICBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuXG4gICAgICBhLmRvd25sb2FkID0gZmlsZW5hbWU7XG4gICAgICBhLmhyZWYgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcbiAgICAgIGEuZGF0YXNldC5kb3dubG9hZHVybCA9IFtNaW1lVHlwZSwgYS5kb3dubG9hZCwgYS5ocmVmXS5qb2luKCc6Jyk7XG4gICAgICBlLmluaXRNb3VzZUV2ZW50KCdjbGljaycsIHRydWUsIGZhbHNlLCB3aW5kb3csXG4gICAgICAgIDAsIDAsIDAsIDAsIDAsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCAwLCBudWxsKTtcbiAgICAgIGEuZGlzcGF0Y2hFdmVudChlKTtcbiAgICB9XG5cbiAgICAkc2NvcGUucmVkaXJlY3QgPSBmdW5jdGlvbigpe1xuICAgICAgJHdpbmRvdy5sb2NhdGlvbi5hc3NpZ24oJHNjb3BlLmJvb2suX3NvdXJjZS5fcmVjb3JkX2xpbmspO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gIH1cblxufSkoKTtcbiIsIi8qIENvbnRyb2xsZXJzICovXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnYXBwLmNvbnRyb2xsZXInLCBbJ3VpLmJvb3RzdHJhcCddKVxuICAgIC5jb250cm9sbGVyKCdTZWFyY2hIZWxwQ3RybCcsIFsnY29uZmlnJywgJyRzY29wZScsIGZ1bmN0aW9uIChjb25maWcsICRzY29wZSkge1xuICAgICAgJHNjb3BlLnNlYXJjaEhlbHAgPSB7bmFtZTogXCJzZWFyY2hoZWxwLmh0bWxcIiwgdXJsOiBjb25maWcuYXBwLnJvb3QgKyBcIi9wYXJ0aWFscy9oZWxwLmh0bWxcIn07XG4gICAgICAkc2NvcGUuc2hvd1NwaW5uZXIgPSBmYWxzZTtcbiAgICB9XSlcblxuICAgIC5jb250cm9sbGVyKCdGZWVkYmFja0Zvcm1DdHJsJywgWydjb25maWcnLCAnJHNjb3BlJywgJyRzdGF0ZScsICckaHR0cCcsICckbG9jYXRpb24nLCAnJHdpbmRvdycsIGZ1bmN0aW9uIChjb25maWcsICRzY29wZSwgJHN0YXRlLCAkaHR0cCwgJGxvY2F0aW9uLCAkd2luZG93KSB7XG4gICAgICAkc2NvcGUuc2hvd1NwaW5uZXIgPSBmYWxzZTtcbiAgICAgICRzY29wZS5mZWVkYmFja0ZpZWxkcyA9IFsnUHJvYmxlbScsJ1F1ZXN0aW9uJywnQ29tbWVudCddO1xuICAgICAgJHNjb3BlLm1hc3RlciA9IHtmaXJzdF9uYW1lOiBcIlwiLCBsYXN0X25hbWU6IFwiXCIsIGVtYWlsOiBcIlwiLCBjb25maXJtYXRpb25fZW1haWw6IFwiXCIsIG9yZ2FuaXphdGlvbjogXCJcIiwgdHlwZV9vZl9mZWVkYmFjazogJHNjb3BlLmZlZWRiYWNrRmllbGRzWzBdLCB1c2VyX2ZlZWRiYWNrOiBcIlwifTtcbiAgICAgICRzY29wZS5yZXNldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAkc2NvcGUudXNlciA9IGFuZ3VsYXIuY29weSgkc2NvcGUubWFzdGVyKTtcbiAgICAgICAgJHNjb3BlLmlzTWF0Y2ggPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAoJHNjb3BlLnVzZXIuZW1haWwgPT09ICRzY29wZS51c2VyLmNvbmZpcm1hdGlvbl9lbWFpbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgICAkc2NvcGUucmVzZXQoKTtcbiAgICAgICRzY29wZS5zZW5kTWFpbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCRzY29wZS5mZWVkYmFja0Zvcm0uJHZhbGlkICYmICRzY29wZS5pc01hdGNoKCkpIHtcbiAgICAgICAgICB2YXIgZGF0YSA9ICRzY29wZS51c2VyO1xuICAgICAgICAgIHZhciByZXEgPSB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIHVybDogY29uZmlnLmRqYW5nby5ob3N0ICsgJzonICsgY29uZmlnLmRqYW5nby5wb3J0ICsgJy9hcGkvc2VuZC1lbWFpbC8nLFxuICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICAgIH07XG4gICAgICAgICAgJGh0dHAocmVxKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIm1lc3NhZ2Ugc3VjY2Vzc2Z1bGx5IHNlbnRcIik7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ3RoYW5rcycpO1xuICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgJHN0YXRlLmdvKCd0aGFua3MnKTtcbiAgICAgICAgICB9KTsgXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgJHNjb3BlLmZlZWRiYWNrRm9ybS4kc3VibWl0dGVkID0gdHJ1ZVxuICAgICAgICB9XG4gICAgICB9OyAgICAgICAgICAgICBcbiAgICAgICRzY29wZS5mZWVkYmFja0Vycm9ycyA9W1xuICAgICAgICB7bXNnOiAnVGhpcyBmaWVsZCBpcyByZXF1aXJlZC4nfSxcbiAgICAgICAge21zZzogJ1BsZWFzZSBlbnRlciBhIHZhbGlkIGVtYWlsIGFkZHJlc3MuJ30sXG4gICAgICAgIHttc2c6ICdFbWFpbCBhZGRyZXNzZXMgZG8gbm90IG1hdGNoLid9XG4gICAgICBdO1xuXG4gICAgfV0pXG5cbiAgLmNvbnRyb2xsZXIoJ0ZhY2V0TW9kYWxDdHJsJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICdjb25maWcnLCAnJHVpYk1vZGFsJywgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgY29uZmlnLCAkdWliTW9kYWwpe1xuICAgICRzY29wZS5vcGVuRmFjZXRNb2RhbCA9IGZ1bmN0aW9uKGZhY2V0cywgY2F0ZWdvcnkpIHtcbiAgICAgIHZhciBtb2RhbEluc3RhbmNlID0gJHVpYk1vZGFsLm9wZW4oe1xuICAgICAgICBhbmltYXRpb246IHRydWUsXG4gICAgICAgIHNjb3BlOiAkc2NvcGUsXG4gICAgICAgIHRlbXBsYXRlVXJsOiBjb25maWcuYXBwLnJvb3QgKyAnL3NlYXJjaC9zZWFyY2guZmFjZXRfbW9kYWwuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdGYWNldE1vZGFsSW5zdGFuY2VDdHJsJyxcbiAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgIGZhY2V0czogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHJldHVybiBmYWNldHM7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBjYXRlZ29yeTogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHJldHVybiBjYXRlZ29yeTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgbW9kYWxJbnN0YW5jZS5yZXN1bHQudGhlbihmdW5jdGlvbiAoZmFjZXRzKSB7XG4gICAgICAgIGlmIChmYWNldHMpe1xuICAgICAgICAgIHZhciBhY3RpdmF0ZWRGYWNldHMgPSBmYWNldHNbMF07XG4gICAgICAgICAgdmFyIGRlYWN0aXZhdGVkRmFjZXRzID0gZmFjZXRzWzFdO1xuICAgICAgICAgIGFjdGl2YXRlZEZhY2V0cy5mb3JFYWNoKGZ1bmN0aW9uKGZhY2V0KSB7XG4gICAgICAgICAgICAkc2NvcGUudXBkYXRlRmFjZXQoZmFjZXQsIHRydWUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGRlYWN0aXZhdGVkRmFjZXRzLmZvckVhY2goZnVuY3Rpb24oZmFjZXQpIHtcbiAgICAgICAgICAgICRzY29wZS51cGRhdGVGYWNldChmYWNldCwgZmFsc2UpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuICB9XSlcbiAgLmNvbnRyb2xsZXIoJ0ZhY2V0TW9kYWxJbnN0YW5jZUN0cmwnLCBbJyRzY29wZScsICckdWliTW9kYWxJbnN0YW5jZScsICdmYWNldHMnLCAnY2F0ZWdvcnknLCBmdW5jdGlvbiAoJHNjb3BlLCAkdWliTW9kYWxJbnN0YW5jZSwgZmFjZXRzLCBjYXRlZ29yeSkge1xuICAgICRzY29wZS50ZXh0ID0gXCJcIjtcbiAgICAkc2NvcGUuZmlsdGVyQ291bnQgPSAwO1xuICAgICRzY29wZS5jdXJyZW50RmFjZXRzID0gW107XG4gICAgJHNjb3BlLnNlbGVjdGVkRmFjZXRzID0gW107XG4gICAgJHNjb3BlLmZhY2V0Q2F0ZWdvcmllcyA9IFtdO1xuXG4gICAgJHNjb3BlLmlzQWN0aXZlID0gaXNBY3RpdmU7XG4gICAgJHNjb3BlLnN3aXRjaEZhY2V0Q2F0ZWdvcnkgPSBzd2l0Y2hGYWNldENhdGVnb3J5O1xuICAgICRzY29wZS5pc0NhdGVnb3J5U2VsZWN0ZWQgPSBpc0NhdGVnb3J5U2VsZWN0ZWQ7XG4gICAgJHNjb3BlLnNlYXJjaEZpbHRlcnMgPSBzZWFyY2hGaWx0ZXJzO1xuICAgICRzY29wZS5hcHBseSA9IGFwcGx5O1xuICAgICRzY29wZS5jaGVja0ZhY2V0ID0gY2hlY2tGYWNldDtcbiAgICAkc2NvcGUudG9nZ2xlRmlsdGVyVmlldyA9IHRvZ2dsZUZpbHRlclZpZXc7XG4gICAgJHNjb3BlLmNsb3NlID0gY2xvc2U7XG4gICAgJHNjb3BlLmZpbHRlclZpZXdUZXh0ID0gXCJTZWUgT25seSBDaGVja2VkIEZpbHRlcnNcIjtcblxuICAgIHZhciBzZWVPbmx5Q2hlY2tlZFRleHQgPSBbXCJTZWUgT25seSBDaGVja2VkIEZpbHRlcnNcIiwgXCJTZWUgQWxsIEZpbHRlcnNcIl07XG4gICAgdmFyIHNlZU9ubHlDaGVja2VkID0gZmFsc2U7XG4gICAgdmFyIGFjdGl2ZUNhdGVnb3J5ID0gY2F0ZWdvcnk7XG4gICAgdmFyIGFsbEZhY2V0cyA9IFtdO1xuICAgIHZhciBjYXRlZ29yeUNvdW50cyA9IHt9O1xuICAgIHZhciBmYWNldHNUb0FwcGx5ID0ge307XG5cbiAgICBpbml0aWFsaXplKCk7XG5cbiAgICBmdW5jdGlvbiBpbml0aWFsaXplKCl7XG4gICAgICBhbGxGYWNldHMgPSBmYWNldHM7XG4gICAgICAkc2NvcGUuZmFjZXRDYXRlZ29yaWVzID0gW3tcbiAgICAgICAgbmFtZTogJ2NyZWF0b3InLFxuICAgICAgICBkaXNwbGF5OiAnQ3JlYXRvci8gQ29udHJpYnV0b3InXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAnc3ViamVjdCcsXG4gICAgICAgIGRpc3BsYXk6ICdTdWJqZWN0J1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ2xhbmd1YWdlJyxcbiAgICAgICAgZGlzcGxheTogJ0xhbmd1YWdlJ1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ2dycF9jb250cmlidXRvcicsXG4gICAgICAgIGRpc3BsYXk6ICdGcm9tJ1xuICAgICAgfV07XG5cbiAgICAgICRzY29wZS5jdXJyZW50RmFjZXRzID0gZmFjZXRzW2NhdGVnb3J5XTtcbiAgICAgICRzY29wZS5jYXRlZ29yeUZhY2V0cyA9IGZhY2V0c1tjYXRlZ29yeV07XG4gICAgICBzZXRGYWNldHNDaGVja2VkKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0RmFjZXRLZXkoZmFjZXQpIHtcbiAgICAgIHJldHVybiBmYWNldC5jYXRlZ29yeSArIGZhY2V0LnZhbHVlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldEZhY2V0c0NoZWNrZWQoKXtcbiAgICAgIGZvcih2YXIgcHJvcCBpbiBhbGxGYWNldHMpe1xuICAgICAgICB2YXIgZmFjZXRzQnlQcm9wID0gYWxsRmFjZXRzW3Byb3BdO1xuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgZmFjZXRzQnlQcm9wLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICB2YXIgZmFjZXQgPSBmYWNldHNCeVByb3BbaV07XG4gICAgICAgICAgaWYoZmFjZXQuYWN0aXZlKXtcbiAgICAgICAgICAgICRzY29wZS5maWx0ZXJDb3VudCsrO1xuICAgICAgICAgICAgaWYoY2F0ZWdvcnlDb3VudHNbcHJvcF0pe1xuICAgICAgICAgICAgICBjYXRlZ29yeUNvdW50c1twcm9wXSsrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY2F0ZWdvcnlDb3VudHNbcHJvcF0gPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGtleSA9IGdldEZhY2V0S2V5KGZhY2V0KTtcbiAgICAgICAgICAgIGZhY2V0c1RvQXBwbHlba2V5XSA9IHtcbiAgICAgICAgICAgICAgZmFjZXRPYmo6IGZhY2V0LFxuICAgICAgICAgICAgICBjaGVja2VkOiB0cnVlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRGYWNldHNbZmFjZXQudmFsdWVdID0gZmFjZXQuYWN0aXZlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3dpdGNoRmFjZXRDYXRlZ29yeShuZXdDYXRlZ29yeSl7XG4gICAgICAkc2NvcGUuY3VycmVudEZhY2V0cyA9IGFsbEZhY2V0c1tuZXdDYXRlZ29yeV07XG4gICAgICAkc2NvcGUuY2F0ZWdvcnlGYWNldHMgPSB0aGlzLmN1cnJlbnRGYWNldHM7XG4gICAgICBhY3RpdmVDYXRlZ29yeSA9IG5ld0NhdGVnb3J5O1xuICAgICAgJHNjb3BlLnRleHQgPSBcIlwiO1xuICAgICAgc2VlT25seUNoZWNrZWQgPSBmYWxzZTtcbiAgICAgICRzY29wZS5maWx0ZXJWaWV3VGV4dCA9IHNlZU9ubHlDaGVja2VkVGV4dFswXTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc0FjdGl2ZShjYXQpe1xuICAgICAgcmV0dXJuIChhY3RpdmVDYXRlZ29yeSA9PT0gY2F0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjaGVja0ZhY2V0KGZhY2V0KXtcbiAgICAgIHZhciBmYWNldENhdGVnb3J5ID0gZmFjZXQuY2F0ZWdvcnk7XG4gICAgICB2YXIgZmFjZXRUZXh0ID0gZmFjZXQudmFsdWU7XG5cbiAgICAgIGlmKCRzY29wZS5zZWxlY3RlZEZhY2V0c1tmYWNldFRleHRdKXtcbiAgICAgICAgaWYoY2F0ZWdvcnlDb3VudHNbZmFjZXRDYXRlZ29yeV0pe1xuICAgICAgICAgIGNhdGVnb3J5Q291bnRzW2ZhY2V0Q2F0ZWdvcnldKys7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2F0ZWdvcnlDb3VudHNbZmFjZXRDYXRlZ29yeV0gPSAxO1xuICAgICAgICB9XG4gICAgICAgICRzY29wZS5maWx0ZXJDb3VudCsrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHNjb3BlLmZpbHRlckNvdW50LS07XG4gICAgICAgIGNhdGVnb3J5Q291bnRzW2ZhY2V0Q2F0ZWdvcnldLS07XG4gICAgICB9XG4gICAgICB2YXIga2V5ID0gZ2V0RmFjZXRLZXkoZmFjZXQpO1xuICAgICAgaWYgKGZhY2V0c1RvQXBwbHlba2V5XSkge1xuICAgICAgICBmYWNldHNUb0FwcGx5W2tleV0uY2hlY2tlZCA9ICFmYWNldHNUb0FwcGx5W2tleV0uY2hlY2tlZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZhY2V0c1RvQXBwbHlba2V5XSA9IHtcbiAgICAgICAgICBmYWNldE9iajogZmFjZXQsXG4gICAgICAgICAgY2hlY2tlZDogdHJ1ZVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzQ2F0ZWdvcnlTZWxlY3RlZChjYXRlZ29yeSl7XG4gICAgICByZXR1cm4gY2F0ZWdvcnlDb3VudHNbY2F0ZWdvcnldO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRvZ2dsZUZpbHRlclZpZXcoKXtcbiAgICAgIHNlZU9ubHlDaGVja2VkID0gIXNlZU9ubHlDaGVja2VkO1xuICAgICAgaWYoc2VlT25seUNoZWNrZWQpe1xuICAgICAgICAkc2NvcGUuZmlsdGVyVmlld1RleHQgPSBzZWVPbmx5Q2hlY2tlZFRleHRbMV07XG4gICAgICAgIHZhciBjaGVja2VkRmlsdGVycyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS5jdXJyZW50RmFjZXRzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICB2YXIgY3VycmVudEZhY2V0ID0gJHNjb3BlLmN1cnJlbnRGYWNldHNbaV07XG4gICAgICAgICAgaWYoJHNjb3BlLnNlbGVjdGVkRmFjZXRzW2N1cnJlbnRGYWNldC52YWx1ZV0pe1xuICAgICAgICAgICAgY2hlY2tlZEZpbHRlcnMucHVzaChjdXJyZW50RmFjZXQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUuY3VycmVudEZhY2V0cyA9IGNoZWNrZWRGaWx0ZXJzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgJHNjb3BlLmZpbHRlclZpZXdUZXh0ID0gc2VlT25seUNoZWNrZWRUZXh0WzBdO1xuICAgICAgICAkc2NvcGUuY3VycmVudEZhY2V0cyA9IGFsbEZhY2V0c1thY3RpdmVDYXRlZ29yeV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYXBwbHkoKXtcbiAgICAgIHZhciBhY3RpdmF0ZWQgPSBbXTtcbiAgICAgIHZhciBkZWFjdGl2YXRlZCA9IFtdO1xuICAgICAgZm9yICh2YXIgZmFjZXRLZXkgaW4gZmFjZXRzVG9BcHBseSkge1xuICAgICAgICB2YXIgZmFjZXQgPSBmYWNldHNUb0FwcGx5W2ZhY2V0S2V5XS5mYWNldE9iajtcbiAgICAgICAgaWYgKGZhY2V0c1RvQXBwbHlbZmFjZXRLZXldLmNoZWNrZWQpIHtcbiAgICAgICAgICBhY3RpdmF0ZWQucHVzaChmYWNldCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGVhY3RpdmF0ZWQucHVzaChmYWNldCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciBmYWNldHNUb1VwZGF0ZSA9IFthY3RpdmF0ZWQsIGRlYWN0aXZhdGVkXTtcbiAgICAgICR1aWJNb2RhbEluc3RhbmNlLmNsb3NlKGZhY2V0c1RvVXBkYXRlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICAgICR1aWJNb2RhbEluc3RhbmNlLmNsb3NlKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2VhcmNoRmlsdGVycygpe1xuICAgICAgdmFyIGZpbHRlcmVkRmFjZXRzID0gW107XG5cbiAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCAkc2NvcGUuY2F0ZWdvcnlGYWNldHMubGVuZ3RoOyBpKyspe1xuICAgICAgICB2YXIgZmFjZXQgPSAkc2NvcGUuY2F0ZWdvcnlGYWNldHNbaV07XG4gICAgICAgIGlmKGZhY2V0LnZhbHVlLnRvTG93ZXJDYXNlKCkuaW5kZXhPZigkc2NvcGUudGV4dC50b0xvd2VyQ2FzZSgpKSA+IC0xKXtcbiAgICAgICAgICBmaWx0ZXJlZEZhY2V0cy5wdXNoKGZhY2V0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgJHNjb3BlLmN1cnJlbnRGYWNldHMgPSBmaWx0ZXJlZEZhY2V0cztcbiAgICB9XG59XSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnc2F2ZVJlY29yZEJ1dHRvbicsIFsnJHN0YXRlJywgJ1NhdmVkUmVjb3Jkc1NlcnZpY2UnLCAnU0FWRURfSVRFTVMnLCBmdW5jdGlvbigkc3RhdGUsIFNhdmVkUmVjb3Jkc1NlcnZpY2UsIFNBVkVEX0lURU1TKXtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnQUUnLFxuICAgICAgICByZXBsYWNlOiAndHJ1ZScsXG4gICAgICAgIHNjb3BlOiBmYWxzZSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvcGFydGlhbHMvc2F2ZS1yZWNvcmQtYnV0dG9uLmh0bWwnLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW0sIGF0dHJzKSB7XG5cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBTYXZlcyBib29rIHJlY29yZCB1c2luZyBTYXZlZFJlY29yZHNTZXJ2aWNlIGFuZCB1cGRhdGVzIHNhdmVkUmVjb3Jkc1xuICAgICAgICAgICAqIEBwYXJhbSBib29rIHtvYmplY3R9IHJlY29yZCB0byBzYXZlXG4gICAgICAgICAgICovXG4gICAgICAgICAgZnVuY3Rpb24gc2F2ZVJlY29yZCAoYm9vaykge1xuICAgICAgICAgICAgU2F2ZWRSZWNvcmRzU2VydmljZS5zYXZlUmVjb3JkKGJvb2spO1xuICAgICAgICAgICAgdmFyIHJlY29yZHMgPSBTYXZlZFJlY29yZHNTZXJ2aWNlLmdldFJlY29yZHMoKTtcbiAgICAgICAgICAgIGlmIChyZWNvcmRzKSB7XG4gICAgICAgICAgICAgIHNjb3BlLnNhdmVkUmVjb3JkcyA9IHJlY29yZHM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzY29wZS5zYXZlZFJlY29yZHMgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBSZW1vdmVzIGJvb2sgcmVjb3JkIGZyb20gc3RvcmFnZVxuICAgICAgICAgICAqIEBwYXJhbSBib29rIHtvYmplY3R9IHJlY29yZCB0byByZW1vdmVcbiAgICAgICAgICAgKi9cbiAgICAgICAgICBmdW5jdGlvbiByZW1vdmVSZWNvcmQgKGJvb2spIHtcbiAgICAgICAgICAgIFNhdmVkUmVjb3Jkc1NlcnZpY2UucmVtb3ZlUmVjb3JkKGJvb2spO1xuICAgICAgICAgICAgc2NvcGUuc2F2ZWRSZWNvcmRzID0gU2F2ZWRSZWNvcmRzU2VydmljZS5nZXRSZWNvcmRzKCk7XG4gICAgICAgICAgICBpZigkc3RhdGUuY3VycmVudC5jb250cm9sbGVyID09PSAnU2F2ZWRSZWNvcmRzQ3RybCcpe1xuICAgICAgICAgICAgICBzY29wZS5yZWZyZXNoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIENoZWNrcyBpZiBib29rIHJlY29yZCBpcyBzYXZlZCBpbiBzdG9yYWdlXG4gICAgICAgICAgICogQHBhcmFtIGJvb2sge29iamVjdH0gYm9vayB0byBjaGVja1xuICAgICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufSB3aGV0aGVyIGJvb2sgaXMgc2F2ZWRcbiAgICAgICAgICAgKi9cbiAgICAgICAgICBzY29wZS5pc1JlY29yZFNhdmVkID0gZnVuY3Rpb24oYm9vaykge1xuICAgICAgICAgICAgdmFyIHNhdmVkUmVjb3JkcyA9IFNhdmVkUmVjb3Jkc1NlcnZpY2UuZ2V0UmVjb3JkcygpO1xuICAgICAgICAgICAgaWYgKHNhdmVkUmVjb3Jkcykge1xuICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNhdmVkUmVjb3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50ID0gc2F2ZWRSZWNvcmRzW2ldO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Ll9pZCA9PT0gYm9vay5faWQpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIFNldHMgYXBwcm9wcmlhdGUgdmFyaWFibGVzIHdoZW4geW91ciBtb3VzZSBob3ZlcnMgb3ZlciBib29rbWFyayBpY29uXG4gICAgICAgICAgICogQHBhcmFtIGJvb2sge29iamVjdH0gcmVjb3JkIGJvb2ttYXJrIGlzIHJlZmVyZW5jaW5nXG4gICAgICAgICAgICovXG4gICAgICAgICAgc2NvcGUuc2F2ZVJlY29yZEhvdmVyID0gZnVuY3Rpb24oYm9vayl7XG4gICAgICAgICAgICB0aGlzLnNob3dCb29rbWFya1RleHQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHNjb3BlLmlzUmVjb3JkU2F2ZWQoYm9vaykpIHtcbiAgICAgICAgICAgICAgc2NvcGUuYm9va01hcmtUZXh0ID0gXCJSZW1vdmUgUmVjb3JkXCI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzY29wZS5ib29rTWFya1RleHQgPSBcIlNhdmUgUmVjb3JkXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIFNldHMgYXBwcm9wcmlhdGUgdmFyaWFibGVzIHdoZW4geW91ciBtb3VzZSBzdG9wcyBob3ZlcmluZyBvdmVyIGJvb2ttYXJrIGljb25cbiAgICAgICAgICAgKi9cbiAgICAgICAgICBzY29wZS5zYXZlUmVjb3JkSG92ZXJPdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0Jvb2ttYXJrVGV4dCA9IGZhbHNlO1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBUb2dnbGVzIHRoZSBzYXZpbmcgYW5kIHJlbW92aW5nIGJvb2sgcmVjb3JkIGZyb20gc3RvcmFnZVxuICAgICAgICAgICAqIEBwYXJhbSBib29rIHtvYmplY3R9IGJvb2sgcmVjb3JkIHRvIGJlIHNhdmVkXG4gICAgICAgICAgICovXG4gICAgICAgICAgc2NvcGUudG9nZ2xlU2F2aW5nQm9vayA9IGZ1bmN0aW9uKGJvb2spIHtcbiAgICAgICAgICAgIGlmIChzY29wZS5pc1JlY29yZFNhdmVkKGJvb2spKSB7XG4gICAgICAgICAgICAgIHJlbW92ZVJlY29yZChib29rKTtcbiAgICAgICAgICAgICAgc2NvcGUuYm9va01hcmtUZXh0ID0gXCJTYXZlIFJlY29yZFwiO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgc2F2ZVJlY29yZChib29rKTtcbiAgICAgICAgICAgICAgc2NvcGUuYm9va01hcmtUZXh0ID0gXCJSZW1vdmUgUmVjb3JkXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XSlcbiAgICAuZGlyZWN0aXZlKCdzdG9yYWdlRXZlbnRMaXN0ZW5lcicsIFsnJHN0YXRlJywgJ1NhdmVkUmVjb3Jkc1NlcnZpY2UnLCAnU0FWRURfSVRFTVMnLCBmdW5jdGlvbigkc3RhdGUsIFNhdmVkUmVjb3Jkc1NlcnZpY2UsIFNBVkVEX0lURU1TKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0FFJyxcbiAgICAgICAgdGVtcGxhdGU6ICcnLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW0sIGF0dHJzKSB7XG5cbiAgICAgICAgICAvL1dhdGNoIGZvciBzdG9yYWdlIGV2ZW50c1xuICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCh3aW5kb3cpLm9uKCdzdG9yYWdlJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09IFNBVkVEX0lURU1TLnJlY29yZEtleSkge1xuICAgICAgICAgICAgICBpZigkc3RhdGUuY3VycmVudC5jb250cm9sbGVyID09PSAnU2F2ZWRSZWNvcmRzQ3RybCcpe1xuICAgICAgICAgICAgICAgIHNjb3BlLnJlZnJlc2goKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gICAgXSk7XG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
